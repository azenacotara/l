"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3811],{36833:function(e,t,s){s.d(t,{sQ:function(){return M},mI:function(){return E},mp:function(){return R}});var a=s(52322),r=s(92488),n=s(15584),l=s(93326),i=s(34318),o=s(30021),u=s(76330);let d=e=>{let{characterId:t}=e,{data:s,refetch:r,isFetching:n}=i.h.moderation.characterSafety.useQuery(t);return(0,a.jsxs)("div",{className:"flex items-center pl-4 gap-7",children:[(0,a.jsx)("div",{className:"w-2 ml-1",children:(0,a.jsx)(u.kUi,{className:"size-4"})}),(0,a.jsxs)("div",{className:"flex items-center justify-between space-x-2 w-full",children:[!!n&&(0,a.jsx)("p",{className:"text-md",children:"Loading..."}),!n&&!!s&&(0,a.jsx)("p",{children:s.moderation_safety}),(0,a.jsx)(o.S,{characterId:t,onAction:()=>r(),disabled:!s})]})]})};var c=s(46272),m=s(92014),f=s(2608),h=s(35740),x=s(29452),p=s(61676),v=s(15030),g=s(61346),j=s(21805),N=s(82876),b=s(2784),y=s(67446),_=s(43855);let w="model_server_address",C="model_server_stream_params";function M(e){let{characterId:t}=e,{isStaff:s}=(0,h.a)();return s?(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)(c.Z,{}),(0,a.jsx)(A,{}),(0,a.jsx)(d,{characterId:t}),(0,a.jsx)(O,{}),(0,a.jsx)(k,{})]}):null}let R=()=>{let e=(0,N.useSearchParams)(),{addOrUpdateQueryParams:t,removeQueryParam:s}=(0,x.f)(),a=j.Z.get(v.Ls),r=null==e?void 0:e.get(w),n=j.Z.get(C),l=null==e?void 0:e.get(C),i=null==e?void 0:e.get("neo_host");(0,b.useEffect)(()=>{i&&(0,g.e3)(i)},[i]);let[o,u]=(0,b.useState)(null!=r?r:a),[d,c]=(0,b.useState)(null!=l?l:n),m=(0,b.useCallback)(()=>{o&&j.Z.set(v.Ls,o)},[o]),h=(0,b.useCallback)(()=>{d&&j.Z.set(C,d)},[d]),p=(0,b.useCallback)(()=>{(0,f.K)("Model Override Params Cleared"),u(void 0),j.Z.remove(v.Ls),s(w),c(void 0),j.Z.remove(C),s(C),(0,g.yi)({modelServerURLOverride:void 0,modelServerStreamParamsOverride:void 0})},[s]);return(0,b.useEffect)(()=>{o&&(0,g.GY)(o)},[o]),(0,b.useEffect)(()=>{if(l){let e=JSON.parse(l);(0,g.IZ)(e)}},[l]),(0,b.useEffect)(()=>{r&&r!==a?m():!r&&a&&t({[w]:a})},[t,a,m,r]),(0,b.useEffect)(()=>{d&&d!==n?h():!d&&n&&t({[C]:n})},[t,n,h,d,l]),{persistModelServerURL:m,clearModelServerURL:p,modelServerOverride:o,modelServerStreamParamsOverride:d}};function E(){let{isStaff:e}=(0,h.a)();return e?(0,a.jsx)(S,{}):null}function S(){let{modelServerOverride:e,modelServerStreamParamsOverride:t,clearModelServerURL:s}=R();return e||t?(0,a.jsxs)("div",{className:"border-2 font-mono text-sm text-muted-foreground p-1 w-full justify-center flex rounded-spacing-xs border-yellow-400/80 border-dashed items-center",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[!!e&&'model_server_url: "'.concat(e,'" '),!!t&&" model_server_stream_params: ".concat(t)]}),(0,a.jsx)("div",{className:"flex items-center justify-between ml-4",children:(0,a.jsx)(l.zx,{variant:"outline",className:"w-32 rounded-spacing-xs text-xs h-6",onPress:s,children:"Clear Override"})})]}):null}function A(){let e=(0,n.BF)(r.AR);return(0,a.jsxs)(l.zx,{variant:"ghost",className:"flex justify-between gap-3 font-mono text-sm w-full rounded-spacing-xs",onPress:()=>{(0,f.K)(e?"Debug mode disabled. Debug info will no longer be attached to new messages.":"Debug mode enabled. New messages should have debug info attached."),e||(0,g.e3)("neo-prod.characterai.dev"),(0,g.yD)(!e),r.AR.value=!e},children:[(0,a.jsx)(u.tvD,{className:(0,p.cn)("ml-1 size-4",{"text-muted-foreground":!e,"text-green-500":e})}),(0,a.jsx)(_.j,{className:"text-muted-foreground",phrases:[e?"{ disable debug stats }":"{ enable debug stats }"]})]})}function O(){let{hermesGenerationEnabled:e,hermesGenerationTemplate:t}=(0,g.$K)(),[s,r]=(0,b.useState)(null!=t?t:""),n=(null!=t?t:"")!==s,[,i]=(0,b.useState)(0),o=()=>i(e=>e+1);return(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)(l.zx,{variant:"ghost",className:"flex justify-between gap-3 font-mono text-sm w-full rounded-spacing-xs",onPress:()=>{(0,g.yi)({hermesGenerationEnabled:!e}),o()},children:[(0,a.jsx)(y.wJk,{className:(0,p.cn)("ml-1 size-4",{"text-muted-foreground":!e,"text-yellow-400":e})}),(0,a.jsx)("div",{className:"text-muted-foreground",children:e?"{ disable hermes templates }":"{ enable hermes templates }"})]}),!!e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.g,{className:"text-[10px] font-mono border-none bg-surface-elevation-1 p-1 resize-y overflow-x-scroll max-h-64 rounded-none",inputMode:"text",placeholder:"{% template %}",wrap:"off",onChange:e=>r(e.target.value),value:s}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(l.zx,{variant:"outline",className:"w-32 rounded-spacing-xs",isDisabled:!n,onPress:()=>{(0,g.yi)({hermesGenerationTemplate:s}),o()},children:"Save"}),!!t&&(0,a.jsx)("div",{className:"font-mono text-sm text-center",children:"template applied"})]})]})]})}function k(){let{safetyInstruction:e}=(0,g.$K)(),[t,s]=(0,b.useState)(null!=e?e:""),r=(null!=e?e:"")!==t;(0,b.useEffect)(()=>{e&&s(e)},[e]);let[,n]=(0,b.useState)(0),i=()=>n(e=>e+1);return(0,a.jsxs)("div",{className:"flex flex-col p-2 gap-2 text-sm bg-secondary/20 rounded-spacing-xs",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:" Safety Instructions"}),(0,a.jsx)(m.g,{className:"text-[10px] font-mono border-none bg-surface-elevation-1 p-2 resize-y overflow-x-scroll h-fit max-h-64 rounded-none",inputMode:"text",placeholder:"Set safety instructions",onChange:e=>s(e.target.value),value:t}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)(l.zx,{variant:"outline",className:"w-fit h-fit text-sm rounded-spacing-xs",isDisabled:!r,onPress:()=>{(0,g.s0)(t),i()},children:"Save"})})]})}},43855:function(e,t,s){s.d(t,{j:function(){return l}});var a=s(52322),r=s(2784);class n{setText(e){let t=this.el.innerText,s=Math.max(t.length,e.length),a=new Promise(e=>this.resolve=e);this.queue=[];for(let a=0;a<s;a++){let s=t[a]||"",r=e[a]||"",n=Math.floor(40*Math.random()),l=n+Math.floor(40*Math.random());this.queue.push({from:s,to:r,start:n,end:l})}return cancelAnimationFrame(this.frameRequest),this.frame=0,this.update(),a}update(){let e="",t=0;for(let s=0,a=this.queue.length;s<a;s++){let a=this.queue[s];if(null==a)continue;let{from:r,to:n,start:l,end:i}=a,{char:o}=a;this.frame>=i?(t++,e+=n):this.frame>=l?((!o||.28>Math.random())&&(o=this.randomChar(),this.queue[s].char=o),e+='<span class="text-muted-foreground">'.concat(o,"</span>")):e+=r}this.el.innerHTML=e,t===this.queue.length?this.resolve({}):(this.frameRequest=requestAnimationFrame(this.update),this.frame++)}randomChar(){return this.chars[Math.floor(Math.random()*this.chars.length)]}constructor(e){this.el=e,this.chars="!<>-_\\/[]{}â€”=+*^?#________",this.update=this.update.bind(this),this.frameRequest=0,this.queue=[],this.frame=0,this.resolve=()=>{}}}function l(e){let{phrases:t,className:s="",autoInterval:l=0}=e,i=(0,r.useRef)(null),o=(0,r.useRef)(),u=(0,r.useRef)(),[d,c]=(0,r.useState)(0);return(0,r.useEffect)(()=>{if(clearTimeout(o.current),i.current){let e=new n(i.current);o.current=setTimeout(()=>{e.setText(t[d])},600)}return()=>clearTimeout(o.current)},[t,d]),(0,r.useEffect)(()=>{l&&(u.current=setInterval(()=>{c((d+1)%t.length)},l))},[l,d,t.length]),(0,a.jsx)("div",{className:s,ref:i,onMouseEnter:()=>{c((d+1)%t.length)}})}},14031:function(e,t,s){s.d(t,{t:function(){return c},G:function(){return m}});var a=s(52322),r=s(59860),n=s(2784),l=s(4741),i=s(10929),o=s(61676);let u=(0,i.j)("text-sm inline-flex items-center justify-center rounded-md font-medium ring-offset-background transition-colors data-[state=on]:bg-accent data-[state=on]:text-accent-foreground hover:bg-accent hover:text-primary focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground","slightly-opaque":"bg-transparent hover:opacity-80 transition-opacity"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}});n.forwardRef((e,t)=>{let{className:s,variant:r,size:n,...i}=e;return(0,a.jsx)(l.f,{ref:t,className:(0,o.cn)(u({variant:r,size:n,className:s})),...i})}).displayName=l.f.displayName;let d=n.createContext({size:"default",variant:"default"}),c=n.forwardRef((e,t)=>{let{className:s,variant:n,size:l,children:i,...u}=e;return(0,a.jsx)(r.fC,{ref:t,className:(0,o.cn)("flex items-center justify-center gap-1",s),...u,children:(0,a.jsx)(d.Provider,{value:{variant:n,size:l},children:i})})});c.displayName=r.fC.displayName;let m=n.forwardRef((e,t)=>{let{className:s,children:l,variant:i,size:c,...m}=e,f=n.useContext(d);return(0,a.jsx)(r.ck,{ref:t,className:(0,o.cn)(u({variant:f.variant||i,size:f.size||c}),s),...m,children:l})});m.displayName=r.ck.displayName},30021:function(e,t,s){s.d(t,{S:function(){return f}});var a=s(52322),r=s(35981),n=s(92599),l=s(93326),i=s(3927),o=s(34318),u=s(70393),d=s(2784);let c={[u.ON.MARK_SAFE_U18]:"Mark safe under 18",[u.ON.MARK_SAFE]:"Mark safe",[u.ON.MARK_HORRIBLE]:"Mark horrible",[u.ON.MARK_UNSAFE]:"Mark unsafe",[u.ON.DMCA]:"DMCA",[u.ON.REVERT_DMCA]:"Revert DMCA"},m=e=>{let{action:t,onSubmit:s,portalContainer:r,disabled:n}=e,[o,m]=(0,d.useState)(!1),[f,h]=(0,d.useState)(void 0);return(0,a.jsxs)(i.Vq,{open:o,onOpenChange:m,children:[(0,a.jsx)(i.hg,{asChild:!0,children:(0,a.jsx)(l.zx,{variant:"ghost",className:"flex justify-start rounded-spacing-xs hover:bg-danger text-sm w-full",isDisabled:n,children:c[t]})}),(0,a.jsxs)(i.cZ,{portalContainer:r,children:[(0,a.jsxs)(i.fK,{children:[(0,a.jsxs)(i.$N,{children:["Take Action: ",c[t]]}),(0,a.jsx)(i.Be,{className:"text-md pt-1",children:"Are you sure you want to take this action?"})]}),t===u.ON.REVERT_DMCA&&(0,a.jsx)("input",{className:"w-[440px] px-2 py-2",type:"number",value:f||"",placeholder:"input previous user id",onChange:e=>h(e.target.value)}),(0,a.jsx)(i.cN,{children:(0,a.jsx)(i.GG,{asChild:!0,children:(0,a.jsx)(l.zx,{className:"mt-1",variant:"primary",onPress:()=>{t===u.ON.REVERT_DMCA?s(parseInt(f||"",10)):s()},isDisabled:t===u.ON.REVERT_DMCA&&!(null==f?void 0:f.trim()),children:"Submit"})})})]})]})},f=e=>{let{characterId:t,onAction:s,disabled:i,showRevert:c=!1}=e,[f,h]=(0,d.useState)(!1),{mutateAsync:x}=o.h.moderation.moderateCharacter.useMutation(),p=Object.values(u.ON).filter(e=>e!==u.ON.REVERT_DMCA||c).map(e=>({content:(0,a.jsx)(m,{action:e,onSubmit:async a=>{await x({externalId:t,action:e,...e===u.ON.REVERT_DMCA&&a?{charPrevUserId:a}:{}}),s()},disabled:i}),asChild:!0,key:e}));return(0,a.jsx)(r.C,{options:p,isOpen:f,setIsOpen:h,contentClassName:"gap-1 w-40",align:"center",disabled:i,asChild:!0,children:(0,a.jsxs)(l.zx,{className:"h-8",isDisabled:i,onPress:()=>h(!f),children:["Take Action",(0,a.jsx)(n.v4q,{height:"16px"})]})})}}}]);