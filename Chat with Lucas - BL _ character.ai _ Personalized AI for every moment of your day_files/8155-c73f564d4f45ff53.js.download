"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8155],{99717:function(e,t,l){l.d(t,{o:function(){return s}});var a=l(52322),i=l(55264),r=l(66149),n=l(10386),o=l(92599),u=l(93326);let s=e=>{let{characterId:t}=e,l=(0,r.Z)(),{t:s}=(0,n.$G)();return(0,a.jsx)(u.zx,{"aria-label":s("Common.share"),isIconOnly:!0,variant:"outline",onPress:()=>l(i.nN.chat(t),"Character"),children:(0,a.jsx)(o.aAc,{className:"size-4 text-muted-foreground"})})}},69411:function(e,t,l){l.d(t,{hv:function(){return x}});var a,i,r=l(52322),n=l(21236),o=l(48364),u=l(61676),s=l(55264),d=l(3963),c=l(38978),v=l(13789),p=l(38738),g=l(2784),h=l(10386),f=l(92599),m=l(46272),b=l(14031),y=l(2608);(a=i||(i={})).like="like",a.dislike="dislike";let w={like:!0,dislike:!1},x=e=>{var t;let{characterId:l,hideNum:a,disabled:i,type:u}=e,{t:s,i18n:f}=(0,h.$G)(),{character:m}=(0,c.XS)(null!=l?l:"",f.language),{data:b}=(0,p.eq)(l),{votedUp:x,votedDown:N}=(0,g.useMemo)(()=>({votedUp:!!(null==b?void 0:b.voted)&&!!(null==b?void 0:b.vote),votedDown:!!(null==b?void 0:b.voted)&&!(null==b?void 0:b.vote)}),[null==b?void 0:b.voted,null==b?void 0:b.vote]),F=(0,g.useMemo)(()=>x?"like":N?"dislike":void 0,[x,N]),{mutate:C}=(0,p.kP)(),Q=(0,v.NL)();return(0,r.jsx)(k,{value:F,onValueChange:e=>{let t=F===e?null:e;C({characterId:l,vote:t?w[t]:null},{onSuccess:()=>{n.iN.userSocialAction({referrer:"CharacterVote",type:"vote",characterId:l,voteType:t||""}),Q.invalidateQueries((0,d.Hc)().info.keys(l))},onError:e=>{(0,y.K)(s("Error.something-went-wrong"),void 0,"destructive"),(0,o.H)("Failed to vote",{error:e})}})},upvotes:null!==(t=null==m?void 0:m.upvotes)&&void 0!==t?t:0,hideNum:a,disabled:i,type:u})},k=e=>{let{value:t,onValueChange:l,upvotes:a,hideNum:i,disabled:n,type:o}=e,{t:d}=(0,h.$G)(),c="small"===o?"12px":"16px";return(0,r.jsxs)(b.t,{disabled:n,type:"single",value:t,onValueChange:e=>l(e),className:"border-1 rounded-spacing-l border-surface-elevation-2 h-fit w-fit",children:[(0,r.jsxs)(b.G,{value:"like","aria-label":d("Common.like"),className:(0,u.cn)("data-[state=on]:bg-transparent p-0 h-fit hover:bg-transparent flex flex-row gap-1 group/like","small"===o?"py-1 pl-2":"py-3 pl-3"),children:[(0,r.jsx)(f.eLy,{height:c,className:(0,u.cn)("group-hover/like:text-muted-foreground text-icon-secondary",{hidden:"like"!==t})}),(0,r.jsx)(f.lbB,{height:c,className:(0,u.cn)("group-hover/like:text-muted-foreground text-icon-secondary",{hidden:"like"===t})}),!i&&!!a&&(0,s.HN)(a)]}),(0,r.jsx)(m.Z,{orientation:"vertical",className:"h-5 mx-1 p-0"}),(0,r.jsxs)(b.G,{value:"dislike","aria-label":d("Common.dislike"),className:(0,u.cn)("data-[state=on]:bg-transparent p-0 h-fit hover:bg-transparent group/dislike","small"===o?"py-1 pr-2":"py-3 pr-3"),children:[(0,r.jsx)(f.C$L,{height:c,className:(0,u.cn)("group-hover/like:text-muted-foreground text-icon-secondary",{hidden:"dislike"!==t})}),(0,r.jsx)(f.kZ9,{height:c,className:(0,u.cn)("group-hover/like:text-muted-foreground text-icon-secondary",{hidden:"dislike"===t})})]})]})}},86202:function(e,t,l){l.d(t,{h:function(){return i}});var a=l(52322);let i=e=>{let{ldJsonSchema:t}=e;return(0,a.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(t).replace(/\//g,"\\/")}})}},38738:function(e,t,l){l.d(t,{Ft:function(){return g},Os:function(){return c},QJ:function(){return m},Sz:function(){return u},bu:function(){return d},eq:function(){return h},hO:function(){return v},kP:function(){return f},qY:function(){return p},xS:function(){return s}});var a=l(2784),i=l(79937),r=l(92357),n=l(3963),o=l(13789);let u={user:["user"],publicUser:e=>[...u.user,"public",e],publicFollowers:e=>[...u.user,"public","followers",e],publicFollowing:e=>[...u.user,"public","following",e],followers:()=>[...u.user,"followers"],following:()=>[...u.user,"following"],votedFor:e=>[...u.user,"voted-for",e],votes:e=>["votes",e],upvotesByCharacter:e=>["upvotes-by-character",e],upvotedCharacters:()=>[...u.user,"upvoted-characters"],invite:["social","inviteForLoggedInUser"],inviteCheckOnly:["social","inviteForLoggedInUser","checkOnly"],inviteByCode:e=>["social","inviteByCode",e],inviteSenderRewardEligibility:["social","inviteSenderRewardEligibility"]},s=(e,t,l)=>{let a=(0,o.aM)({queryKey:u.publicUser(e),queryFn:async()=>t?(await (0,i.m)().fetchUserAnon(e)).data.public_user:(await (0,i.m)().fetchUserPublic(e)).data.public_user,staleTime:1/0,initialData:null==l?void 0:l.preloaded,enabled:null==l?void 0:l.enabled});return{user:a.data,...a}},d=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1?arguments[1]:void 0,l=(0,o.aM)({queryKey:u.following(),queryFn:async()=>{var e;let l=await (null==t?void 0:null===(e=t.getHeaders)||void 0===e?void 0:e.call(t));return(await (0,r.od)().get("/chat/user/following/",{headers:l})).data.following},staleTime:1/0,enabled:e});return{following:l.data,...l}},c=()=>{let e=(0,o.NL)();return(0,o.Db)(async e=>{let{username:t,requesterUsername:l}=e;return{...(await (0,r.od)().post("/chat/user/follow/",{username:t})).data,username:t,requesterUsername:l}},{onSuccess:t=>{let{username:l,requesterUsername:a}=t;e.invalidateQueries(u.following()),a&&(e.invalidateQueries(u.publicFollowing(a)),e.invalidateQueries(u.publicUser(a))),e.invalidateQueries(u.publicUser(l)),e.invalidateQueries(u.publicFollowers(l))}})},v=()=>{let e=(0,o.NL)();return(0,o.Db)(async e=>{let{username:t,requesterUsername:l}=e;return{...(await (0,r.od)().post("/chat/user/unfollow/",{username:t})).data,username:t,requesterUsername:l}},{onSuccess:t=>{let{username:l,requesterUsername:a}=t;e.invalidateQueries(u.following()),a&&(e.invalidateQueries(u.publicFollowing(a)),e.invalidateQueries(u.publicUser(a))),e.invalidateQueries(u.publicUser(l)),e.invalidateQueries(u.publicFollowers(l))}})},p=(e,t)=>{var l;let i=(0,o.NS)(u.publicFollowers(e),async t=>{let{pageParam:l}=t;return e?(await (0,r.od)().post("/chat/user/public/followers/",{username:e,pageParam:null!=l?l:1})).data:{users:[],has_next_page:!1,meta:{}}},{enabled:null==t?void 0:t.enabled,getNextPageParam:(e,t)=>e.has_next_page?t.length+1:void 0,staleTime:1/0}),n=(0,a.useMemo)(()=>{var e,t,l;return(null!==(l=null===(t=i.data)||void 0===t?void 0:null===(e=t.pages)||void 0===e?void 0:e.flatMap(e=>e.users))&&void 0!==l?l:[]).filter(e=>!!(null==e?void 0:e.username))},[null===(l=i.data)||void 0===l?void 0:l.pages]);return{...i,users:n}},g=(e,t)=>{var l;let i=(0,o.NS)(u.publicFollowing(e),async t=>{let{pageParam:l}=t;return e?(await (0,r.od)().post("/chat/user/public/following/",{username:e,pageParam:null!=l?l:1})).data:{users:[],has_next_page:!1,meta:{}}},{enabled:null==t?void 0:t.enabled,getNextPageParam:(e,t)=>e.has_next_page?t.length+1:void 0,staleTime:1/0}),n=(0,a.useMemo)(()=>{var e,t,l;return(null!==(l=null===(t=i.data)||void 0===t?void 0:null===(e=t.pages)||void 0===e?void 0:e.flatMap(e=>e.users))&&void 0!==l?l:[]).filter(e=>!!(null==e?void 0:e.username))},[null===(l=i.data)||void 0===l?void 0:l.pages]);return{...i,users:n}},h=e=>{var t,l;let a=(0,o.aM)({queryKey:u.votedFor(e),queryFn:async()=>await (0,i.m)().getVotedFor(e),staleTime:1/0});return{voted:null===(t=a.data)||void 0===t?void 0:t.voted,vote:null===(l=a.data)||void 0===l?void 0:l.vote,...a}},f=()=>{let e=(0,o.NL)();return(0,o.Db)(async e=>{let{characterId:t,vote:l}=e;return{...await (0,i.m)().voteCharacter(t,l),characterId:t}},{onSuccess:t=>{e.invalidateQueries(u.votes(t.characterId)),e.invalidateQueries(u.votedFor(t.characterId)),e.invalidateQueries(u.upvotedCharacters()),e.invalidateQueries((0,n.Hc)().info.keys(t.characterId))}})},m=e=>{let t=(0,o.aM)({queryKey:u.upvotedCharacters(),queryFn:async()=>await (0,i.m)().getUpvotedCharacters(),staleTime:1/0,enabled:!e});return{characters:t.data,...t}}}}]);