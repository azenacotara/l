"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8361],{45736:function(e,t,s){s.d(t,{X:function(){return o}});var l=s(52322),r=s(29338),i=s(2784),c=s(92599),n=s(61676);let o=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,l.jsx)(r.fC,{ref:t,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-spacing-xxs border border-primary disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...i,children:(0,l.jsx)(r.z$,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,l.jsx)(c.KML,{className:"h-2 w-2"})})})});o.displayName=r.fC.displayName},54900:function(e,t,s){s.d(t,{B:function(){return B},K:function(){return q}});var l=s(52322),r=s(21236),i=s(9010),c=s(40022),n=s(98178),o=s(24497),a=s(33002),d=s(92599),u=s(93326),m=s(55274),x=s(39395),h=s(57960),v=s(10386);function f(e){let{voice:t,onClickSelectButton:s,onClickDetailView:r,isSelected:i,systemSuggestedVoice:c}=e,{t:n}=(0,v.$G)(),a="private"===t.visibility;return(0,l.jsxs)("div",{className:"px-4 py-2 group gap-3 flex items-center hover:bg-surface-elevation-3 w-full max-w-lg",children:[(0,l.jsx)(o.K,{id:t.id,className:"w-14 h-14 shrink-0"}),(0,l.jsxs)("div",{onClick:r,className:"grow flex flex-col bg-transparent rounded-none justify-start items-start p-0 h-full text-md text-muted-foreground hover:cursor-pointer gap-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 text-foreground",children:[(0,l.jsx)("p",{className:"line-clamp-1 text-left break-all",children:t.name}),!!a&&(0,l.jsx)(d.mBM,{className:"size-4 min-w-4"})]}),(0,l.jsx)(g,{voice:t,systemSuggestedVoice:c})]}),!!i&&(0,l.jsx)(d.KML,{className:"block md:group-hover:hidden mr-3",color:"#0687F1",height:"1.25em",width:"1.25em"}),(0,l.jsx)(u.zx,{onPress:s,className:"hidden md:group-hover:block",variant:i?"outline":"primary",children:n(i?"Common.unselect":"Common.select")})]})}let g=e=>{let{voice:t,systemSuggestedVoice:s}=e,{t:r}=(0,v.$G)(),{characterId:i,character:c}=(0,m.AU)(),{voiceOverride:n}=(0,x.uO)(i),o=n&&n.voice_id!==(null==c?void 0:c.default_voice_id);switch(p(t.id,!!o,null==c?void 0:c.default_voice_id,s)){case h.sF.Creator:return(0,l.jsx)("div",{className:"bg-accent text-sm text-primary rounded-sm p-2 pb-1 pt-1",children:r("Voice.default")});case h.sF.System:return(0,l.jsxs)("div",{className:"bg-accent text-sm text-primary rounded-sm p-2 pb-1 pt-1 flex gap-1 items-center",children:[(0,l.jsx)(d.qzz,{width:"0.75rem",height:"0.75rem"}),(0,l.jsx)("div",{children:r("Voice.system-suggested")})]});default:return(0,l.jsx)(a.g,{voice:t,clickable:!1})}},p=(e,t,s,l)=>t||!e?void 0:e===s?h.sF.Creator:e===l?h.sF.System:void 0;var j=s(61676);function y(e){let{children:t,className:s,...r}=e;return(0,l.jsx)("div",{className:(0,j.cn)("flex items-center justify-center",s),...r,children:t})}var V=s(3927),N=s(80729),b=s(35740),S=s(67378),w=s(15030),C=s(43145),k=s(2784);let _=()=>{try{let e=(0,C.tv)(w.hl.Keys.RecentlyUsedVoices);if(!e)return[];return e}catch(e){return[]}},X=e=>{try{(0,C.co)(w.hl.Keys.RecentlyUsedVoices,e)}catch(e){}},z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,[t,s]=(0,k.useState)(_),l=(0,k.useCallback)(t=>{s(s=>{let l=s.filter(e=>e.id!==t.id);return[t,...l].slice(0,e)})},[e]);return(0,k.useEffect)(()=>{X(t)},[t]),{markRecentlyUsedVoice:l,recentlyUsedVoices:t}};var K=s(92488),$=s(83944),D=s(20808);let P=()=>{var e;let t=$.w.getAmplitudeVariantPayload(D.b.DemoteSystemVoices);return null!==(e=null==t?void 0:t.startIndex)&&void 0!==e?e:0};var R=s(55264),U=s(81364);function F(e){let{onChange:t,searchQuery:s,isSearchLoading:r,iconSize:c,clearSearch:n,autoFocus:o=!1}=e,{t:a}=(0,v.$G)(),m=(0,k.useRef)(null);return(0,l.jsxs)("div",{className:"z-40 flex w-full max-w-lg border-spacing-1 flex-row self-center items-center rounded-none bg-transparent p-0 placeholder:text-muted-foreground border-t-px border-b-px border-accent",children:[(0,l.jsx)(u.zx,{variant:"ghost",isIconOnly:!0,onPress:()=>{var e;null===(e=m.current)||void 0===e||e.focus()},className:"ml-3",children:r?(0,l.jsx)(i.$,{size:c}):(0,l.jsx)(d.W1M,{height:"16px",className:"text-muted-foreground"})}),(0,l.jsx)(U.I,{className:"rounded-none border-none bg-transparent placeholder:text-placeholder pl-0",type:"text",ref:m,placeholder:a("Voice.search-label"),onChange:t,value:s,label:"",autoFocus:o}),!!s&&(0,l.jsx)(u.zx,{variant:"ghost",isIconOnly:!0,className:"mr-4",onPress:n,children:(0,l.jsx)(d.Two,{height:"1em"})})]})}var I=s(84938),G=s(14488),E=s(31396),M=s(5632),O=s(15584);let A={[G.Xg.Discover.toString()]:G.Xg.Discover,[G.Xg.YourVoices.toString()]:G.Xg.YourVoices,[G.Xg.Recent.toString()]:G.Xg.Recent};function B(){let{overrideVoice:e,voiceId:t}=(0,S.AW)();return(0,x.yW)(t),(0,l.jsx)(q,{selectVoice:(s,l)=>{e(t===s?void 0:s,"ChatVoiceSelection",l),K.UK.value=!1},selectedVoiceId:t})}function q(e){var t,s;let{selectVoice:i,selectedVoiceId:o,renderTrigger:a,implicitVoiceSearchString:d,hideSystemVoices:h}=e,{t:f}=(0,v.$G)(),{searchQuery:g,searchResults:p,isSearchLoading:j,clearSearch:y,onChangeSearchText:S}=(0,c.T4)(void 0,!1,"ChatVoiceSelection"),{character:w}=(0,m.AU)(),C=(0,M.useRouter)(),_=(0,O.BF)(K.UK),{searchResults:X}=(0,I.Vo)(null!==(s=null!=d?d:null==w?void 0:w.name)&&void 0!==s?s:"",!0,!_),{voices:$}=(0,I.qc)(),{voices:D}=(0,I.f$)(),{featuredVoices:U}=(0,I.yo)(),{recentlyUsedVoices:B,markRecentlyUsedVoice:q}=z(),{stopVoicePreview:W}=(0,x.ZU)(null),{voice:Y}=(0,I.Kl)(null==w?void 0:w.default_voice_id,!0),Z=Y?void 0:null==X?void 0:null===(t=X[0])||void 0===t?void 0:t.id,{voice:Q}=(0,I.Kl)(o,!0);(0,k.useEffect)(()=>{Q&&q(Q)},[Q,q]);let{user:T}=(0,b.a)(),[H,J]=(0,k.useState)(G.Xg.Discover),[ee,et]=(0,k.useState)(null),es=e=>{et(e)};(0,k.useEffect)(()=>{et(null)},[o]);let el=(0,k.useMemo)(()=>(0,G.dx)({tab:H,user:T,currentlySelectedVoice:Q,defaultCharacterVoice:Y,implicitSearchResults:X,searchQuery:g,searchResults:p,systemVoices:h?[]:$,userVoices:D,systemVoiceStartIndex:P(),recentlyUsedVoices:B,featuredVoices:U}),[H,T,Q,Y,X,g,p,$,D,h,B,U]);(0,k.useEffect)(()=>{W()},[W,el]);let er=(0,k.useMemo)(()=>el.find(e=>e.id===ee),[ee,el]);return er?(0,l.jsx)(n.V,{isOpen:_,voice:er,onClose:()=>es(null),isSelected:o===er.id,selectVoice:(e,t)=>{i(e,g,t),r.iN.voiceSelected({voice_id:e,referrer:"ChatVoiceSelection",all_search_result_ids:null==p?void 0:p.map(e=>e.id)})},referrer:"ChatVoiceSelection",action:"override"}):(0,l.jsxs)(V.Vq,{open:_,onOpenChange:e=>{K.UK.value=e},analyticsProps:{referrer:"ChatVoice",type:"ChatVoiceSelection"},children:[null==a?void 0:a(),(0,l.jsxs)(V.cZ,{className:"p-0 cursor-default w-full max-w-lg h-dvh md:h-[70dvh] overflow-y-auto overflow-x-hidden flex flex-col",hideClose:!0,children:[(0,l.jsxs)(V.fK,{className:"flex flex-row items-center justify-between w-full px-5 pt-1 -mb-4 h-fit",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center gap-4 text-md",children:[(0,l.jsxs)(V.GG,{children:[(0,l.jsx)(E.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,l.jsx)("span",{className:"sr-only",children:f("Common.close")})]}),(0,l.jsx)(V.$N,{children:f("Voice.voices")})]}),(0,l.jsx)(u.zx,{variant:"outline",onPress:()=>{C.push(R.nN.voice())},children:f("CreateVoice.screen.create")})]}),(0,l.jsx)(N.mQ,{value:H.toString(),tabIndex:-1,onValueChange:e=>{var t;return J(null!==(t=A[e])&&void 0!==t?t:G.Xg.Discover)},className:"flex flex-col items-start p-0 m-0",children:(0,l.jsxs)(N.dr,{className:"px-4 pb-0 -mb-px",children:[(0,l.jsx)(N.SP,{value:G.Xg.Discover.toString(),children:f("Voice.discover")}),(0,l.jsx)(N.SP,{value:G.Xg.YourVoices.toString(),children:f("Voice.your-voices")}),(0,l.jsx)(N.SP,{value:G.Xg.Recent.toString(),children:f("Voice.recent")})]})}),(0,l.jsxs)("div",{className:"-mt-4 overflow-y-auto",children:[H===G.Xg.Discover&&(0,l.jsx)(F,{autoFocus:0===el.length,onChange:e=>S(e.target.value),searchQuery:g,isSearchLoading:j,iconSize:16,clearSearch:y}),(0,l.jsx)(L,{onSelect:(e,t)=>i(e,g,t),onSelectDetailView:es,selectedVoiceId:null==Q?void 0:Q.id,systemSuggestedVoice:Z,voices:el})]})]})]})}function L(e){let{onSelect:t,onSelectDetailView:s,selectedVoiceId:r,voices:c,isLoading:n,systemSuggestedVoice:o}=e,{t:a}=(0,v.$G)();return n?(0,l.jsx)(y,{className:"h-20",children:(0,l.jsx)(i.$,{size:16})}):0===c.length?(0,l.jsx)(y,{className:"h-20",children:a("Voice.no-voices")}):(0,l.jsx)("div",{className:"flex flex-col h-auto gap-3 py-2 -mt-1",children:c.map(e=>(0,l.jsx)(f,{voice:e,onClickSelectButton:()=>{t(e.id,e.name)},onClickDetailView:()=>s(e.id),isSelected:r===e.id,systemSuggestedVoice:o},e.id))})}}}]);