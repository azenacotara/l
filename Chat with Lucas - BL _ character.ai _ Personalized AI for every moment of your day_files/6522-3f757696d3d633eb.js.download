"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6522],{63276:function(e,t,a){a.d(t,{b:function(){return l},x:function(){return d}});var s=a(48364),n=a(75657),r=a(92642),o=a(2784);let i=e=>{let{name:t,operationName:a,attributes:s}=e,i=(0,o.useRef)(),l=(0,o.useRef)();return{start:(0,o.useCallback)(()=>{i.current||n.GK({name:t,op:a,attributes:s},e=>{i.current=e,l.current=Date.now()})},[t,a,s]),finish:(0,o.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(i.current){if(e){r.n_({message:"Span aborted: ".concat(t),level:"warning",data:{operationName:a,attributes:s}}),i.current=void 0,l.current=void 0;return}l.current&&(l.current=void 0),i.current.end(),i.current=void 0}},[t,a,s])}},l=e=>{let t=(0,o.useRef)(!1),{start:a,finish:s}=i({name:"FirstChunkLatency",operationName:"streaming",attributes:{measure_latency:"first_chunk"}}),n=(0,o.useCallback)(()=>{t.current||(t.current=!0,a())},[a]);return(0,o.useEffect)(()=>{"none"===e&&(t.current=!1),t.current&&"streaming"===e&&(t.current=!1,s())},[e,s]),{startMeasurement:n}},d=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,n=!(arguments.length>3)||void 0===arguments[3]||arguments[3],r="loading",l=(0,o.useRef)(null),{start:d,finish:c}=i({name:t,operationName:r});(0,o.useEffect)(()=>{if(n)return e?(d(),a&&(l.current=setTimeout(()=>{c(!0),(0,s.H)("useMeasureLoadingLatency aborted due to timeout",{extra:{referrer:t,operationName:r,timeout:a}})},a))):!e&&(c(),l.current&&(clearTimeout(l.current),l.current=null)),()=>{l.current&&clearTimeout(l.current)}},[e,d,c,a,t,n])}},22801:function(e,t,a){a.d(t,{o:function(){return l}});var s=a(52322),n=a(92488),r=a(15030),o=a(93326),i=a(92599);let l=e=>{let{trigger:t,disabled:a=!1}=e;return(0,s.jsx)(o.zx,{isDisabled:a,onPress:()=>{n.uW.value=t,localStorage.setItem(r.hl.Keys.BetaEducationShown,"true")},size:"sm",variant:"outline",className:"rounded-spacing-xxs p-1 text-sm h-6 text-muted-foreground border-1 border-muted-foreground",children:(0,s.jsxs)("div",{className:"flex gap-1 text-sm",children:[(0,s.jsx)(i.ynJ,{className:"size-4 ml-0"}),"BETA"]})})}},81181:function(e,t,a){a.d(t,{E:function(){return r},U:function(){return o}});var s=a(52322),n=a(50090);let r=e=>{let{name:t,className:a}=e;return(0,s.jsx)("p",{className:a,children:t})},o=e=>{let{name:t,href:a,referrer:o,characterId:i,className:l}=e;return(0,s.jsx)(n.Z,{href:a,analytics:{name:"linkHandled",properties:{link:a,referrer:o,character_id:i}},children:(0,s.jsx)(r,{name:t,className:l})})}},79357:function(e,t,a){a.d(t,{F:function(){return l}});var s=a(52322),n=a(61676),r=a(85727),o=a(2784),i=a(10386);let l=()=>{let{t:e}=(0,i.$G)(),[t,a]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let e=e=>{let t=e.target;((null==t?void 0:t.tagName)==="INPUT"||(null==t?void 0:t.tagName)==="TEXTAREA")&&a(!1)};return window.addEventListener("focusin",e),()=>{window.removeEventListener("focusin",e)}},[a]),(0,s.jsxs)("button",{type:"button","aria-label":e("Common.expand"),onClick:()=>{a(!t)},className:"relative flex items-center justify-center -mt-2",children:[(0,s.jsx)("p",{className:"text-muted-foreground text-[0.70rem] select-none",children:e(t?"Common.fiction-warning-expanded":"Common.fiction-warning-collapsed")}),!t&&(0,s.jsx)(r.Z,{className:(0,n.cn)("text-muted-foreground h-4 transition-transform duration-200",{"rotate-180":t})})]})}},92734:function(e,t,a){a.d(t,{P:function(){return o}});var s=a(52322),n=a(61676),r=a(66582);let o=e=>{let{header:t,children:a,containerClassName:o,innerClassName:i,childrenClassName:l,handleScroll:d}=e;return(0,s.jsx)("div",{className:(0,n.cn)("h-full w-full flex flex-row justify-center",o),onScroll:d,children:(0,s.jsx)("div",{className:(0,n.cn)("flex h-full w-full flex-col justify-between px-4 sm:px-8 pt-6 max-w-7xl items-center",{"p-0":r.tq}),children:(0,s.jsxs)("div",{className:(0,n.cn)("w-full h-full",i),children:[t,(0,s.jsx)("ol",{className:(0,n.cn)("flex flex-col",l),children:a})]})})})}},4630:function(e,t,a){a.d(t,{a:function(){return c}});var s=a(52322),n=a(35740),r=a(74251),o=a(61676),i=a(55264),l=a(50090),d=a(46086);let c=()=>{let e=(0,r.Dv)(),{user:t}=(0,n.a)();return t?null:(0,s.jsx)("div",{className:"flex flex-row w-full justify-start",children:(0,s.jsx)(l.Z,{href:i.nN.home(),className:(0,o.cn)("flex items-center h-fit",e?"pt-2":"pt-1",{"pl-2":e}),analytics:{name:"linkOpened",properties:{referrer:"LogoHeaderSignedOut",link:i.nN.home()}},children:(0,s.jsx)(d.t,{size:e?"mini":"regular"})})})}},52779:function(e,t,a){a.d(t,{U:function(){return S}});var s,n,r=a(52322),o=a(2784),i=a(74251),l=a(69430);(s=n||(n={}))[s.link=0]="link",s[s.image=1]="image";let d=e=>{let{contentType:t}=e;return(0,r.jsx)("div",{className:"text-muted-foreground font-mono text-small",children:0===t?"[unsupported link]":"[unsupported media]"})};var c=a(93326),u=a(92599),h=a(92138),m=a(21236),g=a(50567),p=a(83614),f=a(10386);let b=()=>{let e=(0,p.useDynamicConfig)(g.Lo.AllowedDomainsForLinks);return{allowedDomainsWithoutConfirmation:e.get("no_confirmation_required",[]),allowedDomainsWithConfirmation:e.get("confirmation_required",[])}},x=()=>{let{allowedDomainsWithoutConfirmation:e,allowedDomainsWithConfirmation:t}=b(),{t:a}=(0,f.$G)(),s=(0,o.useCallback)(a=>{let s=!1,n=a,r=!0;try{let o=a.startsWith("http")?a:"https://".concat(a),i=new URL(o);e.includes(i.hostname)?(s=!0,r=!1):t.includes(i.hostname)&&(s=!0),n=i.toString()}catch(e){s=!1}return{isAllowed:s,url:n,requiresConfirmation:r}},[e,t]),i=(0,o.useCallback)(e=>{let{isAllowed:t,url:o,requiresConfirmation:i}=s((null==e?void 0:e.href)||"");return t?(0,r.jsx)("a",{href:o,onClick:e=>{let t=!0;i&&(e.preventDefault(),(t=window.confirm(a("OpenLinkConfirmation.message")))&&window.open(o,"_blank","noopener,noreferrer")),t&&m.iN.linkOpened({referrer:"markdown_hooks",site:o})},rel:"noopener noreferrer",target:"_blank",children:e.children}):(0,r.jsx)(d,{contentType:n.link})},[s,a]);return{isLinkAllowed:s,customLinkRender:i}},y=e=>{let t=null;return async()=>null!=t?t:t=await e()},v=e=>{let[t,a]=(0,o.useState)(null);return(0,o.useEffect)(()=>{e().then(e=>{a(e)})},[e]),t};var w=a(61676),P=a(55264);let A=(0,o.lazy)(()=>Promise.all([a.e(7715),a.e(400),a.e(5941),a.e(8365),a.e(1446)]).then(a.bind(a,91446))),k=(0,o.lazy)(()=>a.e(7790).then(a.bind(a,67790))),j=y(()=>Promise.all([a.e(7715),a.e(5941),a.e(119)]).then(a.bind(a,90119))),N=y(()=>Promise.all([a.e(4620),a.e(7715),a.e(400),a.e(4241)]).then(a.bind(a,74241))),_=y(()=>a.e(4597).then(a.bind(a,44597))),C=/language-(\w+)/;function H(e){let{children:t,forceSmallText:a,textStyle:s}=e,{t:o}=(0,f.$G)(),m=(0,i.Dv)(),g=(0,i.Ui)(),{isDenseChatStyle:p}=(0,h.ax)(),b=v(j),y=v(N),w=v(_),{customLinkRender:H}=x(),S=b&&w?[b.default,w.default]:[],I=y?[y.default]:[],q=!!a||p||m,D={...q&&{fontSize:14},...s};return(0,r.jsx)(A,{remarkPlugins:S,rehypePlugins:I,skipHtml:!0,components:{h1:e=>{let{children:t,...a}=e;return(0,r.jsx)("h1",{...a,style:D,children:t})},h2:e=>{let{children:t,...a}=e;return(0,r.jsx)("h2",{...a,style:D,children:t})},h3:e=>{let{children:t,...a}=e;return(0,r.jsx)("h3",{...a,style:D,children:t})},p:e=>{let{children:t,...a}=e;return(0,r.jsx)("p",{...a,style:{fontFamily:"var(--inter-font)",whiteSpace:"pre-wrap",lineHeight:1.5,wordBreak:"break-word",...D},children:t})},ul:e=>{let{children:t,...a}=e;return(0,r.jsx)("ul",{style:{lineHeight:"18px",paddingLeft:"16px",fontSize:q?14:16},...a,children:t})},ol:e=>{let{children:t,...a}=e;return(0,r.jsx)("ol",{style:{lineHeight:"18px",paddingLeft:"16px",fontSize:q?14:16},...a,children:t})},pre:e=>{let t=e.children;if("code"===t.props.node.tagName){let e=C.exec(t.props.className||""),{children:a}=t.props;return a?(0,r.jsxs)("div",{className:"py-3 overflow-hidden grid",children:[(0,r.jsxs)("div",{className:"bg-surface-elevation-2 px-2 font-mono justify-between flex flex-row-reverse text-md items-center",children:[(0,r.jsxs)(c.zx,{variant:"ghost",className:"h-min py-1 self-end",onPress:()=>{P.Wj.copyTextToClipboard(a,o("Common.code-copied-to-clipboard"),"chat_markdown")},children:[o("Common.copy")," ",(0,r.jsx)(u.TIy,{height:"1.25em"})]}),(null==e?void 0:e[1])||""]}),(0,r.jsx)(k,{style:l.Z,customStyle:{margin:0,overflowX:"scroll",fontSize:m?10:12,background:"var(--G950)"},codeTagProps:{className:"text-sm bg-surface-base m-0 overflow-x-scroll max-w-4xl min-max-w-4xl"},showLineNumbers:!!p&&g,language:(null==e?void 0:e[1])||"javascript",children:a.trimEnd()})]}):null}return(0,r.jsx)("pre",{children:e.children})},code:e=>(0,r.jsx)("code",{className:"bg-surface-elevation-2 p-1 font-light",children:e.children}),a:H,img:()=>(0,r.jsx)(d,{contentType:n.image}),image:()=>(0,r.jsx)(d,{contentType:n.image})},children:t})}function S(e){let{children:t,forceSmallText:a,textStyle:s,fullWidth:n}=e;return(0,r.jsx)("div",{className:(0,w.cn)("prose dark:prose-invert text-foreground",n?"max-w-full":"max-w-3xl"),children:(0,r.jsx)(H,{forceSmallText:a,textStyle:s,children:t})})}},30597:function(e,t,a){a.d(t,{d:function(){return h}});var s=a(52322),n=a(35740),r=a(61676),o=a(55264),i=a(6302),l=a(5632),d=a(66582),c=a(92734),u=a(4630);let h=e=>{let{children:t,showFullHeader:a,containerClassName:h,headerClassName:m,childrenClassName:g,handleScroll:p}=e,{asPath:f}=(0,l.useRouter)(),b=f.startsWith(o.nN.chat("")),{user:x}=(0,n.a)();return x?t:(0,s.jsx)(c.P,{header:a||b?(0,s.jsx)(i.$C,{hideSearch:!0,className:m}):(0,s.jsx)(u.a,{}),containerClassName:(0,r.cn)(b&&"pt-1 absolute top-0",b&&!d.tq&&"overflow-y-auto",h),innerClassName:(0,r.cn)(b&&d.tq&&"overflow-y-auto"),childrenClassName:(0,r.cn)(b&&"h-full w-full items-center",g),handleScroll:p,children:t})}},29700:function(e,t,a){var s=a(52322),n=a(57352),r=a(16310);t.Z=()=>(0,s.jsx)(n.E.div,{animate:"float",variants:{float:{y:["0%","-10%","0%"],transition:{duration:2,ease:"easeInOut",repeat:1/0}}},style:{display:"inline-block"},children:(0,s.jsx)(r.vah,{className:"size-24 text-muted-foreground"})})},18363:function(e,t,a){a.d(t,{f:function(){return u},m:function(){return h}});var s=a(52322),n=a(35206),r=a(92599),o=a(93326),i=a(3927),l=a(92488),d=a(10386),c=a(15584);let u=e=>{let{report:t,showText:a,className:n,variant:i}=e,{t:c}=(0,d.$G)();return(0,s.jsxs)(o.zx,{variant:i||"outline",isIconOnly:!a,className:n,"aria-label":c("Common.report"),onPress:()=>{l.Nd.value=!0,l.hl.value=t},children:[!!a&&c("Common.report"),(0,s.jsx)(r.cWE,{className:"size-4"})]})};function h(e){let{referrer:t}=e,a=(0,c.BF)(l.Nd),{t:r}=(0,d.$G)(),o=(0,c.BF)(l.hl);return(0,s.jsx)(i.Vq,{open:a,onOpenChange:e=>{l.Nd.value=e},analyticsProps:{referrer:t,type:"ReportDialog"},children:!!o&&(0,s.jsx)(n.o,{isOpen:a,title:r("Common.report"),report:o,onComplete:()=>{l.Nd.value=!1,l.hl.value=void 0}})})}},79444:function(e,t,a){a.d(t,{S:function(){return l}});var s=a(52322),n=a(2784),r=a(75702),o=a(61676),i=a(40789);function l(e){let{numDots:t=3,animating:a=!0,defaultValue:l=0,className:d}=e,[c,u]=(0,n.useState)(Array(t).fill(l));return(0,n.useEffect)(()=>{if(a){let{stop:e,push:a}=function(e,t){let a=function(e,t,a){let s=Array(e),n=8/e,r=e=>(1/(.2*Math.sqrt(2*Math.PI)))**Math.E**(-.5*((e-0)/.2)**2),o=-n*Math.floor(e/2);for(let t=0;t<e;t++){let e=r(o);s[t]=e,o+=n}return s}(e,0,0),s=[],n=!1,r=()=>{if(!n){if(0===s.length)t(a.map(e=>e*(5+2*Math.random())));else{let e=s.pop();null!=e&&t(a.map((t,a)=>5+10*e[a]*t))}setTimeout(r,125)}},o=0;return r(),{push:e=>{s.length<5?s.push(e):s[5%o]=e,o++},stop:()=>{n=!0}}}(t,u),s=Array(t),n=(0,r.s)(i.vx.OneWayVoice,e=>{let n=Math.floor(e.length/t);for(let a=0;a<t;a++){let t=0;for(let s=n*a,r=s;r<s+n;r++)t+=Math.min(1,5*Math.abs(e[r]));s[a]=t/n}a(s)});return()=>{n(),e()}}},[a,t]),(0,s.jsx)("div",{className:"flex flex-row gap-px items-center h-3",children:c.map((e,t)=>(0,s.jsx)("div",{style:{height:"".concat(e,"px")},className:(0,o.cn)("bg-voice-blue rounded-md w-[2px] h-2 transition-[height]",d)},t))})}a(41591)},7552:function(e,t,a){a.d(t,{Tu:function(){return g},sw:function(){return d},ue:function(){return m},yo:function(){return l}});var s=a(52322),n=a(99248),r=a(10929),o=a(2784),i=a(61676);let l=n.fC;n.xz;let d=n.x8,c=n.h_,u=o.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-scrim data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});u.displayName=n.aV.displayName;let h=(0,r.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l border-l-accent data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right max-w-xs"}},defaultVariants:{side:"right"}}),m=o.forwardRef((e,t)=>{let{side:a="right",className:r,children:o,...l}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsx)(n.VY,{ref:t,className:(0,i.cn)(h({side:a}),r),...l,children:o})]})});function g(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})}m.displayName=n.VY.displayName,g.displayName="SheetHeader",o.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold text-foreground",a),...r})}).displayName=n.Dx.displayName,o.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...r})}).displayName=n.dk.displayName},77388:function(e,t,a){a.d(t,{V:function(){return d},w:function(){return l}});var s=a(52322),n=a(2784),r=a(50567),o=a(21805);let i=(0,n.createContext)({enabled:!1,increaseSwipeFeedbackProbability:()=>!1,showSwipeFeedback:!1}),l=e=>{let{children:t}=e,a=(0,r.EY)(r.F5.SwipeAnnotationFeedback).config,l=(0,n.useRef)(0),[d,c]=(0,n.useState)(!1),u=(0,n.useCallback)(e=>{if(e>=a.signalThreshold)return 1;let t=e/a.signalThreshold;return Math.min(1,Math.max(0,(a.exponentialBase**t-1)/(a.exponentialBase-1)))},[a.exponentialBase,a.signalThreshold]),h=(0,n.useCallback)(()=>!o.Z.get(a.cookieName)&&Math.random()<=u(l.current)&&(o.Z.set(a.cookieName,"true",{expires:a.cookieTTLDays}),l.current=0,!0),[l,a.cookieName,a.cookieTTLDays,u]),m=(0,n.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;if(!a.enabled)return!1;l.current=Math.min(Math.min(a.signalThreshold,l.current+e));let t=h();return c(t),t},[a.signalThreshold,h,a.enabled]),g=(0,n.useMemo)(()=>({enabled:a.enabled,currentSwipeFeedbackProbability:l,increaseSwipeFeedbackProbability:m,showSwipeFeedback:d}),[l,d,m,a.enabled]);return(0,s.jsx)(i.Provider,{value:g,children:t})},d=()=>(0,n.useContext)(i)},96370:function(e,t,a){a.d(t,{X4:function(){return b},qt:function(){return x}});var s=a(52322),n=a(21236),r=a(48364),o=a(67378),i=a(83862),l=a(92488),d=a(47016),c=a(57960),u=a(55264),h=a(84938),m=a(2784),g=a(15584);let p={getCandidatePlaybackStatus:()=>c.PO.NotPlaying,playVoiceMemo:u.ws,stopVoiceMemo:u.ws},f=(0,m.createContext)(p),b=e=>{let{children:t}=e,a=(0,g.BF)(l.Mc),u=(0,g.BF)(l.AK),{isCharacterSpeaking:p}=(0,o.AW)(),{replayUrl:b,error:x}=(0,h.QR)(null!=a?a:void 0),y=(0,i.tz)(),v=(0,m.useCallback)((e,t)=>{e!==l.AK.value&&(n.iN.mediaPlaybackStatusChanged({type:"voice_memo",referrer:"VoiceMemoContext",playback_status:null!=t?t:e,previous_playback_status:l.AK.value,voice_id:null==a?void 0:a.voiceId}),l.AK.value=e,e===c.PO.NotPlaying&&(l.Mc.value=null))},[null==a?void 0:a.voiceId]);(0,m.useEffect)(()=>{if(b)try{(0,d.Sk)(b,"one-off",{onEnded:()=>{v(c.PO.NotPlaying,"completed")},onPlay:()=>{v(c.PO.Playing,"playing")}})}catch(e){v(c.PO.NotPlaying,"error"),(0,r.H)("Failed to play voice memo",{error:e,type:r.NI.Voice,extra:{replayUrl:b}})}},[b,v]),(0,m.useEffect)(()=>{x&&((0,r.H)("Failed to fetch voice memo url",{error:x,type:r.NI.Voice}),y(),v(c.PO.NotPlaying,"error"))},[x,y,v]);let w=(0,m.useCallback)(e=>(null==a?void 0:a.candidateId)===e?u:c.PO.NotPlaying,[u,null==a?void 0:a.candidateId]),P=(0,m.useCallback)(async e=>{let{chatId:t,turnId:a,candidateId:s,voiceId:n,voiceQuery:o}=e,i=!n&&!o;if(!t||!a||!s||i){(0,r.H)("Missing required fields to play voice memo",{type:r.NI.Voice,extra:{chatId:t,turnId:a,candidateId:s,voiceId:n}}),y();return}l.Mc.value=e,v(c.PO.Loading)},[y,v]),A=(0,m.useCallback)(()=>{(0,d.ON)("one-off"),v(c.PO.NotPlaying,"stopped")},[v]);(0,m.useEffect)(()=>{p&&A()},[p,A]);let k=(0,m.useMemo)(()=>({getCandidatePlaybackStatus:w,playVoiceMemo:P,stopVoiceMemo:A}),[w,P,A]);return(0,s.jsx)(f.Provider,{value:k,children:t})},x=()=>(0,m.useContext)(f)},73910:function(e,t,a){a.d(t,{Q:function(){return i}});var s=a(30603),n=a(69569),r=a(2784),o=a(10386);let i=e=>{let{i18n:t}=(0,o.$G)(),[a,i]=(0,r.useState)();return((0,r.useEffect)(()=>{(0,s.Kd)(t.language).then(i)},[t]),e)?(0,n.B)(new Date(e),new Date,{addSuffix:!0,locale:a}):null}},23018:function(e,t,a){a.d(t,{N:function(){return n},V:function(){return r}});var s=a(13959);let n=(0,s.y)(),r=(0,s.y)()},6553:function(e,t,a){a.d(t,{k:function(){return r}});var s=a(74272),n=a.n(s);let r=e=>{let t=n()(e);if(!t)throw Error("Failed to parse data url: ".concat(e));return new Blob([t.toBuffer()],{type:t.contentType})}},36529:function(e,t,a){a.d(t,{Gn:function(){return h},f7:function(){return p},im:function(){return m},uB:function(){return g}});var s=a(52322),n=a(95856),r=a(81181),o=a(92197),i=a(34581),l=a(61676),d=a(55264),c=a(38978),u=a(10386);function h(e){let{characterId:t,characterPagePath:a,className:i}=e,{i18n:d}=(0,u.$G)(),{character:h}=(0,c.XS)(t,d.language),g=!!a;return h?(0,s.jsxs)("div",{className:(0,l.cn)("flex gap-3",i),children:[g?(0,s.jsx)(n.lc,{name:h.name,size:40,src:h.avatar_file_name,href:a,referrer:"ChatCharacterInfo",characterId:t}):(0,s.jsx)(n.Ps,{name:h.name,size:40,src:h.avatar_file_name}),(0,s.jsxs)("div",{children:[g?(0,s.jsx)(r.U,{name:h.name,referrer:"ChatCharacterInfo",characterId:t,href:a,className:"font-semi-bold line-clamp-1 text-ellipsis break-anywhere overflow-hidden whitespace-normal"}):(0,s.jsx)(r.E,{name:h.name,className:"font-semi-bold line-clamp-1 text-ellipsis break-anywhere overflow-hidden whitespace-normal"}),(0,s.jsx)(o.f,{author:h.user__username})]})]}):(0,s.jsx)(m,{className:i})}function m(e){let{className:t}=e;return(0,s.jsxs)("div",{className:(0,l.cn)("flex gap-3",t),children:[(0,s.jsx)(i.O,{className:"h-12 w-12 rounded-sm"}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(i.O,{className:"w-20 h-5"}),(0,s.jsx)(i.O,{className:"w-32 h-4"})]})]})}function g(e){var t,a,i;let{characterId:l}=e,{t:h,i18n:m}=(0,u.$G)(),{character:g}=(0,c.XS)(l,m.language),p=d.nN.characterProfile(null!==(t=null==g?void 0:g.short_hash)&&void 0!==t?t:l),f=!!(null==g?void 0:g.short_hash);if(!g)return null;let b=d.Wj.formatNumber(null!==(a=null==g?void 0:g.participant__num_interactions)&&void 0!==a?a:0);return(0,s.jsxs)("div",{className:"flex gap-3",children:[f?(0,s.jsx)(n.lc,{name:g.name,size:68,src:g.avatar_file_name,href:p,referrer:"ChatCharacterInfoDetailed",characterId:l}):(0,s.jsx)(n.Ps,{name:g.name,size:68,src:g.avatar_file_name}),(0,s.jsxs)("div",{className:"flex-col flex gap-1",children:[f?(0,s.jsx)(r.U,{className:"font-semi-bold",name:g.name,href:p,referrer:"ChatCharacterInfoDetailed",characterId:l}):(0,s.jsx)(r.E,{className:"font-semi-bold",name:g.name}),(0,s.jsx)(o.f,{author:g.user__username}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground flex gap-1",title:h("Common.character-interactions"),children:h("Common.num-interactions",{num:b,count:null!==(i=null==g?void 0:g.participant__num_interactions)&&void 0!==i?i:0})})]})]})}function p(e){let{className:t}=e;return(0,s.jsxs)("div",{className:(0,l.cn)("flex gap-3",t),children:[(0,s.jsx)(i.O,{className:"h-16 w-16 rounded-sm"}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(i.O,{className:"w-24 h-5"}),(0,s.jsx)(i.O,{className:"w-32 h-3"}),(0,s.jsx)(i.O,{className:"w-16 h-3"})]})]})}},68582:function(e,t,a){a.d(t,{U:function(){return _},G:function(){return C}});var s=a(52322),n=a(21236),r=a(35740),o=a(67378),i=a(14755),l=a(45444),d={src:"/_next/static/media/guessword.9fb3adde.png",height:300,width:300,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAw0lEQVR42gXA2qqCsH304Tyel/PWW4FRUVRTc26m3RiNrRuzpdPudkUoiv4jQHNpogj5MSEphho3I2xI/EcJCDQiW9ZXlrPmhdXGlvyQmv/cAyPtFcJdLWHv9+n5upWlCKUJlQtEBItz6YnFb4P+VAcun4yU5a8QyLPKPoOW6LT8mRnMS8Lpn4c0DoBWxseBj4vtUtalTF9hRTpYE5Alxp0gGk54fpw9jnQ5vaNaL8YgX5cuaTnU9cWmPU5sXyGmsB3hLzUmiT5Mob2sAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},c={src:"/_next/static/media/guesswordoops.ea76240d.png",height:300,width:300,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAxElEQVR42g3BPW7CMBQA4Dh+z3YSqIClSxkYqh6hS4/Qpb1o1WMws8AAEiB+FBIwxDay49jwfeTv94ePCjHIYmOTJw7Wer89A2Ew+f58Gb9SAUmMwXfmJJf/U6DDAl0wWc5GOVKqGsMPkg8zID50u8tZ7JOCZ7mQpXyrZNRtGoHG8nZVzvX7iqJGtKsy6QKkiEqqwXQxm69LY7+Q2fra9hDCTR8ZE738/WM8IZHUza6qqCeA2rXOG+uKe4sASuk0hG5TPwDhmGWD9Q4w4AAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},u=a(2784),h=a(66098);let m=[{blockedPatterns:["statue","clay","marble","chisel","carve","sculpter","art"],goalPatterns:["sculpture"],blockedPatternsHidden:["statues","clays","marbles","chisels","carves","sculpters","arts","marbled","chiseled","carved"],goalPatternsHidden:["sculptures"]},{blockedPatterns:["dog","bark","pet","paws","tail"],goalPatterns:["puppy"],blockedPatternsHidden:["paw","pets","tails","dogs","petting"],goalPatternsHidden:["puppies"]},{blockedPatterns:["meal","breakfast","morning","grains","milk"],goalPatterns:["cereal"],blockedPatternsHidden:["grain","meals","breakfasts","mornings","milks","milking"],goalPatternsHidden:["cereals"]},{blockedPatterns:["study","book","campus","education","learning","student"],goalPatterns:["university"],blockedPatternsHidden:["studies","books","booked","campus","campuses","educating","educated","learnings","learned","students"],goalPatternsHidden:["universities"]},{blockedPatterns:["green","courgette","cucumber","garden","vegetable","squash","veg"],goalPatterns:["zucchini"],blockedPatternsHidden:["courgettes","cucumbers","gardening","gardens","vegetables","squashes","veg"],goalPatternsHidden:["zucchinis"]},{blockedPatterns:["book","pages","read","writer","cover","fiction","chapters","literature","author","story"],goalPatterns:["novel"],blockedPatternsHidden:["books","page","reading","reads","writer","writers","writing","covers","fiction","chapter","literature","authors","stories"],goalPatternsHidden:["novella","novels"]},{blockedPatterns:["city","elevated","floor","tower","rooms","elevator","high-rise","tall"],goalPatterns:["skyscraper"],blockedPatternsHidden:["cities","elevated","floors","towers","room","elevators"],goalPatternsHidden:["skyscrapers"]},{blockedPatterns:["music","instrument","strings","sound","tune","melody","rhythm","listen"],goalPatterns:["guitar"],blockedPatternsHidden:["instruments","string","sounds","tunes","melodies","rhythms","listening"],goalPatternsHidden:["guitars"]},{blockedPatterns:["space","star","light","telescope","universe","milky way","cluster","astroid","planets","spaceship"],goalPatterns:["galaxy"],blockedPatternsHidden:["stars","lights","telescopes","universes","clusters","astroids","planet","spaceships"],goalPatternsHidden:["galaxies"]},{blockedPatterns:["bug","insect","antenna","wings","creature","catepillar","chrysalis","monarch","metamorphosis"],goalPatterns:["butterfly"],blockedPatternsHidden:["bugs","insects","antennas","wing","creature","catepillars","monarchs"],goalPatternsHidden:["butterflies"]},{blockedPatterns:["wave","ride","board","ocean","water","sea","island","riptide","surge"],goalPatterns:["surf"],blockedPatternsHidden:["waves","rides","boards","oceans","islands","riptides","surges"],goalPatternsHidden:["surfing","surfs"]},{blockedPatterns:["fire","flame","wick","light","melt","wax","birthday"],goalPatterns:["candle"],blockedPatternsHidden:["fires","flames","wicks","lights","melts","waxing","birthdays"],goalPatternsHidden:["candles"]},{blockedPatterns:["star","night","light","moon","sky","astronomy ","telescope","constellation","gaze"],goalPatterns:["stargazing"],blockedPatternsHidden:["stargazer","stargazers"],goalPatternsHidden:["stars","nights","lights","moons","skys","telescopes","constellations","gazing"]},{blockedPatterns:["rain","wet","cover","sky","shade","handle","clouds","parasol","rainboots","raincoat","puddle"],goalPatterns:["umbrella"],blockedPatternsHidden:["raining","covering","cloud","parasols","rainboot","raincoats","puddles"],goalPatternsHidden:["umbrellas"]},{blockedPatterns:["knit","cold","top","clothing","wear","winter","sweat","pullover","wool","warm","freezing"],goalPatterns:["sweater"],blockedPatternsHidden:["knitting","sweats","pullovers","wooly","warmer"],goalPatternsHidden:["sweaters"]},{blockedPatterns:["fish","river","swim","hook","catch","reel","bait","rod","boat","pond"],goalPatterns:["fishing"],blockedPatternsHidden:["rivers","swimming","hooked","caught","reeling","baiting","rods","boats","ponds"],goalPatternsHidden:[]},{blockedPatterns:["mail","letter","post","postal","postman","deliver","box","stamp","address","paper","seal"],goalPatterns:["envelope"],blockedPatternsHidden:["mailed","letters","posted","delivered","boxes","stamps","addressed","sealed"],goalPatternsHidden:["envelopes"]},{blockedPatterns:["boat","sail","water","waves","ocean","luxury","marina","rich"],goalPatterns:["yacht"],blockedPatternsHidden:["boats","sailing","waters","wave","oceans","luxurious","marinas","riched"],goalPatternsHidden:["yachts","yachting"]},{blockedPatterns:["plan","office","hours","meet","work","routine","calendar","agenda","time","appointments"],goalPatterns:["schedule"],blockedPatternsHidden:["plans","offices","hour","meeting","working","routines","calendars","agendas","times","appointment"],goalPatternsHidden:["schedules"]},{blockedPatterns:["sing","voice","song","notes","melody","group","church","chorus","harmony"],goalPatterns:["choir"],blockedPatternsHidden:["singing","songs","voices","songs","melodies","groups","harmonies"],goalPatternsHidden:["choirs"]},{blockedPatterns:["blue","sky","cloud","fly","vehicle","jet","wing","pilot","airport","engine"],goalPatterns:["airplane"],blockedPatternsHidden:["clouds","flying","vehicles","jets","wings","pilots","airports","engines","plane","air","planes"],goalPatternsHidden:["airplanes"]},{blockedPatterns:["writer","article","news","report","media","newspaper","interview","press"],goalPatterns:["journalist"],blockedPatternsHidden:["journal","journals","articles","reports","newspapers"," interviews","reporting","write","written"],goalPatternsHidden:["journalists"]},{blockedPatterns:["code","program","developer","software","app","keyboard","screen","laptop","electronic","internet"],goalPatterns:["computer"],blockedPatternsHidden:["codes","coding","programs","developers","softwares","apps","keyboards","screens","laptops","electronics"],goalPatternsHidden:["computers"]},{blockedPatterns:["pain","medication","prescription","pill","doctor","nurse","illness","diagnosis","prognosis","cure","pharmacy","drug"],goalPatterns:["medicine"],blockedPatternsHidden:["painful","medications","medicating","prescriptions","pills","doctors","nurses","illnesses","diagnoses","prognoses","cures","pharmacies","drugs"],goalPatternsHidden:["medical","medicines"]},{blockedPatterns:["head","hear","music","audio","sound","ears","wire","bluetooth","earphones","earbuds","headset"],goalPatterns:["headphones"],blockedPatternsHidden:["heard","sounds","head","heard","musical","sounds","ear","wires","bluetooths","earphone","earbud","headsets"],goalPatternsHidden:["headphone"]},{blockedPatterns:["frame","lens","vision","sight","eyes","spectacles","eyewear","lenses","see"],goalPatterns:["glasses"],blockedPatternsHidden:["specs","frames","sights","seeing","eye"],goalPatternsHidden:["glass"]},{blockedPatterns:["flag","symbol","country","national","emblem","pride","allegiance","loyalty","nation"],goalPatterns:["patriotism"],blockedPatternsHidden:["flags","symbols","countries","emblems","prideful","nations"],goalPatternsHidden:["patriot"]},{blockedPatterns:["magic","broom","spells","sorcery","hat","witch","wand"],goalPatterns:["wizard"],blockedPatternsHidden:["magical","brooms","spell","sorcerer","hats","witches","witchcraft","wand"],goalPatternsHidden:["wizards","wizardry"]},{blockedPatterns:["storm","cloud","thunder","flash","weather","bolt","electric"],goalPatterns:["lightning"],blockedPatternsHidden:["storming","storms","clouds","thundering","flashing","bolts","electrical","electrifying"],goalPatternsHidden:["light","lights"]},{blockedPatterns:["food","meal","vegetable","healthy","cook","dressing","chopped","greens","tomato","lettuce","toppings","protein"],goalPatterns:["salad"],blockedPatternsHidden:["foods","meals","vegetables","cooking","dressed","chop","chopping","green","tomatos","lettuces","topping","proteins"],goalPatternsHidden:["salads"]},{blockedPatterns:["flower","petal","plant","garden","gift","rose","wedding","vase","arrangement","floral"],goalPatterns:["bouquet"],blockedPatternsHidden:["flowers","petals","plants","gardening","gardens","gifts","roses","weddings","vases","arrangements","florals"],goalPatternsHidden:["bouquets"]},{blockedPatterns:["snow","ice","cold","climb","mountain","summit","frozen","frost"],goalPatterns:["glacier"],blockedPatternsHidden:["snowing","snowed","icy","freeze","freezing","climbing","mountains","summits","frostbite"],goalPatternsHidden:["glaciers"]},{blockedPatterns:["art","color","brush","paint","canvas","picture","pigment","water","paper"],goalPatterns:["watercolor"],blockedPatternsHidden:["artistic","coloring","colors","brushes","brushes","brushing","paint","painting","paints","canvas","pictures","pigment","papers"],goalPatternsHidden:["watercolors"]},{blockedPatterns:["kitchen","heat","food","bake","cook","meal","radiation","oven"],goalPatterns:["microwave"],blockedPatternsHidden:["heating","baking","baked","cooking","cooked","meals","ovens"],goalPatternsHidden:["microwaves","microwaving"]},{blockedPatterns:["rain","storm","wind","tropical","disaster","ocean","gust"],goalPatterns:["hurricane"],blockedPatternsHidden:["raining","storming","tropics","disasters","oceans","eyes","windy","gusts"],goalPatternsHidden:["hurricanes"]},{blockedPatterns:["book","list","check","task","note","write","diary","personal","notebook","entries"],goalPatterns:["journal"],blockedPatternsHidden:["books","lists","checks","tasks","notes","written","writing","diaries","personalized","notebooks","entry"],goalPatternsHidden:["journals"]},{blockedPatterns:["desert","sand","dry","camel","heat","water","mirage","plant","palm"],goalPatterns:["oasis"],blockedPatternsHidden:["deserts","sandy","dried","camels","hot","watering","mirages","plants","palms"],goalPatternsHidden:["oases"]},{blockedPatterns:["earth","science","volcano","rock","layers","study","fossils","soil"],goalPatterns:["geology"],blockedPatternsHidden:["scientific","volcanoes","rocks","layer","studied","studies","fossil","soils"],goalPatternsHidden:["geologies"]},{blockedPatterns:["money","wealth","coin","gold","exchange","economy"],goalPatterns:["currency"],blockedPatternsHidden:["money(s?)","wealth(y|ier|iest|s?)","coin(s?)","gold(en|s?)","exchang(e|ing|es|ed)","econom(y|ies|ic|ical)"],goalPatternsHidden:["currenc(y|ies)"]},{blockedPatterns:["math","solve","numbers","calculator","hard","operation"],goalPatterns:["algorithm"],blockedPatternsHidden:["math(s?)","solv(es|ed|ing)?","number(s?)","calculator(s?)","hard(er|est|ness)?","operation(s?)"],goalPatternsHidden:["algor(ithm|ithms|ithmic)"]},{blockedPatterns:["star","light","explode","universe","space","death"],goalPatterns:["supernova"],blockedPatternsHidden:["star(s?)","light(s|ed|ing)?","explod(es|ed|ing)?","universe(s?)","space(s?)","death(s?)"],goalPatternsHidden:["supernova(s?)"]},{blockedPatterns:["water","natural","stream","river","falls","landscape"],goalPatterns:["waterfall"],blockedPatternsHidden:["water(s?)","natural(ly|ness)?","stream(s|ed|ing)?","river(s?)","fall(s|ing|en)?","landscape(s?)"],goalPatternsHidden:["waterfall(s?)"]},{blockedPatterns:["puzzle","pieces","fit","complete","solve","game"],goalPatterns:["jigsaw"],blockedPatternsHidden:["puzzle(s?)","piece(s?)","fit(s|ted|ting)?","complete(s|d|ing)?","solve(s|d|ing)?","game(s?)"],goalPatternsHidden:["jigsaw(s?)"]},{blockedPatterns:["house","wood","build","roof","wall","frame"],goalPatterns:["blueprint"],blockedPatternsHidden:["house(s?)","wood(s|en)?","build(s|er|ing|ers|ed)?","roof(s|ing|ed)?","wall(s|ed|ing)?","frame(s|d|ing)?"],goalPatternsHidden:["blueprint(s?)"]},{blockedPatterns:["ocean","large","waves","vessel","navigate","travel"],goalPatterns:["shipwreck"],blockedPatternsHidden:["ocean(s?)","large(r|st)?","wave(s|d|ing)?","vessel(s?)","navigat(e|ed|ing|ion)?","travel(s|ed|ing)?"],goalPatternsHidden:["shipwreck(s?)"]},{blockedPatterns:["gold","mine","stones","jewels","cut","valuable"],goalPatterns:["gemstone"],blockedPatternsHidden:["gold(en)?","mine(d|s)?","stone(s?)","jewel(s?)","gem(s?)","valuable(s|ness)?","cut(s|ting|ted)?"],goalPatternsHidden:["gemstone(s?)"]},{blockedPatterns:["room","sleep","night","bed","relax","rest"],goalPatterns:["pillowcase"],blockedPatternsHidden:["room(s?)","sleep(s|ing|y)?","night(s?)","bed(s?)","relax(es|ed|ing)?","rest(s|ed|ing)?","pillow(s?)"],goalPatternsHidden:["pillowcase(s?)"]},{blockedPatterns:["metal","armor","medieval","fight","knight","helmet"],goalPatterns:["chainmail"],blockedPatternsHidden:["metal(s?)","armor(s?)","medieval","fight(s|ing|ed|er)?","knight(s?)","helmet(s?)"],goalPatternsHidden:["chainmail(s?)"]},{blockedPatterns:["instrument","wind","play","sound","oboe","orchestra"],goalPatterns:["bassoon"],blockedPatternsHidden:["instrument(s?)","wind(s?)","play(s|ed|ing)?","sound(s|ed|ing)?","oboe(s?)","orchestra(s?)"],goalPatternsHidden:["bassoon(s?)"]},{blockedPatterns:["tech","computer","hardware","data","small","chip"],goalPatterns:["microprocessor"],blockedPatternsHidden:["tech(nology|nologies|s)?","computer(s?)","hardware(s?)","data","small(er|est)?","chip(s?)","micro","processor(s?)"],goalPatternsHidden:["microprocessor(s?)"]},{blockedPatterns:["music","beats","instrument","drum","play","rhythm"],goalPatterns:["percussion"],blockedPatternsHidden:["music(s?)","beat(s?)","instrument(s?)","drum(s|ming|med)?","play(s|ed|ing)?","rhythm(s?)","plays"],goalPatternsHidden:["percussion(ist|ists|s)?"]},{blockedPatterns:["ship","water","ice","titanic","crash","sink"],goalPatterns:["iceberg"],blockedPatternsHidden:["ship(s?)","water(s?)","ice(s?)","titanic(s?)","crash(es|ed|ing)?","sink(s|ing|ed)?"],goalPatternsHidden:["iceberg(s?)"]},{blockedPatterns:["planet","ring","solar","orbit","gas","space"],goalPatterns:["Saturn"],blockedPatternsHidden:["rings","planets"],goalPatternsHidden:[]},{blockedPatterns:["planet","ring","solar","gas","space","Cronus"],goalPatterns:["Saturn"],blockedPatternsHidden:["planet(s?)","ring(s?)","solar(s?)","gas(es)?","space(s?)","Cronus","Kronos"],goalPatternsHidden:["Saturn"]},{blockedPatterns:["forest","tall","green","wood","bark"],goalPatterns:["canopy"],blockedPatternsHidden:["forest(s?)","tall(er|est)?","green(er|est|ery)?","wood(s|en)?","bark(s|ing|ed)?","leaf(s|ves)?","shade(s?)"],goalPatternsHidden:["canop(y|ies)?"]},{blockedPatterns:["write","notes","school","study","pages","journal"],goalPatterns:["notebook"],blockedPatternsHidden:["writ(es|ing|ten)?","note(s?)","school(s?)","stud(y|ies|ing|ied)?","page(s?)","journal(s?)","wrote","book(s?)"],goalPatternsHidden:["notebook(s?)"]},{blockedPatterns:["drink","cold","fizzy","sweet","bottle"],goalPatterns:["soda"],blockedPatternsHidden:["drink(s|ing)?","cold(er|est)?","fizz(y|zes)?","sweet(s|en|ened|ener|ening)?","bottle(s?)","drinks"],goalPatternsHidden:["soda(s?)"]},{blockedPatterns:["green","long","vegetable","garden","crunchy"],goalPatterns:["cucumber"],blockedPatternsHidden:["green(er|est)?","long(er|est)?","vegetable(s?)","garden(s|ing|ed|er)?","crunch(y|ier|iest)?"],goalPatternsHidden:["cucumber(s?)"]},{blockedPatterns:["moon","planet","night","sky","orbit"],goalPatterns:["satellite"],blockedPatternsHidden:["moon(s?)","planet(s?)","night(s?)","sky(s?)","orbit(s|ing|ed)?"],goalPatternsHidden:["satellite(s?)"]},{blockedPatterns:["tree","fall","season","orange","leaves","october"],goalPatterns:["autumn"],blockedPatternsHidden:["tree(s?)","fall(s|ing)?","season(s?)","orange(s?)","lea(fs|ves)?","october(s?)"],goalPatternsHidden:["autumn(s?)"]},{blockedPatterns:["ring","finger","love","marriage","ceremony"],goalPatterns:["wedding"],blockedPatternsHidden:["ring(s?)","finger(s?)","love(s|d|r|ing)?","marriage(s?)","ceremon(ys|ies)?","wed(s|ding|ded)?"],goalPatternsHidden:["wedding(s?)"]},{blockedPatterns:["red","heat","fire","danger","signal"],goalPatterns:["alarm"],blockedPatternsHidden:["red(s|ness)?","heat(s|ed|ing)?","fir(es|ing|ed)?","danger(s|ous|ously)?","signal(s|ing|ed)?","alarming"],goalPatternsHidden:["alarm(s?)"]},{blockedPatterns:["fast","race","run","athlete","track"],goalPatterns:["sprint"],blockedPatternsHidden:["fast(er|est)?","race(s|d|r|ing)?","run(s|ning|ner)?","athlet(es|ic)?","track(s?)"],goalPatternsHidden:["sprint(s?)"]},{blockedPatterns:["water","travel","row","boat","oar"],goalPatterns:["canoe"],blockedPatternsHidden:["water(s?)","travel(s|ing|ed|er)?","row(s|ing|ed|er)?","boat(s?)","oar(s?)","kayak(s?)"],goalPatternsHidden:["canoe(s?)"]},{blockedPatterns:["metal","fix","tool","screw","hammer"],goalPatterns:["wrench"],blockedPatternsHidden:["metal(s?)","fix(es|ed|ing)?","tool(s?)","screw(s|ing|ed)?","hammer(s|ing|ed)?"],goalPatternsHidden:["wrench(es?)"]},{blockedPatterns:["light","science","color","split","rainbow"],goalPatterns:["prism"],blockedPatternsHidden:["light(s?)","science(s?)","color(s|ed|ing|ful)?","split(s|ting|ted)?","rainbow(s?)"],goalPatternsHidden:["prism(s?)"]},{blockedPatterns:["music","group","sing","perform","vocal"],goalPatterns:["ensemble"],blockedPatternsHidden:["music(s?)","group(s?)","sing(s|ing|er|ers)?","perform(s|ed|ing|er|ers)?","vocal(s|ist|ists)?"],goalPatternsHidden:["ensemble(s?)"]},{blockedPatterns:["paper","fold","craft","art","Japan"],goalPatterns:["origami"],blockedPatternsHidden:["paper(s?)","fold(s|ed|ing)?","craft(s|ed|ing)?","art(s?)","japan(ese)?"],goalPatternsHidden:["origami"]},{blockedPatterns:["flower","thorn","smell","bloom","garden"],goalPatterns:["lilac"],blockedPatternsHidden:["flower(s?)","thorn(s?)","smell(s|ing|ed)?","bloom(s|ing|ed)?","garden(er|ers|s)?"],goalPatternsHidden:["lilac(s?)"]},{blockedPatterns:["wave","motion","sea","pull","moon"],goalPatterns:["tide"],blockedPatternsHidden:["wave(s?)","motion(s?)","sea(s?)","pull(s|ed|ing)?","moon(s?)","tidal"],goalPatternsHidden:["tide(s?)"]},{blockedPatterns:["draw","pencil","art","sketch","tool"],goalPatterns:["charcoal"],blockedPatternsHidden:["draw(s|ing|n)?","pencil(s?)","art(s|ist|ists)?","sketch(es|ed|ing)?","tool(s?)","char","coal"],goalPatternsHidden:["charcoal"]},{blockedPatterns:["science","atoms","elements","table","study"],goalPatterns:["chemistry"],blockedPatternsHidden:["science(s?)","scientist(s?)","atom(s?)","element(s?)","table(s?)","stud(y|ies|ing|ied)?"],goalPatternsHidden:["chemist(ry|ries)?"]},{blockedPatterns:["history","period","culture","age","ancient"],goalPatterns:["renaissance"],blockedPatternsHidden:["histor(y|ies)?","period(s?)","cultur(es|al)?","age(s?)","ancient(s?)"],goalPatternsHidden:["renaissance(s?)"]},{blockedPatterns:["star","chart","space","night","map"],goalPatterns:["constellation"],blockedPatternsHidden:["star(s?)","chart(s?)","space(s?)","night(s?)","map(s?)"],goalPatternsHidden:["constellation(s?)"]},{blockedPatterns:["gem","shine","precious","blue","cut"],goalPatterns:["sapphire"],blockedPatternsHidden:["gem(s?)","shine(s|d|ing)?","precious(ly|ness)?","blue(s?)","cut(s|ting|ted)?"],goalPatternsHidden:["sapphire(s?)"]},{blockedPatterns:["write","author","ink","calligraphy","letters"],goalPatterns:["manuscript"],blockedPatternsHidden:["writ(es|ing|ten|er|ers)?","author(s?)","ink(s|ed|ing)?","calligraphy(s?)","letter(s?)"],goalPatternsHidden:["manuscript(s?)"]},{blockedPatterns:["tree","forest","type","wood","pine","giant"],goalPatterns:["sequoia"],blockedPatternsHidden:["tree(s?)","forest(s?)","type(s?)","wood(s|en|ed)?","pine(s?)","giant(s?)"],goalPatternsHidden:["sequoia(s?)"]},{blockedPatterns:["law","court","judge","crime","case","twelve"],goalPatterns:["jury"],blockedPatternsHidden:["law(s|yer|yers)?","court(s?)","judg(e|es|ed|ing)?","crim(es|inal)?","case(s?)","twelve","12"],goalPatternsHidden:["jur(ies|y)?"]},{blockedPatterns:["bird","water","white","wings","elegant","black"],goalPatterns:["swan"],blockedPatternsHidden:["bird(s?)","water(s?)","white(s?)","wing(s?)","elegant(ly)?","black(s?)"],goalPatternsHidden:["swan(s?)"]},{blockedPatterns:["weather","ice","storm","freezing","fall"],goalPatterns:["hail"],blockedPatternsHidden:["weather(s?)","ice(s?)","icing","storm(s|ing|ed)?","freez(e|ing|es|ed)?","fall(s|ing|en)?"],goalPatternsHidden:["hail(s?)"]},{blockedPatterns:["book","ancient","script","religious","text","magic"],goalPatterns:["scroll"],blockedPatternsHidden:["book(s?)","ancient(s?)","script(s?)","religious(ly|ness)?","text(s?)","magic(s?)"],goalPatternsHidden:["scroll(s?)"]},{blockedPatterns:["dance","partner","formal","waltz","ballroom"],goalPatterns:["tango"],blockedPatternsHidden:["dance(s|d|ing|r)?","partner(s|ed|ing)?","formal(ly|ity)?","waltz(es|ing|ed)?","ballroom(s?)"],goalPatternsHidden:["tango(s?)"]},{blockedPatterns:["space","dark","light","science","sky"],goalPatterns:["nebula"],blockedPatternsHidden:["space(s?)","dark(er|est|ness)?","light(s?)","science(s?)","sky(s?)","skies"],goalPatternsHidden:["nebula(e|s)?"]},{blockedPatterns:["food","grain","rice","health","dish"],goalPatterns:["quinoa"],blockedPatternsHidden:["food(s?)","grain(s?)","rice(s?)","health(y|ier|iest)?","dish(es?)"],goalPatternsHidden:["quinoa"]},{blockedPatterns:["write","create","fiction","book","story"],goalPatterns:["novelist"],blockedPatternsHidden:["writ(es|er|ing|ten)?","creat(es|ed|ing|or)?","fiction(s?)","book(s?)","story(s|ies)?","stories","writer(s?)","creator(s?)","novel"],goalPatternsHidden:["novelist(s?)"]},{blockedPatterns:["fire","camp","burn","light","smoke","coal"],goalPatterns:["ember"],blockedPatternsHidden:["fire(s?)","camp(s|ing)?","burn(s|ing|ed)?","light(s|ed|ing)?","smoke(s|y)?","coal(s?)"],goalPatternsHidden:["ember(s?)"]},{blockedPatterns:["animal","arctic","sea","gray","blubber","large"],goalPatterns:["walrus"],blockedPatternsHidden:["animal(s?)","arctic(s?)","sea(s?)","gray(s?)","blubber(s?)","large(r|st)?"],goalPatternsHidden:["walrus(es?)"]},{blockedPatterns:["field","color","bright","seed","yellow","van Gogh"],goalPatterns:["sunflower"],blockedPatternsHidden:["field(s?)","color(s|ful|ed)?","bright(er|est|ness)?","seed(s?)","yellow(s?)","van\\s*Gogh","sun","seeds","flower(s?)","gogh"],goalPatternsHidden:["sunflower(s?)"]},{blockedPatterns:["sight","distance","lens","clear","zoom","focus"],goalPatterns:["binoculars"],blockedPatternsHidden:["sight(s?)","distance(s?)","lens(es?)","clear(er|est|ly|ness)?","zoom(s|ed|ing)?","focus(es|ed|ing)?"],goalPatternsHidden:["binocular(s?)"]},{blockedPatterns:["fruit","hard","brown","tropical","milk","oil"],goalPatterns:["coconut"],blockedPatternsHidden:["fruit(s?)","hard(er|est|ness)?","brown(s?)","tropical(s?)","milk(s?)","oil(s?)"],goalPatternsHidden:["coconut(s?)"]},{blockedPatterns:["dessert","freeze","sweet","cold","scoop","ice"],goalPatterns:["gelato"],blockedPatternsHidden:["dessert(s?)","freez(e|ing|es|ed)?","sweet(s|er|est|ness)?","cold(er|est|ness)?","scoop(s|ed|ing)?","ice(s?)"],goalPatternsHidden:["gelato"]},{blockedPatterns:["bird","pink","long","leg","lake"],goalPatterns:["flamingo"],blockedPatternsHidden:["bird(s?)","pink(s?)","long(er|est|ness)?","leg(s?)","lake(s?)"],goalPatternsHidden:["flamingo(s?)"]},{blockedPatterns:["tree","pine","holiday","decorate","ornament"],goalPatterns:["evergreen"],blockedPatternsHidden:["tree(s?)","pine(s?)","holiday(s?)","decorate(s|d|ing)?","ornament(s?)"],goalPatternsHidden:["evergreen(s?)"]},{blockedPatterns:["ocean","navigate","submarine","deep","explore"],goalPatterns:["sonar"],blockedPatternsHidden:["ocean(s?)","navigat(es|ed|ing)?","submarine(s?)","deep(er|est|ness)?","explor(es|ed|ing)?"],goalPatternsHidden:["sonar"]},{blockedPatterns:["write","ink","calligraphy","pen","dip"],goalPatterns:["quill"],blockedPatternsHidden:["writ(es|er|ing|ten)?","ink(s|ed|ing)?","calligraphy(s?)","pen(s?)","dip(s|ped|ping)?"],goalPatternsHidden:["quill(s?)"]},{blockedPatterns:["snow","fall","white","cold","danger"],goalPatterns:["avalanche"],blockedPatternsHidden:["snow(s?)","fall(s|ing|en)?","white(s?)","cold(er|est)?","danger(s|ous|ously)?"],goalPatternsHidden:["avalanche(s?)"]},{blockedPatterns:["water","tropical","island","blue","shallow"],goalPatterns:["lagoon"],blockedPatternsHidden:["water(s?)","tropical(s?)","island(s?)","blue(s?)","shallow(s?)"],goalPatternsHidden:["lagoon(s?)"]},{blockedPatterns:["pastry","butter","bake","French","flaky"],goalPatterns:["croissant"],blockedPatternsHidden:["pastr(y|ies)","butter(y)?","bake(r|s|d|ing)?","french","flak(ier|iest)?"],goalPatternsHidden:["croissant(s?)"]},{blockedPatterns:["dessert","coffee","layer","Italy","sweet"],goalPatterns:["tiramisu"],blockedPatternsHidden:["dessert(s?)","coffee(s?)","layer(s?)","italy","italian","sweet(er|est)?"],goalPatternsHidden:["tiramisu"]},{blockedPatterns:["avocado","dip","green","chips","Mexican"],goalPatterns:["guacamole"],blockedPatternsHidden:["avocado(s?)","dip(s?)","green(er|est)?","chip(s?)","mexico","mexican(s?)"],goalPatternsHidden:["guacamole"]},{blockedPatterns:["fish","rice","roll","Japanese","raw"],goalPatterns:["sushi"],blockedPatternsHidden:["fish(es?)","rice(s?)","roll(s?)","japanese","japan","raw(er|est)?"],goalPatternsHidden:["sushi"]},{blockedPatterns:["horse","horn","magic","myth","white"],goalPatterns:["unicorn"],blockedPatternsHidden:["horse(s?)","horn(s?)","magic(s?)","myth(s?)","white(s?)"],goalPatternsHidden:["unicorn(s?)"]},{blockedPatterns:["green","small","trick","creature","gold"],goalPatterns:["goblin"],blockedPatternsHidden:["green(er|est)?","small(er|est)?","trick(s?)","creature(s?)","gold(en|s?)"],goalPatternsHidden:["goblin(s?)"]},{blockedPatterns:["navigate","needle","north","tool","direction"],goalPatterns:["compass"],blockedPatternsHidden:["navigat(es|ed|ing)?","needle(s?)","north(er|ern)?","tool(s?)","direction(s?)"],goalPatternsHidden:["compass(es?)"]},{blockedPatterns:["photo","camera","phone","picture","face"],goalPatterns:["selfie"],blockedPatternsHidden:["photo(s?)","camera(s?)","phone(s?)","picture(s?)","face(s?)"],goalPatternsHidden:["selfie(s?)"]},{blockedPatterns:["smile","text","icon","happy","message"],goalPatterns:["emoji"],blockedPatternsHidden:["smile(s?)","text(s?)","icon(s?)","happ(y|ier|iest)?","message(s?)"],goalPatternsHidden:["emoji(s?)"]},{blockedPatterns:["funny","internet","picture","joke","viral"],goalPatterns:["meme"],blockedPatternsHidden:["funn(y|ier|iest)?","internet(s?)","picture(s?)","joke(s?)","viral(s?)"],goalPatternsHidden:["meme(s?)"]},{blockedPatterns:["wheels","trick","ramp","skate","ride"],goalPatterns:["skateboard"],blockedPatternsHidden:["wheel(s?)","trick(s?)","ramp(s?)","skate(s|d|ing)?","ride(s|r|ing)?"],goalPatternsHidden:["skateboard(s?)"]},{blockedPatterns:["wave","ocean","ride","beach","water"],goalPatterns:["surfboard"],blockedPatternsHidden:["wave(s?)","ocean(s?)","ride(s|r|ing)?","beach(es?)","water(s?)"],goalPatternsHidden:["surfboard(s?)"]},{blockedPatterns:["forest","rain","wild","animals","trees"],goalPatterns:["jungle"],blockedPatternsHidden:["forest(s?)","rain(s?)","wild(er|ness)?","animal(s?)","tree(s?)"],goalPatternsHidden:["jungle(s?)"]},{blockedPatterns:["fast","spots","cat","sprint","Africa"],goalPatterns:["cheetah"],blockedPatternsHidden:["fast(er|est)?","spot(s?)","cat(s?)","sprint(s|ing|ed)?","africa(n)?"],goalPatternsHidden:["cheetah(s?)"]},{blockedPatterns:["bear","China","black","white","bamboo"],goalPatterns:["panda"],blockedPatternsHidden:["bear(s?)","chin(a|ese)?","black(s?)","white(s?)","bamboo(s?)"],goalPatternsHidden:["panda(s?)"]},{blockedPatterns:["breakfast","batter","fluffy","maple","stack"],goalPatterns:["pancake"],blockedPatternsHidden:["breakfast(s?)","batter(s?)","fluff(y|ier|iest)?","maple(s?)","stack(s?)"],goalPatternsHidden:["pancake(s?)"]},{blockedPatterns:["fire","wings","myth","scale","castle"],goalPatterns:["dragon"],blockedPatternsHidden:["fire(s?)","wing(s?)","myth(s?)","scale(s?)","castle(s?)"],goalPatternsHidden:["dragon(s?)"]},{blockedPatterns:["audio","show","talk","microphone","episode"],goalPatterns:["podcast"],blockedPatternsHidden:["audio(s?)","show(s?)","talk(s|ed|ing)?","microphone(s?)","episode(s?)"],goalPatternsHidden:["podcast(s?)"]},{blockedPatterns:["disc","ultimate","throw","catch","plastic"],goalPatterns:["frisbee"],blockedPatternsHidden:["disc(s?)","throw(s|ing|ed)?","catch(es|ing)?","plastic(s?)"],goalPatternsHidden:["frisbee(s?)"]},{blockedPatterns:["thanks","appreciation","feel","happy","gesture"],goalPatterns:["gratitude"],blockedPatternsHidden:["thank(s|ful|fully)?","appreciation(s?)","feel(s|ing)?","happy(ier|iest|ness)?","gesture(s?)"],goalPatternsHidden:["gratitude"]},{blockedPatterns:["gold","sparkle","precious","jewelry","gem","stone"],goalPatterns:["opal"],blockedPatternsHidden:["jewel","gemstone","stones"],goalPatternsHidden:[]},{blockedPatterns:["tree","leaves","forest","autumn","orange","syrup"],goalPatterns:["maple"],blockedPatternsHidden:["leaf","trees"],goalPatternsHidden:[]},{blockedPatterns:["paper","ink","write","mail","envelope"],goalPatterns:["stationery"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["sun","moon","space","sky","hide","dark"],goalPatterns:["eclipse"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["spice","seed","yellow","flavor","saffron"],goalPatterns:["turmeric"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["paint","wall","color","home","decor"],goalPatterns:["mural"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["study","question","answer","test","school"],goalPatterns:["quiz"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["fire","burn","wood","camp","heat"],goalPatterns:["ember"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["desert","heat","dry","storm","dune"],goalPatterns:["mirage"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["electric","wire","current","plug","socket"],goalPatterns:["voltage"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["food","grain","meal","breakfast","porridge"],goalPatterns:["oatmeal"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["storm","light","rain","cloud","sky"],goalPatterns:["cyclone"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["ship","sea","travel","wood","sail"],goalPatterns:["frigate"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["glass","vision","clear","light","curve"],goalPatterns:["lens"],blockedPatternsHidden:["lenses"],goalPatternsHidden:[]},{blockedPatterns:["metal","ring","decorate","wear","finger"],goalPatterns:["band"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["fruit","berry","small","red","sweet"],goalPatterns:["cranberry"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["tool","construction","hit","nail","metal"],goalPatterns:["hammer"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["night","light","fire","camp","glow"],goalPatterns:["lantern"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["music","perform","instrument","group","band"],goalPatterns:["orchestra"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["heat","glass","science","focus","sun"],goalPatterns:["magnifying"],blockedPatternsHidden:[],goalPatternsHidden:["magnifier"]},{blockedPatterns:["bird","feather","flight","large","prey"],goalPatterns:["falcon"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["book","pages","write","notes","diary"],goalPatterns:["ledger"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["sea","creature","tentacle","ink","ocean"],goalPatterns:["octopus"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["castle","stone","royal","tower","historic"],goalPatterns:["fortress"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["book","page","story","read","author"],goalPatterns:["anthology"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["flower","plant","spring","blossom","red"],goalPatterns:["tulip"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["animal","fur","growl","claws","forest"],goalPatterns:["panther"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["sound","wave","vibrate","ear","music"],goalPatterns:["frequency"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["kitchen","metal","mix","batter","tool"],goalPatterns:["whisk"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["tall","rock","climb","mountain","peak"],goalPatterns:["plateau"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["sweet","dark","dessert","bar","candy"],goalPatterns:["cocoa"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["write","author","famous","book","classic"],goalPatterns:["biography"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["fabric","pattern","sew","quilt","cover"],goalPatterns:["tapestry"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["science","study","living","organism","biology"],goalPatterns:["ecology"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["sport","field","goal","kick","team"],goalPatterns:["soccer"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["heat","sun","energy","power","light"],goalPatterns:["solar"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["fish","stream","swim","animal","river"],goalPatterns:["trout"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["bird","flight","long","neck","water"],goalPatterns:["heron"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["art","museum","ancient","stone","statue"],goalPatterns:["sculpture"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["green","spice","food","herb","flavor"],goalPatterns:["thyme"],blockedPatternsHidden:[],goalPatternsHidden:[]},{blockedPatterns:["music","perform","stage","audience","drama"],goalPatterns:["orchestra"],blockedPatternsHidden:[],goalPatternsHidden:[]}];var g=a(10386);let p=(e,t,a,s,n)=>{let{t:r}=(0,g.$G)(),o=r("Games.oops-description"),p=r("Games.stop-description"),f=r("Games.speakeasy-start-rules"),[b,x]=(0,u.useState)(0),y=(0,u.useRef)(b),[v,w]=(0,u.useState)(1e3),[P,A]=(0,u.useState)(0),[k,j]=(0,u.useState)(d),[N,_]=(0,u.useState)(),[C,H]=(0,u.useState)(0),[S,I]=(0,u.useState)(!1),[q,D]=(0,u.useState)(!1),[E,W]=(0,u.useState)(""),[G,M]=(0,u.useState)(-1),[z,T]=(0,u.useState)(0),[O,B]=(0,u.useState)(),R=e=>e.sort(()=>Math.random()-.5),[F,L]=(0,u.useState)(()=>R(m)),[U,Q]=(0,u.useState)([]),K=(0,u.useRef)(U),[V,$]=(0,u.useState)(-1),Y=(0,u.useRef)(V),[J,Z]=(0,u.useState)([]);(0,u.useEffect)(()=>{y.current=b},[b]),(0,u.useEffect)(()=>{let e,t;return w(1e3),W(r("Games.score-per-last-card",{score:1e3+P})),S&&!q&&(t=setTimeout(()=>{D(!0)},3e3)),S&&q&&(e=setInterval(()=>{w(e=>{let t=Math.max(100,e+-50);return W(r("Games.score-per-last-card",{score:t+P})),t})},5e3)),()=>{clearInterval(e),clearTimeout(t)}},[S,q,-50,P,r]),(0,u.useEffect)(()=>{G+6>=R.length&&(L(R(m)),M(0))},[G]);let X=()=>{Q(F.slice(G,G+6)),M(G+6+1)},ee=(0,u.useCallback)(e=>{$(-1),I(!1),H(C+1),e&&(j(c),_(p),x(0))},[C,p]),et=function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];for(let[,t]of a.flat().map(e=>RegExp("(\\b".concat(e,"\\b)"),"i")).entries()){let a=e.match(t);if(a)return a[0]}return!1},ea=(0,u.useCallback)(()=>{y.current>0?_(r("Games.win-description",{score:y.current})):_(o),ee(!1),e(!1,y.current,!0)},[o,ee,r,e]);(0,u.useEffect)(()=>{n===h.D2.PLAYING&&(Y.current=V,K.current=U,V>=0&&V<6?t({markdownText:r("Games.speakeasy-rules",{characterName:(null==O?void 0:O.participant__name)||r("Games.other-player"),goal:U[V].goalPatterns.join(", "),blocked:U[V].blockedPatterns.join(", ")})}):6===V&&ea())},[V,O,t,F,U,ea,e,b,n,r]);let es=e=>{x(e=>Math.max(100,e+v+P)),en(V,h.JU.WON),s(r("Games.guess-word-card-correct",{characterName:null==O?void 0:O.participant__name,word:U[V].goalPatterns[0],cardScore:v,streakBonus:P})),V<6&&(e&&(V+1<6?a("Correct! The answer was ".concat(U[V].goalPatterns[0],".\n\n          I'll start giving clues for the next card now\n          ")):a("Correct! The answer was ".concat(U[V].goalPatterns[0],".\n      \n            That's the end of the game.\n            "))),en(V+1,h.JU.PLAYING),$(V+1),A(e=>e+100))},en=(e,t)=>{Z(a=>{let s=[...a];return s[e]=t,s})},er=(e,t)=>{en(V,h.JU.LOST),s(r("Games.you-said-forbidden-word-zero-points",{forbiddenWord:t})),A(0),V+1===6?e&&a("Oops we lost that one! It was my fault. I wasn't supposed to use any of these forbidden words: \n          **".concat(U[V].blockedPatterns.join(", "),"**\n        \n          The answer was **").concat(U[V].goalPatterns[0],"**\n          \n          That's the end of the game.\n        ")):(e&&a("Oops we lost that one! It was my fault. I wasn't supposed to use any of these forbidden words: \n          **".concat(U[V].blockedPatterns.join(", "),"**\n        \n          The answer was **").concat(U[V].goalPatterns[0],"**\n            \n          I'll start giving clues for the next card now\n        ")),en(V+1,h.JU.PLAYING)),$(V+1)},eo=(0,u.useCallback)(e=>{let t=K.current[Y.current];en(Y.current,h.JU.PASSED),s(r("Games.you-passed-card",{word:t.goalPatterns[0]})),A(0),Y.current+1===6?e&&a("I couldn't get you to guess the answer, **".concat(t.goalPatterns[0],"**,\n            so we're passing the card.\n                    \n            That's the end of the game.\n          ")):(e&&a("I couldn't get you to guess the answer, **".concat(t.goalPatterns[0],"**, \n            so we're passing to the next card.\n                      \n                  I'll start giving clues for the next card now\n          ")),en(Y.current+1,h.JU.PLAYING)),$(Y.current+1)},[6,r,s,a]);return(0,u.useEffect)(()=>{let e=()=>{eo(!0),D(!1)};return l.o.listen(e),()=>{l.o.unlisten(e)}},[eo]),{gameKey:h.Ox.GUESS_WORD,title:"Speakeasy",description:N,numRounds:C,logo:d,gameImage:k,gameRules:f,score:b,characterScore:void 0,scoreInfo:E,scoreCommentary:"",scoreRecipient:"",itemResults:J,stopGame:ee,newGame:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];T(0),x(0),j(d),_(void 0),X(),Z(Array(6).fill(h.JU.UNSEEN)),e&&a("Let's play a word game! For this round, I'll draw ".concat(6," cards. We'll do one at a time, each one will give me a word to get you to guess, and some words I can't say.\n        \n        When we get one right or I use a blocked word, we'll move on to the next card. The round will be over after all cards are done.")),I(!0),D(!1),$(0),en(0,h.JU.PLAYING),H(C+1)},handleUpdateMessages:e=>{var t,a,s,n,r,o,l;if(T(z+1),z>0&&e.length>1&&!(null===(a=e[0])||void 0===a?void 0:null===(t=a.author)||void 0===t?void 0:t.is_human)&&(null===(n=e[1])||void 0===n?void 0:null===(s=n.author)||void 0===s?void 0:s.is_human)&&!(null===(r=e[1].candidates[0].raw_content)||void 0===r?void 0:r.startsWith(i.U))){let t=(null===(o=e[1].candidates[0].raw_content)||void 0===o?void 0:o.toLowerCase())||"",a=(null===(l=e[0].candidates[0].raw_content)||void 0===l?void 0:l.toLowerCase())||"",s=et(t,U[V].blockedPatterns,U[V].blockedPatternsHidden,U[V].goalPatterns,U[V].goalPatternsHidden);s?(er(!0,s),D(!1)):et(a,U[V].goalPatterns,U[V].goalPatternsHidden)&&(es(!0),D(!1))}},init:e=>{B(e),j(d),T(0),_(void 0),x(0),W(r("Games.score-per-last-card",{score:v+P})),w(1e3)}}},f=[{question:"What's your go to comfort food?",questionDisplay:"What's {{characterName}}'s go to comfort food?"},{question:"Where would you go on vacation if money was no object?",questionDisplay:"Where would {{characterName}} go on vacation if money was no object?"},{question:"What's your most annoying habit?",questionDisplay:"What's {{characterName}}'s most annoying habit?"},{question:"What's the first thing you do when you wake up?",questionDisplay:"What's the first thing {{characterName}} does when they wakes up?"},{question:"What's your dream job?",questionDisplay:"What's {{characterName}}'s dream job?"},{question:"What's the one household chore you absolutely hate?",questionDisplay:"What's the one household chore {{characterName}} absolutely hates?"},{question:"What one item would you take if you were to be stranded on a deserted island?",questionDisplay:"What one item would {{characterName}} take if they were to be stranded on a deserted island?"},{question:"What's your biggest fear?",questionDisplay:"What's {{characterName}}'s biggest fear?"},{question:"What's the silliest argument you've ever had?",questionDisplay:"What's the silliest argument {{characterName}}'s ever had?"},{question:"What bizarre superpower would you want if they could choose?",questionDisplay:"What bizarre superpower would {{characterName}} want if they could choose?"},{question:"What's the weirdest thing you've ever eaten?",questionDisplay:"What's the weirdest thing {{characterName}}'s ever eaten?"},{question:"What ridiculous thing do you talk about in your sleep?",questionDisplay:"What ridiculous thing does {{characterName}} talk about in their sleep?"},{question:"What's the most embarrassing nickname your family calls you?",questionDisplay:"What's the most embarrassing nickname {{characterName}}'s family calls them?"},{question:"What's the goofiest dance move you do when you think no one's watching?",questionDisplay:"What's the goofiest dance move {{characterName}} does when they think no one's watching?"},{question:"What's the strangest thing you have in your closet but refuse to throw away?",questionDisplay:"What's the strangest thing {{characterName}} has in their closet but refuses to throw away?"},{question:"What's the weirdest thing you've googled recently?",questionDisplay:"What's the weirdest thing {{characterName}}'s googled recently?"},{question:"If you were a professional wrestler, what would your stage name be?",questionDisplay:"If {{characterName}} were a professional wrestler, what would their stage name be?"},{question:"If you invented a holiday, what would it celebrate?",questionDisplay:"If {{characterName}} invented a holiday, what would it celebrate?"},{question:"What unusual talent do you have that few people know about?",questionDisplay:"What unusual talent does {{characterName}} have that few people know about?"},{question:"If you could create a new ice cream flavor, what weird ingredients would you combine?",questionDisplay:"If {{characterName}} could create a new ice cream flavor, what weird ingredients would they combine?"},{question:"If you could have dinner with any three people from any time period, who would you choose?",questionDisplay:"If {{characterName}} could have dinner with any three people from any time period, who would they choose?"},{question:"What's your family's strangest tradition?",questionDisplay:"What's {{characterName}}'s family's strangest tradition?"},{question:"What's the most important thing about yourself you'd say in a job interview?",questionDisplay:"What's the most important thing about {{characterName}} that they'd say in a job interview?"},{question:"What pet would you want to have?",questionDisplay:"What pet would {{characterName}} want to have?"},{question:"What business would you start if given the chance?",questionDisplay:"What business would {{characterName}} start if given the chance?"},{question:"What common phrase do you overuse?",questionDisplay:"What common phrase does {{characterName}} overuse?"},{question:"What guilty pleasure TV show do you secretly binge?",questionDisplay:"What guilty pleasure TV show does {{characterName}} secretly binge?"},{question:"What celebrity do you think you look like?",questionDisplay:"What celebrity does {{characterName}} think they look like?"},{question:"What's your most questionable impulse purchase?",questionDisplay:"What's {{characterName}}'s most questionable impulse purchase?"},{question:"What would you blow your lottery winnings on first?",questionDisplay:"What would {{characterName}} blow their lottery winnings on first?"},{question:"What's your most used emoji that makes no sense?",questionDisplay:"What's {{characterName}}'s most used emoji that makes no sense?"},{question:"What outdated technology do you refuse to let go of?",questionDisplay:"What outdated technology does {{characterName}} refuse to let go of?"},{question:"What's the strangest souvenir you've ever bought?",questionDisplay:"What's the strangest souvenir {{characterName}} has ever bought?"},{question:"What destination would you revisit every year if possible?",questionDisplay:"What destination would {{characterName}} revisit every year if possible?"},{question:"Who do you usually spend the holidays with?",questionDisplay:"Who does {{characterName}} usually spend the holidays with?"},{question:"What's your weirdest work-from-home habit?",questionDisplay:"What's {{characterName}}'s weirdest work-from-home habit?"},{question:"What job would you be terrible at?",questionDisplay:"What job would {{characterName}} be terrible at?"},{question:"What's your dream side hustle?",questionDisplay:"What's {{characterName}}'s dream side hustle?"},{question:"What's your preferred method of avoiding work calls?",questionDisplay:"What's {{characterName}}'s preferred method of avoiding work calls?"},{question:"What's your favorite way to waste time?",questionDisplay:"What's {{characterName}}'s favorite way to waste time?"},{question:"What's the strangest thing you would spend money on?",questionDisplay:"What's the strangest thing {{characterName}} would spend money on?"},{question:"If you were invisible for a day, what's the first thing you would do?",questionDisplay:"If {{characterName}} were invisible for a day, what's the first thing {{characterName}} would do?"},{question:"If you had a secret lair, what would it look like?",questionDisplay:"If {{characterName}} had a secret lair, what would it look like?"},{question:"What's your biggest pet peeve?",questionDisplay:"What's {{characterName}}'s biggest pet peeve?"},{question:"What's the most embarrassing thing you've ever done?",questionDisplay:"What's {{characterName}}'s most embarrassing thing they've ever done?"},{question:"If you were an animal, what would you be?",questionDisplay:"If {{characterName}} were an animal, what would they be?"},{question:"What's the craziest thing you'd do to get out of trouble?",questionDisplay:"What's the craziest thing {{characterName}} would do to get out of trouble?"},{question:"Would you rather fight 100 duck-sized horses or one horse-sized duck?",questionDisplay:"Would {{characterName}} rather fight 100 duck-sized horses or one horse-sized duck?"},{question:"What's your guilty pleasure song?",questionDisplay:"What's {{characterName}}'s guilty pleasure song?"},{question:"What's your favorite excuse for being late?",questionDisplay:"What's {{characterName}}'s favorite excuse for being late?"},{question:"What's the most awkward thing you've ever said to someone?",questionDisplay:"What's the most awkward thing {{characterName}} has ever said to someone?"},{question:"Who is your arch-nemesis?",questionDisplay:"Who is {{characterName}}'s arch-nemesis?"},{question:"If you had a crush, how would you try to impress them?",questionDisplay:"If {{characterName}} had a crush, how would they try to impress them?"},{question:"Would you rather have hiccups forever or always feel like you need to sneeze but can't?",questionDisplay:"Would {{characterName}} rather have hiccups forever or always feel like they need to sneeze but can't?"},{question:"Would you rather live in a house made of candy or one made of cheese?",questionDisplay:"Would {{characterName}} rather live in a house made of candy or one made of cheese?"},{question:"If you had to wear one outfit forever, what would it be?",questionDisplay:"If {{characterName}} had to wear one outfit forever, what would it be?"},{question:"What would be the title of your autobiography?",questionDisplay:"What would be the title of {{characterName}}'s autobiography?"},{question:"If you starred in a reality TV show, what would it be called?",questionDisplay:"If {{characterName}} starred in a reality TV show, what would it be called?"},{question:"What's the most awkward thing you'd say to someone famous?",questionDisplay:"What's the most awkward thing {{characterName}} would say to someone famous?"},{question:"What's the weirdest place you'd get stuck in?",questionDisplay:"What's the weirdest place {{characterName}} would get stuck in?"},{question:"What's the most random thing you're scared of?",questionDisplay:"What's the most random thing {{characterName}} is scared of?"},{question:"What's your go-to strategy in a zombie apocalypse?",questionDisplay:"What's {{characterName}}'s go-to strategy in a zombie apocalypse?"},{question:"What's the most unbelievable lie you'd tell about your past?",questionDisplay:"What's the most unbelievable lie {{characterName}} would tell about their past?"},{question:"If you were famous, what would it be for?",questionDisplay:"If {{characterName}} were famous, what would it be for?"},{question:"What's the first thing you'd do if you woke up as a giant?",questionDisplay:"What's the first thing {{characterName}} would do if they woke up as a giant?"},{question:"If you could time travel, what's the first thing you'd do in the past?",questionDisplay:"If {{characterName}} could time travel, what's the first thing they'd do in the past?"},{question:"What's the one thing you secretly believe you're better at than everyone else?",questionDisplay:"What's the one thing {{characterName}} secretly believes they're better at than everyone else?"},{question:"If you could join a circus, what would your act be?",questionDisplay:"If {{characterName}} could join a circus, what would their act be?"},{question:"What's the most embarrassing way you'd accidentally go viral?",questionDisplay:"What's the most embarrassing way {{characterName}} would accidentally go viral?"},{question:"If you forgot someone's name, what would you call them instead?",questionDisplay:"If {{characterName}} forgot someone's name, what would they call them instead?"},{question:"If you broke a world record, what would it be for?",questionDisplay:"If {{characterName}} broke a world record, what would it be for?"},{question:"What's the strangest prank you'd pull if you could get away with it?",questionDisplay:"What's the strangest prank {{characterName}} would pull if they could get away with it?"},{question:"What's the most random object you'd want the power to control?",questionDisplay:"What's the most random object {{characterName}} would want the power to control?"},{question:"What's your idea of the most awkward first date?",questionDisplay:"What's {{characterName}}'s idea of the most awkward first date?"},{question:"What's the most random thing you carry around in your pocket?",questionDisplay:"What's the most random thing {{characterName}} carries around in their pocket?"},{question:"If you had to replace your hands with something else, what would you choose?",questionDisplay:"If {{characterName}} had to replace their hands with something else, what would they choose?"},{question:"If you were a genre of music, what would you be?",questionDisplay:"If {{characterName}} were a genre of music, what would they be?"},{question:"What's the weirdest thing you do when nobody's watching?",questionDisplay:"What's the weirdest thing {{characterName}} does when nobody's watching?"},{question:"What's your go-to excuse for skipping a boring event?",questionDisplay:"What's {{characterName}}'s go-to excuse for skipping a boring event?"},{question:"What's your best strategy for escaping from a locked room?",questionDisplay:"What's {{characterName}}'s best strategy for escaping from a locked room?"},{question:"What's the most ridiculous thing you'd pack in a survival kit?",questionDisplay:"What's the most ridiculous thing {{characterName}} would pack in a survival kit?"},{question:"What's the one thing you'd never do, even for a million dollars?",questionDisplay:"What's the one thing {{characterName}} would never do, even for a million dollars?"},{question:"What's your worst idea for starting a conversation?",questionDisplay:"What's {{characterName}}'s worst idea for starting a conversation?"},{question:"What's the most bizarre way you'd fix a common problem?",questionDisplay:"What's the most bizarre way {{characterName}} would fix a common problem?"},{question:"What is the thing you're most likely to end up in jail for?",questionDisplay:"What is the thing {{characterName}} is most likely to end up in jail for?"},{question:"What is your favorite pizza topping?",questionDisplay:"What is {{characterName}}'s favorite pizza topping?"},{question:"How do you like your tea or coffee?",questionDisplay:"How does {{characterName}} like their tea or coffee?"},{question:"If you could throw a themed party, what would it be?",questionDisplay:"If {{characterName}} could throw a themed party, what would it be?"},{question:"What's your favorite board game?",questionDisplay:"What's {{characterName}}'s favorite board game?"},{question:"What is your favorite flavor of ice cream?",questionDisplay:"What is {{characterName}}'s favorite flavor of ice cream?"},{question:"If you were on 'Who Wants to be a Millionaire', who would your phone-a-friend be?",questionDisplay:"If {{characterName}} were on 'Who Wants to be a Millionaire', who would their phone-a-friend be?"},{question:"What's your favorite hobby?",questionDisplay:"What's {{characterName}}'s favorite hobby?"},{question:"What's your favorite thing to do on a Saturday night?",questionDisplay:"What's {{characterName}}'s favorite thing to do on a Saturday night?"},{question:"What traffic sign best describes you on a bad day?",questionDisplay:"What traffic sign best describes {{characterName}} on a bad day?"},{question:"How would you react to a flying cockroach?",questionDisplay:"How would {{characterName}} react to a flying cockroach?"},{question:"What's your favorite season and why?",questionDisplay:"What's {{characterName}}'s favorite season and why?"},{question:"What would you wear on a first date?",questionDisplay:"What would {{characterName}} wear on a first date?"},{question:"If you could go back to school, what would you study?",questionDisplay:"If {{characterName}} could go back to school, what would they study?"},{question:"What is your favorite drink?",questionDisplay:"What is {{characterName}}'s favorite drink?"},{question:"What is the best present you've ever given?",questionDisplay:"What is the best present {{characterName}} has ever given?"},{question:"What is your favorite dessert?",questionDisplay:"What is {{characterName}}'s favorite dessert?"},{question:"What is your favorite childhood memory?",questionDisplay:"What is {{characterName}}'s favorite childhood memory?"},{question:"If you could have any exotic pet, what would it be?",questionDisplay:"If {{characterName}} could have any exotic pet, what would it be?"},{question:"What's the most adventurous activity you've done?",questionDisplay:"What's the most adventurous activity {{characterName}} has done?"},{question:"How do you resolve disagreements with your friends?",questionDisplay:"How does {{characterName}} resolve disagreements with their friends?"},{question:"What's something you're always right about?",questionDisplay:"What's something {{characterName}} is always right about?"},{question:"What's the most extreme sport you would try?",questionDisplay:"What's the most extreme sport {{characterName}} would try?"},{question:"How do you unwind after a long day?",questionDisplay:"How does {{characterName}} unwind after a long day?"}];var b={src:"/_next/static/media/matchme.07968130.jpg",height:300,width:300,blurDataURL:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAgACAMBIgACEQEDEQH/xAAoAAEBAAAAAAAAAAAAAAAAAAAAAgEBAQAAAAAAAAAAAAAAAAAAAwb/2gAMAwEAAhADEAAAAKB0v//EABsQAAEEAwAAAAAAAAAAAAAAAAIAERITAxRC/9oACAEBAAE/ABPFrVVi8Wl0v//EABoRAAEFAQAAAAAAAAAAAAAAAAEAAgMEERL/2gAIAQIBAT8ANqVuc4F//8QAGhEAAgIDAAAAAAAAAAAAAAAAAQMAEQQFIv/aAAgBAwEBPwBOrwyWWu+p/9k=",blurWidth:8,blurHeight:8},x={src:"/_next/static/media/matchmeoops.873e9ce8.jpg",height:300,width:300,blurDataURL:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAgACAMBIgACEQEDEQH/xAAoAAEBAAAAAAAAAAAAAAAAAAAABQEBAQAAAAAAAAAAAAAAAAAAAgP/2gAMAwEAAhADEAAAALgNP//EABwQAAEDBQAAAAAAAAAAAAAAAAMAERITFCExMv/aAAgBAQABPwBg28aY+dyyv//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Af//EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8AWU//2Q==",blurWidth:8,blurHeight:8};let y=(e,t,a,s,n)=>{let{t:o}=(0,g.$G)(),l=o("Games.stop-description"),[d,c]=(0,u.useState)(b),[m,p]=(0,u.useState)(o("Games.matchme-rules",{characterName:o("Games.your-friend",{}),maxRounds:4})),[y,v]=(0,u.useState)(0),[w,P]=(0,u.useState)(0),[A,k]=(0,u.useState)(0),[j,N]=(0,u.useState)(0),[_,C]=(0,u.useState)(""),[H,S]=(0,u.useState)(""),[I,q]=(0,u.useState)(-1),[D,E]=(0,u.useState)(-1),[W,G]=(0,u.useState)(),[M,z]=(0,u.useState)(),{user:T}=(0,r.a)(),O=(null==T?void 0:T.name)||"You",B=e=>e.sort(()=>Math.random()-.5),[R,F]=(0,u.useState)(()=>B(f));(0,u.useEffect)(()=>{if(I>=0&&D!==I){E(I);let e=(null==W?void 0:W.participant__name)||"the other player",n=o(R[I].questionDisplay,{characterName:e});t({markdownText:o("Games.matchme-rules-with-question",{characterName:e,maxRounds:4,question:n})}),y>1&&A<4&&s("Round ".concat(A+1,": ").concat(n)),A<4&&a("Answer the following question and remember to stay in character as ".concat(e,": ").concat(R[I].question))}},[I,W,t,R,D,s,a,A,y,o]);let L=()=>{I<R.length-1?q(e=>e+1):(F(B(f)),q(0))},U=e=>{P(w+1),e&&(z(l),c(x),N(0))},Q=async(e,t)=>{let a=(null==W?void 0:W.participant__name)||"the other player",s=o(R[I].questionDisplay,{characterName:a}),n={gameType:h.Ox.MATCH_ME,scoreRecipient:O,userMessage:e,characterName:null==W?void 0:W.participant__name,characterMessage:t,question:s};try{let e=await fetch("/api/games/judge",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)throw Error("Failed to submit data");return await e.json()}catch(e){return""}},K=(t,r)=>{n(!1),s("Game over!"),z(o("Games.matchme-end-description",{score:r})),t&&a("Game over! I scored ".concat(r," points (out of ").concat(800," possible points)!")),U(!1),e(!1,r)},V=async e=>{var t,a,n,r,l,d,c,u,h,m;if(I>=0&&0===y){let e=(null==W?void 0:W.participant__name)||"the other player",t=o(R[I].questionDisplay,{characterName:e});s("Round ".concat(A+1,": ").concat(t))}if(v(y+1),y>0&&e.length>2&&(null===(a=e[1])||void 0===a?void 0:null===(t=a.author)||void 0===t?void 0:t.is_human)&&!(null===(r=e[2])||void 0===r?void 0:null===(n=r.author)||void 0===n?void 0:n.is_human)&&!(null===(l=e[1].candidates[0].raw_content)||void 0===l?void 0:l.toLowerCase().startsWith(i.U))){let t=(null===(d=e[2].candidates[0].raw_content)||void 0===d?void 0:d.toLowerCase())||"",a=(null===(c=e[1].candidates[0].raw_content)||void 0===c?void 0:c.toLowerCase())||"",s=await Q(a,t);s&&$({points:null!==(h=null!==(u=s.points)&&void 0!==u?u:s.score)&&void 0!==h?h:"",reason:null!==(m=s.reason)&&void 0!==m?m:""}),L()}},$=e=>{if(e){let t;let a=((Number.isNaN(t=parseInt(e.points,10)||-1)||-1===t)&&(e.reason.includes("0")?t=0:e.reason.includes("100")?t=100:e.reason.includes("200")&&(t=200)),Number.isNaN(t)||t<=99)?0:t<=199?100:200;C("".concat(a)),S(e.reason);let s=j+a;N(s),A+1>=4&&K(!0,s),k(A+1)}};return{gameKey:h.Ox.MATCH_ME,title:"Match Me If You Can",description:M,numRounds:w,logo:b,gameImage:d,gameRules:m,score:j,characterScore:void 0,scoreInfo:_,scoreCommentary:H,scoreRecipient:O,stopGame:U,newGame:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=(null==W?void 0:W.participant__name)||o("Games.other-player");e&&a("You're about to play Match Me If You Can! \nIn this game, the user will try to answer questions about you, ".concat(s,", and match your answers. \nYour job is to answer as yourself—using your unique personality, backstory, and quirks. \nBe consistent, fun, and true to your character to make the game engaging!\nStart with a friendly and playful greeting to set the tone, like you're excited to see how well they know you!\n")),c(b),N(0),n(!0),L(),C(""),S(""),z(void 0),t({markdownText:o("Games.matchme-rules",{characterName:s,maxRounds:4})}),v(0),k(0),P(w+1)},handleUpdateMessages:V,init:e=>{G(e),c(b),z(void 0),p(o("Games.matchme-rules",{characterName:e.participant__name,maxRounds:4})),v(0),k(0),C(""),S(""),N(0)}}};var v={src:"/_next/static/media/war-words-oops.ff6a9327.jpg",height:300,width:300,blurDataURL:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAgACAMBIgACEQEDEQH/xAAoAAEBAAAAAAAAAAAAAAAAAAAABgEBAQAAAAAAAAAAAAAAAAAAAwT/2gAMAwEAAhADEAAAAJkJV//EABwQAAIBBQEAAAAAAAAAAAAAAAIRAQADBRQhI//aAAgBAQABPwABxuo/OTm0ug+pqv/EABcRAQADAAAAAAAAAAAAAAAAAAIAEXH/2gAIAQIBAT8AAKvZ/8QAGhEAAAcAAAAAAAAAAAAAAAAAAAECAyExMv/aAAgBAwEBPwBxWYKh/9k=",blurWidth:8,blurHeight:8},w={src:"/_next/static/media/war-words.6968c08f.jpg",height:300,width:300,blurDataURL:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAgACAMBIgACEQEDEQH/xAAoAAEBAAAAAAAAAAAAAAAAAAAABAEBAQAAAAAAAAAAAAAAAAAAAgP/2gAMAwEAAhADEAAAAIxdf//EABwQAAEDBQAAAAAAAAAAAAAAAAIBAxIABAURIf/aAAgBAQABPwCWPK3IItk4bfVki6r/xAAXEQEAAwAAAAAAAAAAAAAAAAABAAID/9oACAECAQE/ADOrP//EABoRAAICAwAAAAAAAAAAAAAAAAMRAAECEiH/2gAIAQMBAT8AIbMa1Xan/9k=",blurWidth:8,blurHeight:8};let P=(e,t,a,s)=>{let{t:n}=(0,g.$G)(),[o,i]=(0,u.useState)(w),[l,d]=(0,u.useState)(),[c,m]=(0,u.useState)(0),[p,f]=(0,u.useState)(0),[b,x]=(0,u.useState)(0),[y,P]=(0,u.useState)(0),[A,k]=(0,u.useState)(0),[j,N]=(0,u.useState)(""),[_,C]=(0,u.useState)(""),[H,S]=(0,u.useState)(""),[I,q]=(0,u.useState)(),D=n("Games.oops-description"),E=n("Games.stop-description"),W=n("Games.war-of-words-rules"),{user:G}=(0,r.a)(),M=(null==G?void 0:G.name)||"You",z=e=>{f(p+1),e&&(d(E),i(v),P(0),k(0))},T=async(e,t)=>{let a={userName:M,userMessage:e,characterName:null==I?void 0:I.participant__name,characterMessage:t,gameType:h.Ox.WAR_WORDS};try{let e=await fetch("/api/games/judge",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!e.ok)throw Error("Failed to submit data");let t=await e.json();return JSON.stringify(t)}catch(e){return""}},O=(t,r)=>{d(n("Games.win-description",{score:r})),s(n("Games.winner-name",{name:M})),t&&a("".concat(M," won the battle with ").concat(r," total points!")),z(!1),e(!1,r,!0)},B=(t,r)=>{i(v),s(n("Games.winner-name",{name:null==I?void 0:I.participant__name})),d(D),t&&a("".concat(null==I?void 0:I.participant__name," won the battle with ").concat(r," total points!")),z(!1),e(!1,0,!1)},R=async e=>{var t,a,s,n,r,o;if(m(c+1),c>0&&e.length>1&&!(null===(a=e[0])||void 0===a?void 0:null===(t=a.author)||void 0===t?void 0:t.is_human)&&(null===(n=e[1])||void 0===n?void 0:null===(s=n.author)||void 0===s?void 0:s.is_human)){let t=(null===(r=e[0].candidates[0].raw_content)||void 0===r?void 0:r.toLowerCase())||"",a=(null===(o=e[1].candidates[0].raw_content)||void 0===o?void 0:o.toLowerCase())||"",s=await T(a,t);s&&F(JSON.parse(s))}},F=e=>{if(e){let t=(()=>{let t=parseInt(e.points,10);return Number.isNaN(t)||t<50?50:t>1e3?1e3:t})();N(t.toString()),e.winner===h.Zz?(C(n("Games.tie-reason")),S(n("Games.tie-winner")),s(n("Games.round-tie",{round:b+1}))):(C(e.reason),S(e.winner),s(n("Games.round-winner",{round:b+1,name:e.winner})));let a=y,r=A;e.winner===M?P(a=Math.min(y+t,1e3)):e.winner===(null==I?void 0:I.participant__name)?k(r=Math.min(A+t,1e3)):(a=Math.min(y+t,1e3),r=Math.min(A+t,1e3),P(a),k(r));let o=b+1>=5;a>=1e3||o&&a>=r?O(!0,a):(r>=1e3||o)&&B(!0,r),x(b+1)}};return{gameKey:h.Ox.WAR_WORDS,title:"War of Words",description:l,numRounds:p,logo:w,gameImage:o,gameRules:W,score:y,characterScore:A,scoreInfo:j,scoreCommentary:_,scoreRecipient:H,stopGame:z,newGame:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i(w),P(0),k(0),N(""),C(""),S(""),d(void 0),e&&a("Let's play a game! We'll take turns explaining how we're fighting each other.\n        I have someone watching the chat and will paste in their scoring.\n        I will go first by naming my initial weapon. You creatively fight back anyway you can! Ready?"),t({markdownText:n("Games.war-of-words-rules")}),m(0),x(0),f(p+1)},handleUpdateMessages:R,init:e=>{q(e),i(w),d(void 0),m(0),x(0),N(""),C(""),S(""),P(0),k(0)}}};var A=a(47022),k=a(70677);let j=u.createContext({gameMessages:[],gameState:h.D2.NOT_PLAYING,gamePropertiesList:[],scoreData:{score:0},selectedGame:null,gameRoundsRemaining:0,isGameInProgress:!1,isGameInResults:!1,sendChatMessages:!1,highScores:[],hideLastCharacterMessage:!1,character:void 0,gamesEnabled:!1,selectGameDialogOpen:!1,showGameButton:!1,toggleSelectGameDialog:()=>{},setCurrentGame:e=>{},toggleSendChatMessages:()=>{},startGame:()=>{},leaveGameInProgress:()=>{},endGame:()=>{}}),N=(e,t)=>t,_=e=>{let{children:t,chatMessages:a,streamingStatus:d,character:c}=e,{t:m}=(0,g.$G)(),{isPlusUser:f}=(0,r.a)(),[b,x]=(0,u.useState)(h.D2.NOT_PLAYING),[v,w]=(0,u.useState)([]),[_,C]=(0,u.useState)(null),[H,S]=(0,u.useState)(0),[I,q]=(0,u.useState)(!0),D=null==a?void 0:a[0],E=null==a?void 0:a.length,W=b===h.D2.PLAYING,G=b===h.D2.RESULTS,{publish:M,addSystemTurn:z}=(0,A.m)(),{isVoiceEnabled:T,disableVoice:O,expectCharacterSpeech:B}=(0,o.AW)(),[R,F]=(0,u.useState)(!1),L=(0,u.useRef)(0),[U,Q]=(0,u.useState)(!1),K=(0,u.useCallback)(()=>_&&c&&(null==c?void 0:c.external_id)?JSON.parse(window.localStorage.getItem(N(null==c?void 0:c.external_id,_))||"[]"):[],[_,c]),[V,$]=(0,u.useState)([]),Y=(0,u.useCallback)(()=>{q(!I)},[I]),J=(0,u.useCallback)(function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];M((null==c?void 0:c.external_id)||"",{type:"create_and_generate",message:t?"".concat(i.U).concat(e):e,ttsEnabled:T}),B()},[c,T,B,M]),Z=(0,u.useCallback)(e=>{w(t=>[...t,e])},[]),X=(0,u.useCallback)(e=>{(null==c?void 0:c.external_id)&&z(null==c?void 0:c.external_id,e,k.lo.game_message)},[z,c]),ee=(0,u.useCallback)((e,t)=>{_&&$(()=>{let a=[...K(),{character:e,score:t}].filter((e,t,a)=>a.findIndex(t=>t.character.external_id===e.character.external_id&&t.score===e.score)===t).toSorted((e,t)=>t.score-e.score).slice(0,5);return window.localStorage.setItem(N(e.external_id,_),JSON.stringify(a)),a})},[_,$,K]),et=(0,u.useCallback)((e,t,a)=>{let s;F(!1),e?(x(h.D2.NOT_PLAYING),X(m("Games.interrupted"))):x(h.D2.RESULTS),!e&&c&&(ee(c,t),l.E.fire({interrupt:e,score:t,win:a})),s=void 0===a?"abandoned":a?"win":"loss",n.iN.gameEnd({character_id:null==c?void 0:c.external_id,game:_||"",score:t,value:s,referrer:"GameProvider",duration:Date.now()-L.current})},[_,m,c,x,F,X,ee]),ea={[h.Ox.GUESS_WORD]:p(et,Z,J,X,b),[h.Ox.WAR_WORDS]:P(et,Z,J,X),[h.Ox.MATCH_ME]:y(et,Z,J,X,F)},es=_?ea[_]:Object.values(ea)[0],en=(0,u.useCallback)(e=>{if(C(e),null!=e&&c){var t;null===(t=ea[e])||void 0===t||t.init(c)}},[ea,c]),er=(0,u.useCallback)(()=>{var e;_&&(w([]),L.current=Date.now(),F(!1),S(null!==(e=null==a?void 0:a.length)&&void 0!==e?e:0),x(h.D2.PLAYING),X(m("Games.you-started-game",{gameName:null==es?void 0:es.title})),null==es||es.newGame(I),n.iN.gameStart({character_id:null==c?void 0:c.external_id,game:_||"",referrer:"GameProvider"}))},[c,_,m,X,es,a,I]),eo=(0,u.useCallback)(()=>{x(h.D2.NOT_PLAYING)},[]);(0,u.useEffect)(()=>{$(K())},[K]),(0,u.useEffect)(()=>{w([]),_||x(h.D2.NOT_PLAYING)},[_]),(0,u.useEffect)(()=>{W&&"none"===d&&E&&E>H&&(S(E),null==es||es.handleUpdateMessages(a))},[W,D,d,b,a,es,E,H]);let ei=(0,u.useCallback)(()=>{Q(!U)},[Q,U]);(0,u.useEffect)(()=>{T&&W&&_===h.Ox.SAME_TIME&&O()},[T,W,_,O]);let el=(0,u.useMemo)(()=>{var e,t,a,s,n;let r=Object.keys(ea).map(e=>ea[e]?{title:ea[e].title,description:ea[e].description,logo:ea[e].logo,gameImage:ea[e].gameImage,gameRules:ea[e].gameRules,gameKey:e}:null).filter(Boolean),o=_&&ea[_]?{title:null===(e=ea[_])||void 0===e?void 0:e.title,description:null===(t=ea[_])||void 0===t?void 0:t.description,logo:null===(a=ea[_])||void 0===a?void 0:a.logo,gameImage:null===(s=ea[_])||void 0===s?void 0:s.gameImage,gameRules:null===(n=ea[_])||void 0===n?void 0:n.gameRules,gameKey:_}:null;return{scoreData:{score:(null==es?void 0:es.score)||0,scoreInfo:null==es?void 0:es.scoreInfo,characterScore:null==es?void 0:es.characterScore,scoreCommentary:null==es?void 0:es.scoreCommentary,scoreRecipient:null==es?void 0:es.scoreRecipient,itemResults:null==es?void 0:es.itemResults},showGameButton:f&&!o&&!W,gameMessages:v,gameState:b,gamePropertiesList:r,gameRoundsRemaining:(null==es?void 0:es.numRounds)||0,selectedGame:o,startGame:er,leaveGameInProgress:eo,endGame:()=>{null==es||es.stopGame(!1),et(!1,(null==es?void 0:es.score)||0)},isGameInProgress:W,isGameInResults:G,currentGameMechanics:es,sendChatMessages:I,toggleSendChatMessages:Y,highScores:V,gameMechanics:ea,setCurrentGame:en,hideLastCharacterMessage:R,character:c,gamesEnabled:f,selectGameDialogOpen:U,toggleSelectGameDialog:ei}},[c,v,b,_,W,G,es,I,V,ea,R,f,U,er,et,eo,en,Y,ei]);return(0,s.jsx)(j.Provider,{value:el,children:t})};function C(){return u.useContext(j)}},66098:function(e,t,a){var s,n,r,o,i,l;a.d(t,{D2:function(){return n},JU:function(){return r},Ox:function(){return s},Zz:function(){return d}}),(o=s||(s={})).GUESS_WORD="GUESS_WORD",o.SAME_TIME="SAME_TIME",o.MATCH_ME="MATCH_ME",o.WAR_WORDS="WAR_WORDS",Object.values(s),(i=n||(n={})).NOT_PLAYING="NOT_PLAYING",i.PLAYING="PLAYING",i.RESULTS="RESULTS",(l=r||(r={})).WON="WON",l.LOST="LOST",l.PLAYING="PLAYING",l.PASSED="PASSED",l.UNSEEN="UNSEEN";let d="TIE"},14755:function(e,t,a){a.d(t,{U:function(){return s}});let s="\n	\n		\n	\n"},45444:function(e,t,a){a.d(t,{E:function(){return n},o:function(){return r}});var s=a(13959);let n=(0,s.y)(),r=(0,s.y)()},41591:function(e,t,a){a.d(t,{JE:function(){return h},Og:function(){return u}});var s=a(2608),n=a(92488),r=a(47022),o=a(2784),i=a(10386),l=a(15584);let d=(0,l.td)(!1),c="",u=e=>{e?c!==e&&(c=e,d.value=!0):d.value=!0},h=(e,t)=>{let{t:a}=(0,i.$G)(),{deleteMessages:d}=(0,r.m)(),c=(0,l.BF)(n.B$),u=(0,l.BF)(n.WK);(0,o.useEffect)(()=>{if(!e||!c||!t)return;let r=e[e.length-c-1];r&&d(t,[r.turn_key.turn_id],e=>{e?(0,s.K)(a("Chat.delete-successful"),5e3,"default"):(0,s.K)(a("Chat.delete-unsuccessful"),5e3,"default")}),n.B$.value=null},[t,e,d,c,a]),(0,o.useEffect)(()=>{if(!e||!u||!t)return;let r=e.slice(0,e.length-u-1).map(e=>e.turn_key.turn_id);(null==r?void 0:r.length)&&d(t,r,()=>{(0,s.K)(a("Chat.rewind-successful"),void 0)}),n.WK.value=null},[t,e,d,u,a])}},31727:function(e,t,a){a.d(t,{JB:function(){return ee},jW:function(){return es},QT:function(){return en},F6:function(){return et},VU:function(){return ea}});var s=a(52322),n=a(21236),r=a(83944),o=a(48364),i=a(63276),l=a(50567),d=a(27714),c=a(79357),u=a(93326),h=a(92599),m=a(34581),g=a(92014),p=a(2608),f=a(35740),b=a(55274),x=a(67378),y=a(92138),v=a(74251),w=a(92488),P=a(6553),A=a(34318);a(43145);let k=e=>{var t,a;return!!e&&!(null==e?void 0:null===(a=e.user)||void 0===a?void 0:null===(t=a.account)||void 0===t?void 0:t.onboarding_complete)};var j=a(15030),N=a(68582),_=a(55541),C=a(75015),H=a(2784),S=a(10386);let I=()=>{let{t:e}=(0,S.$G)(),[t,a]=(0,H.useState)(!1),{character:r}=(0,b.AU)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.WB,{open:t,setOpen:a,referrer:"ChatInputCallButton"}),(0,s.jsx)(_.l,{content:e("Calls.call-name",{name:null==r?void 0:r.name}),side:"top",className:"text-center text-sm",children:(0,s.jsx)(u.zx,{isIconOnly:!0,variant:"outline",className:"-ml-2 bg-background",onPress:()=>{n.iN.elementClicked({referrer:"ChatInputCallButton",character_id:null==r?void 0:r.external_id,action:"call_button_pressed"}),w.tI.value=!0},children:(0,s.jsx)(h.lUz,{className:"w-5 h-5"})})})]})};var q=a(47022),D=a(50926),E=a(79937),W=a(59375),G=a(16538),M=a(83614),z=a(53111),T=a(79443),O=a(66582),B=a(15584),R=a(22801),F=a(68159),L=a(35981),U=a(61676),Q=a(55264),K=a(66149);function V(){let{t:e}=(0,S.$G)(),{isVoiceEnabled:t,enableVoice:a,disableVoice:n,hasVoice:r}=(0,x.AW)();return t?(0,s.jsxs)(u.zx,{onPress:n,variant:"outline",className:"hover:bg-surface-elevation-3 w-full justify-start bg-surface-elevation-1 shadow-glow rounded-spacing-xs text-sm",children:[(0,s.jsx)(h.uAs,{className:"size-4 text-voice-blue"}),e("Chat.disable-voice")]}):(0,s.jsxs)(u.zx,{onPress:a,variant:"ghost",className:"hover:bg-surface-elevation-3 w-full justify-start rounded-spacing-xs text-sm",children:[r?(0,s.jsx)(h.AsP,{className:"size-4"}):(0,s.jsx)(h.TW3,{className:"size-4"}),e("Chat.enable-voice")]})}var $=a(2133);function Y(){let e=(0,K.Z)(),t=(0,H.useRef)(null),{t:a}=(0,S.$G)(),[r,o]=(0,H.useState)(!1),{characterId:i}=(0,b.AU)(),d=(0,M.useGateValue)(l.F5.ChatImageAttachments),c=(0,B.BF)(w.Af);(0,H.useEffect)(()=>{if(c===w.c.ChatAttachment){var e;w.Af.value=void 0,null===(e=t.current)||void 0===e||e.click()}},[c]);let{isStaff:m}=(0,f.a)();if(!m)return null;let g=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&(w.i8.value=a,n.iN.chatAttachment({type:"attachment_selected",source:"image_library",value:"TYPE_IMAGE"}),o(!1))},p=[{content:(0,s.jsx)(V,{}),asChild:!0,key:"voice"},{content:(0,s.jsxs)(u.zx,{variant:"ghost",className:"hover:bg-surface-elevation-3 w-full justify-start text-sm rounded-spacing-xs",onPress:()=>e(Q.nN.chat(i),"Character"),children:[(0,s.jsx)(h.aAc,{className:"size-4"}),a("Common.share")]}),asChild:!0,key:"share"},...d?[{content:(0,s.jsxs)("div",{className:"w-full flex justify-start",children:[(0,s.jsxs)(u.zx,{variant:"ghost",className:"hover:bg-surface-elevation-3 w-full justify-start text-sm rounded-spacing-xs",onPress:()=>{(0,F.q)(w.c.ChatAttachment,()=>{var e;null===(e=t.current)||void 0===e||e.click()})},children:[(0,s.jsx)(h.r96,{className:"size-4"}),a("Chat.add-image")]}),(0,s.jsx)("div",{className:"absolute right-2",children:(0,s.jsx)(R.o,{trigger:w.c.ChatAttachment})})]}),asChild:!0,key:"add_photo"}]:[],{content:(0,s.jsxs)(u.zx,{variant:"ghost",isDisabled:!0,className:"hover:bg-surface-elevation-3 w-full justify-start",children:[(0,s.jsx)(h.qzz,{className:"size-4"}),a("Chat.imagine-soon")]}),asChild:!0,key:"image"}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:g,ref:t,className:"hidden"}),(0,s.jsx)(L.C,{side:"top",options:p,contentClassName:"absolute -left-11 bottom-1 p-1 flex items-start w-2xs",setIsOpen:o,isOpen:r,asChild:!0,children:(0,s.jsx)(u.zx,{isIconOnly:!0,variant:"outline",className:(0,U.cn)("hover:bg-surface-elevation-2 -mr-2",{"bg-surface-elevation-2":r}),onPress:()=>o(!r),children:(0,s.jsx)($.pzk,{height:"1.25em"})})})]})}var J=a(96577),Z=a.n(J);let X=()=>{let e=(0,B.BF)(w.i8),[t,a]=(0,H.useState)(null);return((0,H.useEffect)(()=>{if(!e){a(null);return}let t=URL.createObjectURL(e);return a(t),()=>{URL.revokeObjectURL(t)}},[e]),e&&t)?(0,s.jsxs)("div",{className:"flex items-center justify-center relative w-20 h-20",children:[(0,s.jsx)(u.zx,{variant:"primary",size:"sm",isIconOnly:!0,className:"mr-2 h-fit min-w-fit w-fit absolute top-0 -right-6 bg-background p-1",onPress:()=>{w.i8.value=void 0},children:(0,s.jsx)(h.Two,{height:"1.25em",color:"var(--icon-secondary)"})}),(0,s.jsx)(Z(),{src:t,alt:"Preview",width:100,height:100,style:{objectFit:"fill"}})]}):null};function ee(e){let{streamingStatus:t,onSendText:a,chatId:d}=e,{t:c}=(0,S.$G)(),{user:u}=(0,f.a)(),{unrecoverableError:h}=(0,y.Bo)(),m=(0,B.BF)(w.k5),g=A.h.useUtils(),{characterId:p,character:P}=(0,b.AU)(),[_,C]=(0,H.useState)(!1),{publish:I,subscribeChatEvents:E}=(0,q.m)(),{isVoiceEnabled:W,expectCharacterSpeech:G,abortCharacterSpeech:O}=(0,x.AW)(),R=(0,B.BF)(w.LT),F=(0,N.G)(),{showChatUpsell:L,refetchThrottlingQuota:U,refetchChatUpsellQuota:Q,isActivelyThrottled:K}=(0,y.f_)(),V=(0,M.useGateValue)(l.F5.NRTRecommendationEvents),[$,Y]=(0,H.useState)(!0),[J,Z]=(0,H.useState)(""),[X,ee]=(0,H.useState)(!1),{startMeasurement:et}=(0,i.b)(t);(0,H.useEffect)(()=>{let e=(0,j.mu)(p),t=localStorage.getItem(e);try{if(t){let{value:a,time:s}=JSON.parse(t);a&&1>(0,T.A)(new Date(s),new Date)&&Z(a),localStorage.removeItem(e)}}catch(e){(0,o.H)("Failed to retrieve previously typed value",{error:e})}},[p]);let ea=(0,z.fB)(J,1e3);(0,H.useEffect)(()=>{w.yc.value=Date.now()},[ea]),(0,H.useEffect)(()=>{null!=m&&(Z(m),w.k5.value=null)},[m]),(0,H.useEffect)(()=>{let e=e=>{e&&Z(t=>t.length?t:e)},t=E(D.qN.user_input_filtered,(t,a)=>e(null==a?void 0:a.filteredText)),a=E(D.qN.self_harm_detected,(t,a)=>e(null==a?void 0:a.filteredText));return()=>{t(),a()}},[E]);let en=(0,H.useCallback)(async()=>{let e;if(!p||"streaming"!==t&&K)return;let s="none"!==t;if(s&&I(p,{type:"abort"}),R){O();return}if(!s){if(w.i8.value){let{attachments:t}=await er(w.i8.value,ee,c);t&&(e=t),w.i8.value=void 0}et(),I(p,{type:"create_and_generate",message:J,ttsEnabled:W,attachments:e}),Z(""),G(),_||(C(!0),g.discovery.recent.invalidate()),a&&a(),U(),Q(),$&&(Y(!1),n.iN.messageSend({type:"first_text",character_id:p,chat_id:d||void 0,referrer:"ChatInput"}),r.w.removeSessionReplayTracking()),V&&n.iN.messageSubmit({char_length:J.length,character_id:p,chat_id:d||void 0,referrer:"ChatInput"})}},[K,O,p,d,G,_,J,R,$,W,a,I,U,Q,t,g.discovery.recent,et,V,c]),{resolveExampleChatPrompt:eo}=(0,y.a3)({setInputText:Z});(0,H.useEffect)(()=>{eo()},[eo]);let ei=W?R:"streaming"===t||K,el="waiting"===t||k(u),ed=(0,v.Dv)(),ec=(0,H.useMemo)(()=>ed?c("Chat.message"):P?c("Chat.message-char",{char:P.name}):c("Chat.send-a-message"),[P,ed,c]);return(0,s.jsx)(es,{onSend:en,showStopButton:ei,disableSubmitButton:el,placeholder:ec,inputText:J,setInputText:Z,unrecoverableError:h,showChatUpsell:L,disableCalls:F.isGameInProgress,isLoading:X,showChatActions:!0})}let et=e=>{let{onSend:t}=e,{t:a}=(0,S.$G)(),[n,r]=(0,H.useState)(""),{resolveExampleChatPrompt:o}=(0,y.a3)({setInputText:r});return(0,H.useEffect)(()=>{o()},[o]),(0,s.jsx)(es,{showStopButton:!1,disableSubmitButton:!1,onSend:()=>t(n),placeholder:a("Chat.send-a-message"),inputText:n,setInputText:e=>r(e)})},ea=()=>{let{t:e}=(0,S.$G)(),t=(0,v.Dv)(),[a,r]=(0,H.useState)("");return(0,H.useEffect)(()=>{let e=localStorage.getItem(j.hl.Keys.SafetyTimeout);if(e){let{chatDisabledUntilMs:t}=JSON.parse(e);n.iN.contentViewed({referrer:"ChatDisabled",type:"chat_safety_timeout",value:t});let a=setInterval(()=>{r((0,W.Sg)(t).formatted)},100);return()=>clearInterval(a)}},[]),(0,s.jsxs)("div",{className:"w-full flex self-center h-fit flex-col max-w-3xl pb-4 z-10",children:[(0,s.jsx)("div",{className:"w-full flex justify-center",children:(0,s.jsxs)("div",{className:(0,G.cn)("flex flex-col items-start p-3 rounded-xl  bg-surface-elevation-2 m-4 border-solid border-1 border-border-outline",{"w-full":t},{"w-fix pl-4 pr-24":!t}),children:[(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(h._BK,{className:"size-5 text-muted-foreground"}),(0,s.jsx)("p",{className:"font-bold text-sm",children:e("SafetyMonitor.ChatDisabled.title",{time:a}).toUpperCase()})]}),(0,s.jsx)("span",{className:"text-sm",children:e("SafetyMonitor.ChatDisabled.description")})]})}),(0,s.jsx)(c.F,{})]})},es=e=>{let{showStopButton:t,disableSubmitButton:a,onSend:r,placeholder:o,inputText:i,setInputText:l,unrecoverableError:m,disableBorder:p,disableCalls:f,showChatUpsell:b,isLoading:x,showChatActions:y}=e,{t:v}=(0,S.$G)(),w=(0,H.useRef)(!1),P=(0,H.useRef)(null);return((0,H.useEffect)(()=>{b&&!m&&n.iN.contentViewed({referrer:"Chat",type:"Upgrade-for-faster-response-times"})},[b,m]),m)?m===D.DE.CharacterNotAvailable?(0,s.jsxs)("div",{className:"flex flex-col items-center m-4",children:[(0,s.jsx)("p",{className:"bold",children:v("Error.character-not-available-title")}),(0,s.jsx)("p",{children:v("Error.character-not-available-body")})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center m-4",children:[(0,s.jsx)("p",{className:"bold",children:v("Error.something-went-wrong")}),(0,s.jsx)("p",{children:v("Error.please-refresh-or-try-again-later")})]}):(0,s.jsxs)("div",{className:"w-full flex items-center self-center h-fit flex-col max-w-3xl pb-4 z-10",children:[(0,s.jsx)(X,{}),(0,s.jsxs)("div",{className:(0,G.cn)("w-full flex justify-center items-center pr-4",{"pl-4":y}),children:[!!y&&(0,s.jsx)(Y,{}),(0,s.jsxs)("div",{className:(0,G.cn)("flex grow items-end p-1 rounded-sm placeholder:text-placeholder bg-surface-elevation-1 m-4",p?"":"border-solid border-1 border-border-outline"),children:[(0,s.jsx)(g.g,{autoFocus:!O.tq,ref:P,containerClassName:"ml-2",className:"text-lg border-none bg-surface-elevation-1 placeholder:text-placeholder placeholder:overflow-hidden placeholder:whitespace-nowrap",inputMode:"text",placeholder:o,onChange:e=>l(e.target.value),value:i,onCompositionStart:()=>{w.current=!0},onCompositionEnd:()=>{w.current=!1},onKeyDown:e=>{O.tq||w.current||"Enter"!==e.key||e.shiftKey||(e.preventDefault(),r())},chatMode:!0}),(0,s.jsx)("div",{className:"flex gap-3",children:(0,s.jsxs)(u.zx,{"aria-label":v("Chat.send-a-message"),isDisabled:a,disableAnimation:!0,disableRipple:!0,onPressStart:()=>{var e;r(),null===(e=P.current)||void 0===e||e.focus()},isIconOnly:!0,isLoading:x,children:[!t&&(0,s.jsx)(d.a2,{children:(0,s.jsx)(h.aIO,{height:"1.25em",color:"var(--icon-inverted)"})}),!!t&&(0,s.jsx)(d.a2,{children:(0,s.jsx)(h.wNq,{height:"1.25em",color:"var(--icon-inverted)"})})]})})]}),!i&&!f&&(0,s.jsx)(I,{})]}),(0,s.jsx)(c.F,{})]})};function en(){return(0,s.jsx)(m.O,{className:"flex items-end p-1 mx-6 rounded-sm h-12"})}async function er(e,t,a){try{t(!0);let a=new FileReader,s=await new Promise((t,s)=>{a.onload=()=>t(a.result),a.onerror=s,a.readAsDataURL(e)}),r=(0,P.k)(s),o=new FormData;o.append("image",r);let i=await (0,E.m)().uploadPrivateImage({formData:o}),l=[{type:"TYPE_IMAGE",url:i,localOverrideUrl:URL.createObjectURL(e)}];return n.iN.chatAttachment({type:"attachment_uploaded",value:"TYPE_IMAGE",size:e.size}),{attachments:l}}catch(e){return(0,p.A)(a("Error.something-went-wrong")),(0,o.H)("Failed to upload chat image attachment",{error:e}),{error:e}}finally{t(!1)}}},27909:function(e,t,a){a.d(t,{p:function(){return i}});var s=a(52322),n=a(93326),r=a(92599),o=a(61676);let i=e=>{let{selected:t,onThumbUp:a,onThumbDown:i,className:l}=e,d="up"===t,c="down"===t;return(0,s.jsxs)("div",{className:(0,o.cn)("flex h-6 items-center",l),children:[(0,s.jsx)(n.zx,{variant:"ghost",isIconOnly:!0,className:"hover:bg-inherit opacity-100",onPress:a,isDisabled:d,children:d?(0,s.jsx)(r.eLy,{height:16}):(0,s.jsx)(r.lbB,{height:16})}),(0,s.jsx)(n.zx,{variant:"ghost",isIconOnly:!0,className:"hover:bg-inherit opacity-100",onPress:i,isDisabled:c,children:c?(0,s.jsx)(r.C$L,{height:16}):(0,s.jsx)(r.kZ9,{height:16})})]})}},13160:function(e,t,a){a.d(t,{f:function(){return ei}});var s=a(52322),n=a(50567),r=a(95856),o=a(72539),i=a(92138),l=a(74251),d=a(92488),c=a(61676),u=a(14755),h=a(50926),m=a(15584),g=a(55677),p=a(81364);let f=e=>{if(!(null==e?void 0:e.is_final)||!e.debug_info)return{};let t={};try{t=JSON.parse(e.debug_info)}catch(e){}return t};var b=a(25237),x=a.n(b),y=a(2784),v=a(21236),w=a(55264);let P=x()(()=>a.e(8047).then(a.t.bind(a,48047,23)),{loadableGenerated:{webpack:()=>[48047]},ssr:!1});function A(e){return(0,m.BF)(d.AR)?(0,s.jsx)(j,{...e}):null}function k(e){let{label:t,field:a,slice:n}=e;return(0,s.jsxs)("p",{title:a,className:"cursor-copy hover:text-ring p-1 font-mono text-sm",onClick:()=>{v.iN.messageCopied({referrer:"CandidateDebugInfo"}),w.Wj.copyTextToClipboard(a)},children:[t,": ",n?a.slice(0,n):a]})}function j(e){let{candidate:t,turn:a}=e,[n,r]=(0,y.useState)(""),o=(0,y.useMemo)(()=>f(t),[t]),i=Object.keys(o).length,l=function e(t,a){let s;if(Object.keys(a).forEach(e=>{e.includes(t)&&void 0===s&&(s={[e]:a[e]})}),void 0!==s)return s;for(let n in a)if(a[n]&&"object"==typeof a[n]&&void 0!==(s=e(t,a[n])))return{[t]:s};return s}(n,o);return l&&n&&(o=l),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"rounded-spacing-xxs overflow-hidden bg-black [&>*:nth-child(odd)]:bg-surface-elevation-1 [&>*:nth-child(even)]:bg-surface-elevation-3",children:[(0,s.jsx)(k,{label:"create_time",field:t.create_time}),(0,s.jsx)(k,{label:"turn_id",field:a.turn_key.turn_id,slice:8}),(0,s.jsx)(k,{label:"primary_candidate_id",field:a.primary_candidate_id,slice:8}),(0,s.jsx)(k,{label:"candidate_id",field:t.candidate_id,slice:8}),!!a.isLastAiMessage&&(0,s.jsx)(k,{label:"isLastAiMessage",field:a.isLastAiMessage?"true":"false",slice:8}),!!a.isLastUserMessage&&(0,s.jsx)(k,{label:"isLastUserMessage",field:a.isLastUserMessage?"true":"false",slice:8}),!!a.isGreetingMessage&&(0,s.jsx)(k,{label:"greeting_mesage",field:a.isGreetingMessage?"true":"false",slice:8}),!!t.base_candidate_id&&(0,s.jsx)(k,{label:"base_candidate_id",field:t.base_candidate_id,slice:8})]}),i>0&&(0,s.jsxs)("div",{className:"flex flex-col gap-2 p-2",children:[(0,s.jsx)(p.I,{value:n,onChange:e=>r(e.target.value),placeholder:"debug filter key"}),(0,s.jsx)(P,{theme:"ocean",name:null,src:o,displayDataTypes:!1,shouldCollapse:()=>!0,collapseStringsAfterLength:50,iconStyle:"circle"})]})]})}var N=a(92599);function _(){return(0,s.jsx)("div",{className:"ticontainer",children:(0,s.jsxs)("div",{className:"tiblock",children:[(0,s.jsx)("div",{className:"tidot"}),(0,s.jsx)("div",{className:"tidot"}),(0,s.jsx)("div",{className:"tidot"})]})})}var C=a(50413),H=a(52779);function S(e){let{text:t,animate:a,chunkSize:n=2,className:r,useMarkdown:o,onAnimationEnd:i,onAnimationUpdate:l,animationSpeed:d=33,textColorOverride:c}=e,u=(0,y.useRef)(a?"":null!=t?t:""),h=(0,y.useRef)(null),[,m]=(0,y.useState)(0),g=(0,y.useRef)(0),p=(0,y.useRef)();return((0,y.useEffect)(()=>(clearInterval(p.current),p.current=setInterval(()=>{if(t&&u.current.length<t.length){let e=t.slice(u.current.length,u.current.length+n);u.current+=e,g.current+=1,m(g.current),null==l||l()}t&&u.current.length>=t.length&&(clearInterval(p.current),m(g.current),null==i||i())},d),()=>{clearInterval(p.current)}),[d,n,t,i,l]),o)?(0,s.jsx)(H.U,{"sentry-block":!0,textStyle:{...c&&{color:c}},children:u.current}):(0,s.jsx)("p",{ref:h,className:r,style:{...c&&{color:c}},children:u.current})}let I=(0,y.memo)(e=>{let{text:t,candidate:a,animate:n,onAnimationUpdate:r,onAnimationEnd:o,supportsThrottledAnimation:l,textColorOverride:d}=e,{chunkSize:c,animationSpeed:u,setIsActivelyAnimating:h}=(0,i.f_)(),m=(0,y.useCallback)(()=>{h(l),null==r||r()},[r,h,l]),g=(0,y.useCallback)(()=>{h(!1),null==o||o()},[o,h]);return((0,y.useEffect)(()=>()=>{h(!1)},[h]),n)?(0,s.jsx)(S,{text:t,animate:!a.is_final,useMarkdown:!0,chunkSize:c,animationSpeed:u,onAnimationUpdate:m,onAnimationEnd:g,textColorOverride:d},a.candidate_id):(0,s.jsx)(H.U,{"sentry-block":!0,textStyle:{...d&&{color:d}},children:null!=t?t:""})},(e,t)=>e.text===t.text&&e.candidate===t.candidate&&e.animate===t.animate&&e.onAnimationUpdate===t.onAnimationUpdate&&e.onAnimationEnd===t.onAnimationEnd&&e.supportsThrottledAnimation===t.supportsThrottledAnimation&&e.textColorOverride===t.textColorOverride);I.displayName="ChatCandidateText";var q=a(66582),D=a(10386),E=a(93326),W=a(59829);function G(){let{t:e}=(0,D.$G)(),[t,a]=(0,y.useState)(!1);return(0,s.jsxs)("div",{className:"bg-opacity/30 mt-4 flex flex-col items-center gap-5 rounded-md border-2 border-error p-4 text-center",children:[(0,s.jsx)(W.fxy,{size:48}),e("Chat.Filter.sometimes-the-ai-generates-a-reply-that-doesnt-meet-our-guidelines"),(0,s.jsx)("p",{className:"text-sm",children:e("Chat.Filter.you-can-continue-the-conversation-or-generate-a-new-response-by-swiping")}),(0,s.jsx)("div",{children:(0,s.jsx)(E.zx,{isDisabled:t,variant:t?"ghost":"primary",color:t?"primary":"secondary",onPress:()=>{v.iN.messageFilteredAction({referrer:"FilteredMessage",type:"report"}),a(!0)},children:e(t?"Chat.Filter.reported":"Chat.report")})})]})}function M(e){let t,{turn:a,candidate:n,animate:r,onAnimationUpdate:o,onAnimationEnd:l,supportsThrottledAnimation:d}=e,{t:u}=(0,D.$G)(),m=a.is_pinned,g=!!n.base_candidate_id,{isDefaultChatStyle:p}=(0,i.ax)(),{userTextColorOverride:f,characterTextColorOverride:b}=(0,i.vX)(!a.author.is_human&&g);return(p&&(t=a.author.is_human?f:b),(0,C.Gd)(a,n))?(0,s.jsx)("div",{className:"px-4 mt-1",children:(0,s.jsx)(_,{})}):(0,s.jsxs)("div",{className:(0,c.cn)("font-display font-light",{"swiper-no-swiping":!q.tq}),children:[n.candidate_id===h.CX?(0,s.jsx)(z,{}):(0,s.jsx)(I,{text:n.raw_content,candidate:n,animate:r,onAnimationUpdate:o,onAnimationEnd:l,supportsThrottledAnimation:d,textColorOverride:p?t:void 0},n.candidate_id),(0,s.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[!!m&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.shA,{height:"0.75em",style:{rotate:"-30deg"},color:"var(--blue)"}),(0,s.jsx)("p",{className:"text-sm text-blue",children:u("Chat.pinned")})]}),!!m&&!!g&&(0,s.jsx)("p",{className:"text-sm text-blue",children:"•"}),!!g&&(0,s.jsx)("p",{className:"text-sm text-blue",title:u("Chat.tooltip-message-edited-by-user"),children:u("Chat.edited")})]}),!!n.safety_truncated&&(0,s.jsx)(G,{}),(0,s.jsx)(A,{candidate:n,turn:a})]})}let z=()=>{let{t:e}=(0,D.$G)();return(0,s.jsxs)("div",{className:"flex flex-row gap-6 items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("div",{className:"text-lg-chat text-primaryContainer-foreground",children:e("Monetization.swipeexpansion-upsell-title")}),(0,s.jsx)("div",{className:"text-lg-medium text-primaryContainer-foreground",children:e("Monetization.swipeexpansion-upsell-description")})]}),(0,s.jsx)(g.s,{size:"lg",enableClick:!0,referrer:"ChatSwipeLimit"})]})};var T=a(27714),O=a(57352),B=a(96577),R=a.n(B),F=a(2133),L=a(85256);function U(e){let{src:t,retryCount:a=10,style:n,className:r}=e,{t:o}=(0,D.$G)(),[i,l]=(0,y.useState)(!1),[d,u]=(0,y.useState)(0),[h,m]=(0,y.useState)(!1);return((0,y.useEffect)(()=>{let e=new Image;return e.src=t,e.onload=()=>l(!0),e.onerror=()=>{d<a?setTimeout(()=>u(d+1),1e3+250*d):m(!0)},()=>{e.onload=null,e.onerror=null}},[d,t,a]),(0,y.useEffect)(()=>{u(0),m(!1),l(!1)},[t]),h)?(0,s.jsxs)("div",{className:(0,c.cn)("flex flex-col items-center justify-center rounded-2xl text-center align-middle",r),style:{width:200,height:200,...n},children:[(0,s.jsx)(L._HA,{size:64,className:"fill-error"}),(0,s.jsx)("p",{className:"p-4 text-sm",children:o("Chat.Image.something-went-wrong-loading-this-image")})]}):i?(0,s.jsx)(T.a2,{children:(0,s.jsx)(R(),{style:{...n},src:t,alt:"Loaded content",className:(0,c.cn)("rounded-2xl amp-block",r),width:200,height:200})}):(0,s.jsx)(T.a2,{children:(0,s.jsx)("div",{style:{width:200,height:200,...n},className:(0,c.cn)("flex flex-col items-center justify-center rounded-2xl bg-accent text-center align-middle",r),children:(0,s.jsx)(O.E.div,{style:{transformOrigin:"50% 57%"},animate:{rotate:[0,360]},transition:{duration:1,ease:"easeInOut",repeat:1/0},children:(0,s.jsx)(F.I0U,{size:32})})})})}var Q=a(73910);let K=e=>{let{date:t}=e;return(0,Q.Q)(t)};var V=a(9010),$=a(57960),Y=a(79444),J=a(67378),Z=a(96370);let X=(e,t,a)=>{let{voiceId:s,abortCharacterSpeech:n,hasVoice:r,voiceQuery:o}=(0,J.AW)(),{getCandidatePlaybackStatus:i,playVoiceMemo:l,stopVoiceMemo:c}=(0,Z.qt)(),u=(0,m.BF)(d.LT),h=(0,m.BF)(d.AK);return{canPlayMemo:!u,thisMemoPlaybackStatus:i(a),play:(0,y.useCallback)(()=>{if(!r){d.UK.value=!0;return}h===$.PO.Playing?(c(),setTimeout(()=>l({chatId:e,turnId:t,candidateId:a,voiceId:s,voiceQuery:o}),250)):l({chatId:e,turnId:t,candidateId:a,voiceId:s,voiceQuery:o})},[a,e,h,r,l,c,t,s,o]),stopVoiceMemo:c,abortCharacterSpeech:n,isCharacterSpeaking:u}};function ee(e){let{play:t}=e,{t:a}=(0,D.$G)();return(0,s.jsx)(E.zx,{"aria-label":a("Chat.play-voice"),variant:"ghost",isIconOnly:!0,disableAnimation:!0,disableRipple:!0,onPress:t,className:"size-4 p-0 hover:bg-transparent hover:brightness-125",children:(0,s.jsx)(N.o1U,{className:"size-4 text-voice-blue"})})}function et(e){let{stopVoiceMemo:t}=e,{t:a}=(0,D.$G)();return(0,s.jsx)(E.zx,{"aria-label":a("Chat.stop-voice"),variant:"ghost",isIconOnly:!0,disableAnimation:!0,disableRipple:!0,onPress:t,className:"size-4 p-0 hover:bg-transparent hover:brightness-125",children:(0,s.jsx)(Y.S,{numDots:5})})}function ea(e){let{abortCharacterSpeech:t}=e,{t:a}=(0,D.$G)();return(0,s.jsx)(E.zx,{"aria-label":a("Chat.abort-speech"),variant:"ghost",isIconOnly:!0,disableAnimation:!0,disableRipple:!0,onPress:t,className:"size-4 p-0 hover:bg-transparent hover:brightness-125",children:(0,s.jsx)(Y.S,{numDots:5})})}function es(e){let{chatId:t,turnId:a,candidateId:n,messageFinalized:r,showWaveform:o}=e,{canPlayMemo:i,thisMemoPlaybackStatus:l,play:d,stopVoiceMemo:u,abortCharacterSpeech:h,isCharacterSpeaking:m}=X(t,a,n);(0,y.useEffect)(()=>()=>{l===$.PO.Playing&&u()},[l,u]);let g=!!m&&!i&&!!o;return(0,s.jsxs)("div",{className:"flex justify-center items-center h-3 ml-1",children:[!!(i&&r)&&(0,s.jsxs)("div",{className:(0,c.cn)("opacity-0 transition-all group-hover:opacity-100",{"opacity-100":l===$.PO.Playing||o}),children:[l===$.PO.NotPlaying&&(0,s.jsx)(ee,{play:d}),l===$.PO.Loading&&(0,s.jsx)("div",{className:"size-10 flex justify-center items-center",children:(0,s.jsx)(V.$,{size:12})}),l===$.PO.Playing&&(0,s.jsx)(et,{stopVoiceMemo:u})]}),!!g&&(0,s.jsx)(ea,{abortCharacterSpeech:h})]})}var en=a(47022);function er(e){let{author:t,candidate:a,showTimeCreated:n,turn:r,showWaveform:o}=e,{isRoom:i}=(0,en.m)();return(0,s.jsxs)("div",{className:"mx-2 flex flex-row items-center gap-2 font-light",children:[(0,s.jsx)("div",{className:"text-sm",children:t.name}),!t.is_human&&(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"rounded-2xl text-sm bg-secondary px-2 font-light h-fit",children:"c.ai"}),!i&&(0,s.jsx)(es,{showWaveform:o,chatId:r.turn_key.chat_id,turnId:r.turn_key.turn_id,candidateId:a.candidate_id,messageFinalized:!!a.is_final})]}),!!n&&!!a.create_time&&(0,s.jsx)("div",{className:"text-sm text-muted-foreground",title:new Date(a.create_time).toLocaleString(),children:(0,s.jsx)(K,{date:a.create_time})})]})}var eo=a(55174);function ei(e){var t,a,g,p;let f,{turn:b,candidate:x,includeWaveForm:y,animate:v,className:w,onAnimationUpdate:P,onAnimationEnd:A,supportsThrottledAnimation:k}=e,j=(0,l.Dv)(),{isDefaultChatStyle:N,isDenseChatStyle:_,leftAlign:C,isChatClassicStyle:H}=(0,i.ax)(),S=!!x.base_candidate_id,{config:I}=(0,n.EY)(n.F5.EditedMessageV2),q=!b.author.is_human&&S&&"border"===I.variant,{userChatColorOverride:D,characterChatColorOverride:E}=(0,i.vX)(!b.author.is_human&&S),W=(0,m.BF)(d.TU),G=b.author.is_human&&!C,z="";if(N&&(b.author.is_human?(z="bg-surface-elevation-3 opacity-90",f=D):x.candidate_id===h.CX?z="bg-primaryContainer":(z="bg-surface-elevation-2 opacity-85",f=E)),b.author.is_human&&(null===(t=x.raw_content)||void 0===t?void 0:t.startsWith(u.U)))return null;let T=null===(a=x.attachments)||void 0===a?void 0:a.find(e=>"TYPE_IMAGE"===e.type),O=null!==(p=null!==(g=null==T?void 0:T.localOverrideUrl)&&void 0!==g?g:null==T?void 0:T.url)&&void 0!==p?p:x.tti_image_rel_path;return(0,s.jsxs)("div",{className:(0,c.cn)("m-0 flex flex-row items-start gap-2 justify-start",G?"mr-0 md:mr-6 flex-row-reverse":"ml-0 md:ml-6",w),children:[(0,s.jsx)("div",{className:"mt-0 hidden md:flex flex-col gap-3 items-center",children:b.author.is_human?(0,s.jsx)(o.a,{name:b.author.name,size:24,src:b.author.avatar_url}):(0,s.jsx)(r.B7,{name:b.author.name,size:24,src:b.author.avatar_url})}),(0,s.jsxs)("div",{className:(0,c.cn)("flex flex-col gap-1",G?"items-end sm:-mr-2":"items-start sm:-ml-2",{"w-full":d.TU}),children:[(0,s.jsx)(er,{author:b.author,candidate:x,showTimeCreated:!N,turn:b,showWaveform:y}),!!O&&(0,s.jsx)(U,{src:O,retryCount:10,className:(0,c.cn)({"rounded-br-spacing-xs":G,"rounded-bl-spacing-xs":!G})}),W===b.turn_key.turn_id?(0,s.jsx)(eo.u,{candidate:x,turn:b}):(0,s.jsx)("div",{"data-testid":"STATE_INFLIGHT"===b.state?"streaming-message":"completed-message",style:{minWidth:j?void 0:60,...f&&{background:f}},className:(0,c.cn)("mt-1 max-w-xl rounded-2xl px-3 min-h-12 flex justify-center",{"py-3":N,"pb-4":H,"max-w-4xl":_,"border-dashed border-2 border-blue border-opacity-35":q,hidden:!x.raw_content&&O,"rounded-tr-spacing-xs":O&&G,"rounded-bl-spacing-xs":O&&!G,"cursor-pointer":x.candidate_id===h.CX},z),onClick:()=>{x.candidate_id===h.CX&&(d.Um.value={referrer:"Chat",trigger:"SwipeLimit"})},children:(0,s.jsx)(M,{candidate:x,turn:b,animate:v,onAnimationUpdate:P,onAnimationEnd:A,supportsThrottledAnimation:k},x.candidate_id)})]})]})}},9306:function(e,t,a){a.d(t,{U:function(){return r}});var s=a(52322),n=a(34581);function r(){return(0,s.jsxs)("div",{className:"my-2 flex h-10 gap-1 p-2 pl-4 items-start",children:[(0,s.jsx)(n.O,{className:"mr-1 h-6 w-6 rounded-sm"}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(n.O,{className:"w-32 h-5"}),(0,s.jsx)(n.O,{className:"w-64 h-12 rounded-spacing-s"})]})]})}},99673:function(e,t,a){a.d(t,{x:function(){return eD}});var s=a(52322),n=a(50567),r=a(92138),o=a(61676),i=a(68582),l=a(35740),d=a(93326),c=a(10386),u=a(76330),h=a(39300),m=a(27714);function g(e){let{index:t,filled:a,onPress:n,isDisabled:r}=e,{t:o}=(0,c.$G)();return(0,s.jsx)(d.zx,{"aria-label":o("Common.rate",{number:t+1}),isIconOnly:!0,isDisabled:r,onPress:n,variant:"ghost",className:"w-6 h-6 min-w-unit-0 p-1 data-[hover=true]:bg-transparent",children:(0,s.jsx)(m.a2,{children:a?(0,s.jsx)(h.QJe,{size:16}):(0,s.jsx)(u.jJN,{color:"var(--icon-secondary)",size:16})},"star".concat(a))})}var p=a(21236),f=a(20808),b=a(6669),x=a(3927),y=a(46272),v=a(80729),w=a(92014),P=a(14031),A=a(92488),k=a(38694),j=a(2784),N=a(45736);let _={boring:"feedback-utils.boring",inaccurate:"feedback-utils.not-true",repetitive:"feedback-utils.repetitive",out_of_character:"feedback-utils.out-of-character",bad_memory:"feedback-utils.bad-memory",funny:"feedback-utils.funny",interesting:"feedback-utils.interesting",long:"feedback-utils.too-long",short:"feedback-utils.too-short",helpful:"feedback-utils.helpful",good_memory:"feedback-utils.good-memory",ends_chat_early:"feedback-utils.ends-chat-early",voice_wrong_voice:"feedback-utils.voice-wrong-voice",voice_low_quality:"feedback-utils.voice-low-quality",voice_incorrect_pronounciation:"feedback-utils.voice-incorrect-pronounciation",voice_repeated_words:"feedback-utils.voice-repeated-words",voice_missing_words:"feedback-utils.voice-missing-words",voice_too_fast:"feedback-utils.voice-too-fast",voice_too_slow:"feedback-utils.voice-too-slow",memory_conversation_details:"feedback-utils.swipe_memory_conversation_details",memory_character_details:"feedback-utils.swipe_memory_character_details",memory_persona_details:"feedback-utils.swipe_memory_persona_details",memory_out_of_character:"feedback-utils.out-of-character",no_issues:"feedback-utils.no_issues",too_flirty:"feedback-utils.too-flirty"},C=["funny","interesting","helpful","good_memory"],H=["boring","inaccurate","repetitive","bad_memory","long","short","ends_chat_early","too_flirty"],S=["voice_wrong_voice","voice_low_quality","voice_incorrect_pronounciation","voice_repeated_words","voice_missing_words","voice_too_fast","voice_too_slow"],I=["memory_conversation_details","memory_character_details","memory_persona_details","memory_out_of_character"],q="star",D="custom";function E(e){let{id:t,disabled:a,label:n,onClick:r,isSelected:o}=e,{t:i}=(0,c.$G)();return(0,s.jsxs)(P.G,{className:"flex justify-start text-start h-7 md:h-10 bg-transparent w-2/5 gap-3 data-[state=on]:bg-transparent",onClick:r,disabled:a,value:n,children:[(0,s.jsx)(N.X,{id:t,className:o?void 0:"opacity-50",color:o?void 0:"var(--muted-foreground)",checked:o}),i(_[n])]})}function W(e){let{labels:t,selectedPills:a,togglePillSelection:n,disabled:r}=e;return(0,s.jsx)(P.t,{type:"multiple",className:"flex flex-wrap text-foreground text-sm md:text-md align-top justify-start w-full",children:t.map(e=>(0,s.jsx)(E,{label:e,isSelected:a.includes(e),onClick:()=>n(e),disabled:r},e))})}function G(e){let{selectedPills:t,customFeedback:a,togglePillSelection:n,saveCustomFeedback:r,rating:o,isOpen:i,isReadOnly:l}=e,{t:u}=(0,c.$G)(),[h,m]=(0,j.useState)(a),[g,P]=(0,j.useState)(!1),N=A.sF.value,[_,I]=(0,j.useState)(N?"voice":"text");(0,j.useEffect)(()=>m(a),[a]),(0,j.useEffect)(()=>{g&&p.iN.contentViewed({referrer:"CandidateFeedbackDialogContent"})},[g]);let q=(0,b.wz)(f.b.SmartCustomFeedbackLabelOrdering)&&o>=3;return(0,s.jsxs)(x.Vq,{open:null!=i?i:g,onOpenChange:P,analyticsProps:{referrer:"Chat",type:"CandidateFeedbackDialog"},children:[(0,s.jsx)(x.hg,{asChild:!0,children:(0,s.jsx)("div",{className:"text-sm bg-surface-elevation-3 rounded-full px-2 mt-1 py-1 hover:bg-accent cursor-pointer",onClick:()=>P(!0),children:u("Feedback.tell-us-more")})}),(0,s.jsxs)(x.cZ,{className:"w-full max-w-xl",children:[(0,s.jsx)(x.fK,{children:(0,s.jsx)(x.$N,{children:u("Feedback.feedback")})}),(0,s.jsxs)(x.Be,{className:"gap-2 flex flex-col justify-center",children:[(0,s.jsxs)(v.mQ,{value:_,tabIndex:-1,onValueChange:e=>I(e),children:[!!N&&(0,s.jsxs)(v.dr,{className:"px-4",children:[(0,s.jsx)(v.SP,{value:"voice",children:u("Feedback.voice-feedback")}),(0,s.jsx)(v.SP,{value:"text",children:u("Feedback.text-feedback")})]}),(0,s.jsx)(v.nU,{value:"voice",children:(0,s.jsx)(W,{labels:S,selectedPills:t,togglePillSelection:n,disabled:l})}),(0,s.jsxs)(v.nU,{value:"text",children:[(0,s.jsx)(W,{labels:q?C:H,selectedPills:t,togglePillSelection:n,disabled:l}),(0,s.jsx)(y.Z,{className:"my-3"}),(0,s.jsx)(W,{labels:q?H:C,selectedPills:t,togglePillSelection:n,disabled:l})]})]}),(0,s.jsx)(w.g,{className:"text-md items-center bg-transparent text-foreground mt-1",onChange:e=>{m(e.target.value)},value:h,disabled:l,autoFocus:!1,maxLength:k.zn.CUSTOM_FEEDBACK_MAX_LEN,label:u("Feedback.anything-else"),placeholder:u("Common.optional")})]}),(0,s.jsxs)(x.cN,{className:"sm:justify-end",children:[(0,s.jsx)(x.GG,{asChild:!0,children:(0,s.jsx)(d.zx,{type:"button",onPress:()=>{m(a),P(!1)},variant:"ghost",children:u("Common.cancel")})}),(0,s.jsx)(x.GG,{asChild:!0,children:(0,s.jsx)(d.zx,{type:"button",onPress:()=>{r(h),P(!1)},isDisabled:l||a===h,children:u("Feedback.save-details")})})]})]})]})}var M=a(48364),z=a(91503);let T=(e,t,a)=>{var s,n;let{addAnnotation:r,removeAnnotation:o,updateAnnotation:i,annotationsByType:l}=(0,z.O2)(e,t),[d,c]=(0,j.useState)(-1);(0,j.useEffect)(()=>{var e,t;let a=Number(null!==(t=null===(e=l[q])||void 0===e?void 0:e.annotation_value)&&void 0!==t?t:-1);c(Number.isNaN(a)||a>4||a<-1?-1:a)},[l]);let u=(0,j.useCallback)(e=>{let t=e+1;if(c(t),d===t){o(q);return}i({annotation_type:q,annotation_value:t}),a||p.iN.elementClicked({referrer:"CandidateFeedbackComponent",type:"star_rating"})},[o,i,d,a]),[h,m]=(0,j.useState)([]);(0,j.useEffect)(()=>{m([...C,...H,...S].filter(e=>!!l[e]))},[l]);let g=(0,j.useCallback)(e=>{if(h.includes(e)){m(t=>t.filter(t=>t!==e)),o(e);return}m(t=>[...t,e]),r({annotation_type:e}),a||p.iN.elementClicked({referrer:"CandidateFeedbackComponent",type:"select_pill",rating:d,pill_name:e})},[d,r,o,h,a]);return{rating:d,toggleRating:u,selectedPills:h,togglePill:g,customFeedback:null!==(n=null===(s=l[D])||void 0===s?void 0:s.annotation_raw_content)&&void 0!==n?n:"",updateCustomFeedback:(0,j.useCallback)(e=>{try{e?i({annotation_type:D,annotation_raw_content:e}):o(D),a||p.iN.elementClicked({referrer:"CandidateFeedbackComponent",type:"custom_feedback"})}catch(e){(0,M.H)("Failed to leave custom feedback",{error:e})}},[i,o,a])}};var O=a(83614),B=a(27909);let R=e=>{let{rating:t,onRatingPress:a,isReadOnly:r}=e;if((0,O.useGateValue)(n.F5.ThumbFeedback)){let e;return 1===t?e="down":4===t&&(e="up"),(0,s.jsx)(B.p,{selected:e,onThumbDown:()=>a(0),onThumbUp:()=>a(3)})}return(0,s.jsx)(d.hE,{isIconOnly:!0,className:"h-6",children:[void 0,void 0,void 0,void 0].map((e,n)=>(0,s.jsx)(g,{index:n,filled:n<t,onPress:()=>a(n),isDisabled:r},n))})};function F(e){let{turnKey:t,candidateId:a,disableAmpli:n,isReadOnly:r}=e,{rating:o,toggleRating:i,selectedPills:l,togglePill:d,customFeedback:c,updateCustomFeedback:u}=T(t,a,n),h=-1!==o;return(0,s.jsxs)("div",{className:"flex flex-1 justify-start items-center gap-2 ",children:[(0,s.jsx)(R,{onRatingPress:i,rating:o,isReadOnly:r}),!!h&&(0,s.jsx)(G,{customFeedback:c,saveCustomFeedback:u,selectedPills:l,togglePillSelection:d,rating:o,isReadOnly:r})]})}var L=a(92599),U=a(15030),Q=a(43145);function K(e){let{listIndex:t,listCount:a,swipe:n,forceDisable:r,maxTurns:i,isGreeting:l}=e,{t:u}=(0,c.$G)(),[h]=(0,j.useState)(!!(0,Q.tv)(U.hl.Keys.DynamicGreetingUsed));return t>=i-1||a===t+1?(0,s.jsx)("div",{className:"w-2"}):(0,s.jsxs)(d.zx,{"aria-label":u("Common.next"),autoFocus:!1,isDisabled:r,onPress:()=>{l&&!h&&(0,Q.co)(U.hl.Keys.DynamicGreetingUsed,!0),n(!1)},className:(0,o.cn)("h-8 w-8 min-w-unit-2 data-[hover=true]:bg-transparent",2===a?"h-8 w-8":"h-6 w-6 text-muted-foreground"),isIconOnly:!0,variant:"ghost",children:[2===a&&(0,s.jsx)(m.a2,{children:l&&!h?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"relative z-20",children:(0,s.jsx)(L.Vk2,{height:"18px",width:"18px"})}),(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10",children:(0,s.jsx)(L.LYK,{className:"text-blue",width:"38px",height:"38px"})})]}):(0,s.jsx)(L.Vk2,{height:"18px",width:"18px"})}),a>2&&(0,s.jsx)(m.a2,{children:(0,s.jsx)(L.VQN,{height:"16px",width:"16px"})})]})}function V(e){let{listIndex:t,swipe:a,maxTurns:n}=e,{t:r}=(0,c.$G)(),o=0===t;return o?null:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(d.zx,{"aria-label":r("Common.back"),autoFocus:!1,isDisabled:o,variant:"ghost",isIconOnly:!0,className:"h-6 w-6 min-w-unit-2 p-1 data-[hover=true]:bg-transparent text-muted-foreground ",onPress:()=>a(!0),children:(0,s.jsx)(L.bfG,{height:"16px",width:"16px"})}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground font-extralight",children:[Math.min(t+1,n)," / ",n]})]})}var $=a(47022),Y=a(25215);let J=e=>{let{turn:t,candidate:a}=e,{publish:n}=(0,$.m)(),r=!t.author.is_human&&!!a.is_final&&!!a.raw_content,{isPlusUser:o}=(0,l.a)(),i=o?Y.kA:Y.bR;return(0,s.jsxs)("div",{className:"flex md:ml-14 absolute -bottom-5 items-center",children:[(0,s.jsx)(K,{maxTurns:i,swipe:()=>{n(t.turn_key.chat_id,{type:"generate_room_candidate",characterId:t.author.author_id,turnId:t.turn_key.turn_id})},listIndex:0,listCount:2,isGreeting:!1}),!!r&&(0,s.jsx)(F,{turnKey:t.turn_key,candidateId:a.candidate_id})]})};var Z=a(13160),X=a(50926),ee=a(97679),et=a(7702),ea=a(77388),es=a(67378),en=a(23018);let er=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(a,Math.min(e,t))};var eo=a(41591),ei=a(15584),el=a(9010),ed=a(55264);let ec=e=>{var t,a,n;let{turn:r}=e,[o,i]=(0,j.useState)(!1),{addAnnotation:u}=(0,z.O2)(r.turn_key,null!==(n=null===(t=r.candidates.at(-1))||void 0===t?void 0:t.candidate_id)&&void 0!==n?n:"N/A"),{t:h}=(0,c.$G)(),[m,g]=(0,j.useState)(!1),{user:f}=(0,l.a)(),[b]=(0,j.useState)(()=>Date.now()),x=(0,j.useMemo)(()=>{var e;return(null==f?void 0:null===(e=f.user)||void 0===e?void 0:e.id)||b},[null==f?void 0:null===(a=f.user)||void 0===a?void 0:a.id,b]),v=(0,j.useMemo)(()=>m?(0,ed.Sy)(I,x):(0,ed.Sy)(H,x),[m,x]),w=m?h("feedback-utils.memory-issues"):h("feedback-utils.why-the-swipe");(0,j.useEffect)(()=>{p.iN.contentViewed({referrer:"CandidateSwipeAnnotation"})},[]);let P=e=>()=>{"bad_memory"===e?g(!0):(p.iN.elementClicked({referrer:"CandidateSwipeAnnotation",type:e}),u({annotation_type:"swipe_".concat(e),annotation_value:1}),en.N.fire(),i(!0))};return(0,s.jsxs)("div",{className:"w-full mr-auto md:ml-[48px] ml-auto max-w-xl border-2 border-surface-elevation-3 p-3 gap-2 rounded-spacing-s bg-background flex flex-col",children:[w,(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:v.map(e=>(0,s.jsx)(d.zx,{variant:"outline",className:"bg-surface-elevation-1",onPress:P(e),isDisabled:o,children:h(_[e])},e))}),!m&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Z,{}),(0,s.jsx)(d.zx,{isDisabled:o,variant:"ghost",isLoading:o,className:"bg-surface-elevation-1 w-fit self-end",onPress:P("no_issues"),children:h("feedback-utils.no_issues")})]}),!!o&&!!m&&(0,s.jsx)(el.$,{size:18,className:"self-center"})]})},eu=[ee.gI],eh={prev:{opacity:0,translate:[0,0,-400]},next:{translate:["100%",0,0]}};function em(e){var t;let{turn:a,primaryCandidateIndex:o,supportsThrottledAnimation:i}=e,d=er(o||0,a.candidates.length),{publish:c,updatePrimaryCandidateMap:u,subscribeChatEvents:h}=(0,$.m)(),[m,g]=(0,j.useState)(d),p=(0,j.useRef)(null),{isPlusUser:f}=(0,l.a)(),b=(0,O.useGateValue)(n.F5.CaiPlusSwipeExpansion),x=!f&&b,y=f&&b?Y.kA:Y.bR,v=(0,r.yZ)(a.candidates[m])||m>=y;ep(p,v);let{isVoiceEnabled:w,expectCharacterSpeech:P,abortCharacterSpeech:k}=(0,es.AW)(),N=(0,ei.BF)(A.LT),[_,C]=(0,j.useState)(!1),H=(0,j.useRef)(null===(t=a.candidates[a.candidates.length-1])||void 0===t?void 0:t.candidate_id),{showSwipeFeedback:S,increaseSwipeFeedbackProbability:I}=(0,ea.V)();en.N.useListen(()=>{c(a.author.author_id,{type:"generate_candidate",ttsEnabled:w}),C(!0),P(),I()},[a]),(0,j.useEffect)(()=>h(X.qN.message_edited,(e,t)=>{let{turnId:s,editedIndex:n}=t;if(a.turn_key.turn_id&&a.turn_key.turn_id===s&&n>-1){var r;null===(r=p.current)||void 0===r||r.swiper.slideTo(n)}}),[h,a.isLastAiMessage,a.turn_key.turn_id]);let q=(0,j.useCallback)(()=>{var e;null===(e=p.current)||void 0===e||e.swiper.update()},[]);(0,j.useEffect)(()=>{var e;a.candidates.length>=0&&(null===(e=a.candidates[a.candidates.length-1])||void 0===e?void 0:e.candidate_id)!==H.current&&(H.current=a.candidates[a.candidates.length-1].candidate_id,C(!1))},[a.candidates.length,a.candidates]);let D=a.candidates.slice(0,y),E=D.some(e=>!e.is_final);x&&D.length>=y&&D.push({candidate_id:X.CX,create_time:"",raw_content:"",fresh:!1,is_final:!0}),!E&&D.length<y&&D.push({candidate_id:X.gn,create_time:"",raw_content:"",fresh:!1,is_final:!0});let W=(0,j.useCallback)(e=>{(0,eo.Og)(),g(e.snapIndex),S||u(a.author.author_id,a.turn_key.turn_id,e.snapIndex),!(a.candidates.length>=y)&&(e.snapIndex!==a.candidates.length||E||_||(N&&k(),I()||(a.isGreetingMessage?c(a.author.author_id,{type:"generate_greeting",ttsEnabled:w,turn_key:a.turn_key}):c(a.author.author_id,{type:"generate_candidate",ttsEnabled:w}),C(!0),P())))},[S,a.candidates.length,a.author.author_id,a.turn_key,a.isGreetingMessage,y,E,_,u,N,I,k,c,w,P]),G=(0,j.useCallback)(e=>{var t,a,s;e?null===(t=p.current)||void 0===t||t.swiper.slidePrev():v||null===(s=p.current)||void 0===s||null===(a=s.swiper)||void 0===a||a.slideNext()},[v]),M=(0,j.useMemo)(()=>D.map((e,t)=>{let n=!a.author.is_human&&m===t&&!!e.is_final&&!!e.raw_content;return(0,s.jsx)(et.o5,{children:(0,s.jsx)(eg,{idx:t,showFeedback:n,listCount:D.length,swipe:G,candidate:e,turn:a,onHeightChange:q,supportsThrottledAnimation:i,isGreeting:!!a.isGreetingMessage})},e.candidate_id)}),[D,m,q,G,i,a]);return(null==a?void 0:a.candidates)&&0!==a.candidates.length?(0,s.jsx)("div",{className:"p-2 min-h-32",children:(0,s.jsx)(et.tq,{autoHeight:!0,className:"flex flex-1",initialSlide:d,onSlideChange:W,ref:p,effect:"creative",creativeEffect:eh,modules:eu,children:M})}):null}function eg(e){let{candidate:t,turn:a,onHeightChange:n,idx:r,showFeedback:o,listCount:i,swipe:l,supportsThrottledAnimation:d,isGreeting:c}=e,u=(0,j.useRef)(null),h=(0,j.useRef)(null),{showSwipeFeedback:m}=(0,ea.V)();(0,j.useEffect)(()=>{var e;return null===(e=h.current)||void 0===e||e.disconnect(),u.current&&(h.current=new ResizeObserver(e=>{e[0]&&n()}),h.current.observe(u.current)),()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.disconnect()}},[r,n]);let g=t.candidate_id===X.gn&&m&&!0;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{ref:u,children:[g?(0,s.jsx)(ec,{turn:a}):(0,s.jsx)(Z.f,{candidate:t,turn:a,includeWaveForm:!0,animate:!0,supportsThrottledAnimation:d}),(0,s.jsx)("div",{className:"h-8"})]}),(0,s.jsx)(ef,{candidate:t,turn:a,idx:r,showFeedback:!!o&&!g,listCount:i,swipe:l,isGreeting:c})]})}let ep=(e,t)=>{let a=(0,j.useCallback)(a=>{var s,n,r,o;let{activeElement:i}=document;if((null==i?void 0:i.tagName)!=="INPUT"&&(null==i?void 0:i.tagName)!=="TEXTAREA"||""===i.value)switch(a.key){case"ArrowLeft":null===(n=e.current)||void 0===n||null===(s=n.swiper)||void 0===s||s.slidePrev(),a.preventDefault();break;case"ArrowRight":t||(null===(o=e.current)||void 0===o||null===(r=o.swiper)||void 0===r||r.slideNext(),a.preventDefault())}},[e,t]);(0,j.useEffect)(()=>(window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}),[a])};function ef(e){let{candidate:t,turn:a,idx:o,showFeedback:i,listCount:d,swipe:c,isGreeting:u}=e,h=(0,r.yZ)(t),{isPlusUser:m}=(0,l.a)(),g=(0,O.useGateValue)(n.F5.CaiPlusSwipeExpansion),p=Y.bR;m&&g?p=Y.kA:g&&(p=Y.bR+1);let f=m&&g?Y.kA:Y.bR;return(0,s.jsxs)("div",{className:"flex md:ml-14 absolute -bottom-0 items-center",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(V,{swipe:c,listIndex:o,maxTurns:f}),(0,s.jsx)(K,{swipe:c,listIndex:o,listCount:d,forceDisable:h,maxTurns:p,isGreeting:u})]}),!!i&&(0,s.jsx)(F,{turnKey:a.turn_key,candidateId:t.candidate_id})]})}var eb=a(18363),ex=a(35981),ey=a(15212);let ev=()=>(0,ey.q)(!0);var ew=a(70393),eP=a(37940),eA=a(55174);function ek(e){let{handleCopyChat:t}=e,{t:a}=(0,c.$G)(),{availableModels:n}=(0,r.Ni)(),o=(0,j.useCallback)(e=>t(e?{preferred_model_type:e}:void 0),[t]);return(0,s.jsx)(d.zx,{variant:"ghost",className:"justify-between w-full rounded-spacing-s hover:bg-surface-elevation-2",onPress:()=>{n?A.Vr.value={status:"open",source:"copy-chat",onModelSelect:o}:t()},endContent:(0,s.jsx)(L.jUn,{className:"size-4"}),children:a("Chat.duplicate-conversation")},"copy-button")}function ej(e){let{text:t}=e,{t:a}=(0,c.$G)(),n=(0,j.useRef)(t);return(0,j.useEffect)(()=>{let e=function(){let e="";if(window&&window.getSelection){var t;e=null===(t=window.getSelection())||void 0===t?void 0:t.toString()}return e}();e&&(n.current=e)},[]),(0,s.jsxs)(d.zx,{variant:"ghost",className:"justify-between w-full rounded-spacing-s hover:bg-surface-elevation-2",onPress:()=>{var e;ed.Wj.copyTextToClipboard(null!==(e=n.current)&&void 0!==e?e:"",a("Common.message-copied-to-clipboard"),"ChatMessage")},children:[a("Common.copy")," ",(0,s.jsx)(L.TIy,{height:"1.25em"})]},"copy-button")}var eN=a(96344),e_=a(55274);function eC(e){let{turnKey:t,isCurPinned:a}=e,{t:n}=(0,c.$G)(),{publish:r}=(0,$.m)(),{character:o}=(0,e_.AU)(),{refetch:i}=(0,z.gL)(t.chat_id),l=(0,j.useCallback)(async()=>{if(!o)return;let e={type:"set_turn_pin",turnKey:t,isPinned:!a};p.iN.elementClicked({referrer:"PinMessageOption",...e}),r(o.external_id,e),await i()},[o,r,t,a,i]);return(0,s.jsx)(d.zx,{variant:"ghost",className:"justify-between w-full rounded-spacing-s hover:bg-surface-elevation-2",onPress:l,endContent:a?(0,s.jsx)(L.qQX,{height:"1.25em"}):(0,s.jsx)(L.shA,{height:"1.25em"}),children:n(a?"Chat.unpin-message":"Chat.pin-message")},"pin-button")}var eH=a(28573);let eS=e=>{var t;let{isRoom:a}=(0,$.m)(),{user:n}=(0,l.a)(),{listItemIndex:r,turn:o,candidate:i,isLastTurn:d,handleCopyChat:c}=e,u=!!(null==i?void 0:i.safety_truncated),h=!!o.is_pinned,m=(o.isLastAiMessage||o.isLastUserMessage)&&!h,g=ev()&&m&&!h&&!a&&!u,p=(!(null==o?void 0:o.isLastAiMessage)||h)&&!a&&!u,f=!d&&!a,b=!a,x=o.author.author_id===(null==n?void 0:null===(t=n.user)||void 0===t?void 0:t.id.toString());return(0,j.useMemo)(()=>{if(void 0===r||!i||!i.is_final)return[];let e=[{content:(0,s.jsx)(ej,{text:i.raw_content}),asChild:!1,key:"copy"},{content:(0,s.jsx)(eN.n,{listIndex:r}),asChild:!1,key:"delete-dialog"}];return b&&e.push({content:(0,s.jsx)(ek,{handleCopyChat:c}),asChild:!1,key:"duplicate"}),f&&e.push({content:(0,s.jsx)(eH.q,{listIndex:r}),asChild:!1,key:"rewind-dialog"}),g&&e.push({content:(0,s.jsx)(eA.K,{turn_id:o.turn_key.turn_id}),asChild:!1,key:"edit"}),p&&e.push({content:(0,s.jsx)(eC,{turnKey:o.turn_key,isCurPinned:h}),asChild:!1,key:"pin"}),x||e.push({content:(0,s.jsx)(eb.f,{showText:!0,variant:"ghost",report:{type:ew.C2.MESSAGE,turn:o,candidate:i},className:"justify-between w-full rounded-spacing-s hover:bg-surface-elevation-2"}),asChild:!1,key:"report"}),e},[r,i,b,f,g,p,x,c,o,h])};function eI(e){let{listItemIndex:t,turn:a,candidate:n,isLastTurn:i,characterId:l}=e,{t:u}=(0,c.$G)(),{isDefaultChatStyle:h}=(0,r.ax)(),m=(0,r.NS)({chatId:a.turn_key.chat_id,endTurnId:a.turn_key.turn_id,characterId:l}),g=eS({listItemIndex:t,turn:a,candidate:n,isLastTurn:i,characterId:l,handleCopyChat:m}),[p,f]=(0,j.useState)(!1);return(0,s.jsx)("div",{className:(0,o.cn)("absolute right-6 top-0 z-40 group",a.author.is_human?"sm:right-6 left-4 sm:left-auto":"right-6",h?"sm:top-9":"top-0"),children:(0,s.jsx)(ex.C,{options:g,setIsOpen:f,isOpen:p,asChild:!0,children:(0,s.jsx)(d.zx,{"aria-label":u("CharacterEditor.Form.more-options"),variant:"ghost",isIconOnly:!0,onPress:()=>f(!p),className:(0,o.cn)("opacity-0 transition-all group-hover:opacity-100",{"opacity-100":p}),children:(0,s.jsx)(eP.evw,{})})})})}var eq=a(37529);let eD=(0,j.memo)(e=>{let{characterId:t,turn:a,isLastTurn:r,primaryCandidateIndex:l,listItemIndex:d,containerClassName:c,isRoom:u,hasCustomBackground:h}=e,m=(0,i.G)(),{config:g}=(0,n.EY)(n.F5.NUXDynamicGreetingWeb),p=r&&!a.author.is_human&&!a.is_pinned&&!u&&(!a.isGreetingMessage||a.isGreetingMessage&&g.enabled);if(a.clientSystemMessage)return(0,s.jsx)(eE,{className:c,children:(0,s.jsx)(eq.i,{turn:a,hasCustomBackground:h,chatInstanceId:t})});if(!(null==a?void 0:a.candidates)||0===a.candidates.length)return null;let f=u?a.candidates.length-1:Math.min(l||0,a.candidates.length-1),b=r&&!a.author.is_human&&m.hideLastCharacterMessage,x={candidate_id:a.candidates[f].candidate_id,create_time:a.candidates[f].create_time,raw_content:"*Message hidden for now...*",fresh:a.candidates[f].fresh,is_final:a.candidates[f].is_final},y=b?x:a.candidates[f];if(!y)return null;let v={isLastTurn:r,listItemIndex:d,turn:a,candidate:y,characterId:t};return p&&!b?(0,s.jsxs)(eE,{className:c,children:[(0,s.jsx)(em,{turn:a,primaryCandidateIndex:l,supportsThrottledAnimation:!0}),(0,s.jsx)(eI,{...v})]}):(0,s.jsxs)(eE,{className:(0,o.cn)("p-2",c),children:[(0,s.jsx)(Z.f,{candidate:y,turn:a,animate:!!r&&!!u}),(0,s.jsx)(eI,{...v}),!!u&&!!r&&!a.author.is_human&&(0,s.jsx)(J,{candidate:y,turn:a})]})},(e,t)=>e.characterId===t.characterId&&e.turn===t.turn&&e.isLastTurn===t.isLastTurn&&e.primaryCandidateIndex===t.primaryCandidateIndex&&e.listItemIndex===t.listItemIndex&&e.containerClassName===t.containerClassName);function eE(e){let{children:t,className:a}=e,{isDenseChatStyle:n}=(0,r.ax)();return(0,s.jsx)("div",{className:(0,o.cn)("group relative max-w-3xl m-auto w-full",a,{"max-w-3xl":n}),children:t})}eD.displayName="ChatTurnComponent"},96344:function(e,t,a){a.d(t,{i:function(){return h},n:function(){return u}});var s=a(52322),n=a(21236),r=a(93326),o=a(3927),i=a(92599),l=a(92488),d=a(10386),c=a(15584);function u(e){let{listIndex:t}=e,{t:a}=(0,d.$G)();return(0,s.jsxs)(r.zx,{variant:"ghost",className:"justify-between w-full rounded-spacing-s  hover:bg-surface-elevation-2",onPress:()=>{l.FG.value=t},children:[a("Chat.delete-messages")," ",(0,s.jsx)(i.FBk,{height:"1.25em"})]})}function h(){let{t:e}=(0,d.$G)(),t=!!(0,c.BF)(l.FG);return(0,s.jsx)(o.Vq,{open:t,onOpenChange:e=>{e||(l.FG.value=null)},analyticsProps:{referrer:"ChatOptions",type:"DeleteMessagesDialog"},children:(0,s.jsxs)(o.cZ,{children:[(0,s.jsx)(o.fK,{children:(0,s.jsx)(o.$N,{children:e("Chat.delete-messages")})}),(0,s.jsx)(o.Be,{children:e("Chat.are-you-sure-you-want-to-delete-this-message")}),(0,s.jsxs)(o.cN,{children:[(0,s.jsx)(r.zx,{variant:"outline",onPress:()=>{l.FG.value=null},children:e("Common.cancel")}),(0,s.jsx)(r.zx,{onPress:()=>{l.B$.value=l.FG.value,l.FG.value=null,n.iN.messageDeleted({referrer:"DeleteMessagesDialog"})},children:e("Chat.delete-messages-action")})]})]})})}},28573:function(e,t,a){a.d(t,{K:function(){return u},q:function(){return c}});var s=a(52322),n=a(93326),r=a(3927),o=a(92599),i=a(92488),l=a(10386),d=a(15584);function c(e){let{listIndex:t}=e,{t:a}=(0,l.$G)();return(0,s.jsxs)(n.zx,{variant:"ghost",className:"justify-between w-full rounded-spacing-s  hover:bg-surface-elevation-2",onPress:()=>{i.HE.value=t},children:[a("Chat.rewind-conversation")," ",(0,s.jsx)(o.F_y,{height:"1.25em"})]})}function u(){let{t:e}=(0,l.$G)(),t=!!(0,d.BF)(i.HE);return(0,s.jsx)(r.Vq,{open:t,onOpenChange:e=>{e||(i.HE.value=null)},analyticsProps:{referrer:"ChatOptions",type:"RewindMessagesDialog"},children:(0,s.jsxs)(r.cZ,{children:[(0,s.jsx)(r.fK,{children:(0,s.jsx)(r.$N,{children:e("Chat.rewind-conversation")})}),(0,s.jsx)(r.Be,{children:e("Chat.are-you-sure-you-want-to-rewind-the-conversation-to-this-point")}),(0,s.jsxs)(r.cN,{children:[(0,s.jsx)(n.zx,{variant:"outline",onPress:()=>{i.HE.value=null},children:e("Common.cancel")}),(0,s.jsx)(n.zx,{onPress:()=>{i.WK.value=i.HE.value,i.HE.value=null},color:"danger",children:e("Chat.rewind")})]})]})})}},55174:function(e,t,a){a.d(t,{K:function(){return g},u:function(){return p}});var s=a(52322),n=a(21236),r=a(92599),o=a(93326),i=a(55274),l=a(92488),d=a(47022),c=a(2784),u=a(10386),h=a(92014);function m(e){let{text:t,onSave:a,onCancel:n}=e,{t:r}=(0,u.$G)(),[i,l]=(0,c.useState)(t);return(0,s.jsxs)("div",{className:"w-full gap-2 flex flex-col max-w-xl",children:[(0,s.jsx)(h.g,{inputMode:"text",maxLength:4092,className:"box-border w-full rounded-none placeholder:text-placeholder min-w-xl bg-transparent text-lg-chat",value:i,onChange:e=>{l(e.target.value)}}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(o.zx,{variant:"ghost",onPress:n,children:r("Common.cancel")}),(0,s.jsx)(o.zx,{isDisabled:!i,onPress:()=>a(i),children:r("Form.save")})]})]})}function g(e){let{turn_id:t}=e,{t:a}=(0,u.$G)();return(0,s.jsxs)(o.zx,{variant:"ghost",className:"justify-between w-full rounded-spacing-s hover:bg-surface-elevation-2",onPress:()=>{l.TU.value=t,n.iN.messageEdited({action:"editing",referrer:"EditCandidateComponent"})},children:[a("Chat.edit-message")," ",(0,s.jsx)(r.dY8,{height:"1.25em"})]})}function p(e){let{candidate:t,turn:a}=e,{characterId:r}=(0,i.AU)(),{publish:o}=(0,d.m)(),u=(0,c.useCallback)(e=>{e&&(o(r,{type:"edit_turn_candidate",turnKey:a.turn_key,candidateId:t.candidate_id,newRawContent:e}),l.TU.value=null,n.iN.messageEdited({action:"saved",referrer:"EditCandidateComponent"}))},[t.candidate_id,r,o,a.turn_key]);return(0,s.jsx)(m,{onCancel:()=>{l.TU.value=null,n.iN.messageEdited({action:"cancelled",referrer:"EditCandidateComponent"})},onSave:u,text:t.raw_content||""})}},37529:function(e,t,a){a.d(t,{i:function(){return q},N:function(){return D}});var s=a(52322),n=a(95856),r=a(81181),o=a(27714),i=a(92197),l=a(92599),d=a(46272),c=a(34581),u=a(35740),h=a(61676),m=a(55264),g=a(52779),p=a(93326),f=a(55541),b=a(92138),x=a(2784),y=a(10386),v=a(63881);let w=()=>{var e;let[t,a]=(0,x.useState)(!1),{t:n}=(0,y.$G)(),r=(0,b.xg)();return(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,s.jsx)(f.l,{content:n(t?"Scenes.hide-scene-description":"Scenes.see-scene-description"),side:"left",children:(0,s.jsx)(p.zx,{isIconOnly:!0,variant:"outline",className:"bg-surface-elevation-2 -mr-2 text-xl",onPress:()=>a(!t),children:t?(0,s.jsx)(v.i1c,{}):(0,s.jsx)(v.nlg,{})})}),!!t&&(0,s.jsx)(o.a2,{children:(0,s.jsxs)("div",{className:"max-w-3xl text-md-medium px-6 sm:px-8 md:px-10 py-5",children:[(0,s.jsx)("h3",{className:"text-xl-medium mb-4 text-center",children:null==r?void 0:r.title}),(0,s.jsx)(x.Suspense,{children:(0,s.jsx)(g.U,{children:null!==(e=null==r?void 0:r.description)&&void 0!==e?e:""})})]})})]})};var P=a(50926),A=a(38978),k=a(70677),j=a(21236),N=a(3927),_=a(76330);function C(e){let{isOpen:t,setIsOpen:a}=e,{t:n}=(0,y.$G)();return t?(0,s.jsx)(N.Vq,{open:!0,onOpenChange:e=>a(e),analyticsProps:{referrer:"Chat",type:"SelfHarmDetectorDialog"},children:(0,s.jsxs)(N.cZ,{className:"w-full max-w-xl",children:[(0,s.jsx)(N.fK,{children:(0,s.jsxs)(N.$N,{children:[" ",n("SelfHarmSupport.title")]})}),(0,s.jsxs)(N.Be,{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:n("SelfHarmSupport.body-1")}),(0,s.jsxs)("section",{className:"my-5",children:[(0,s.jsx)("h2",{className:"text-md-medium text-accent-foreground mt-4 mb-1",children:n("SelfHarmSupport.heading-2")}),(0,s.jsx)("p",{className:"text-muted-foreground",children:n("SelfHarmSupport.body-2")}),(0,s.jsx)("a",{href:"tel:".concat("988"),children:(0,s.jsxs)(p.zx,{size:"sm",className:"text-sm my-2",children:[(0,s.jsx)(_.DNl,{})," ",n("SelfHarmSupport.call")]})})]}),(0,s.jsxs)("section",{className:"my-5",children:[(0,s.jsx)("h2",{className:"text-md-medium text-accent-foreground mt-4 mb-1",children:n("SelfHarmSupport.heading-3")}),(0,s.jsx)("p",{className:"text-muted-foreground",children:n("SelfHarmSupport.body-3")}),(0,s.jsx)("a",{href:"https://findahelpline.com/i/iasp",target:"_blank",rel:"noreferrer",children:(0,s.jsxs)(p.zx,{size:"sm",className:"text-sm my-2",children:[(0,s.jsx)(_.gjK,{}),n("SelfHarmSupport.visit")]})})]}),(0,s.jsx)("section",{className:"my-5",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:n("SelfHarmSupport.body-4")})})]})]})}):null}var H=a(98945);let S=e=>{let{turnId:t,chatInstanceId:a}=e,{removeClientMessages:n}=(0,H.mx)(),{t:r}=(0,y.$G)(),[i,d]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{j.iN.contentViewed({content:"SelfHarmSupportMessage",referrer:"SelfHarmSupportMessage"})},[]),(0,s.jsx)(o.a2,{children:(0,s.jsxs)("div",{className:"flex items-center justify-center w-full m-auto",children:[(0,s.jsxs)("div",{className:"relative m-4 w-3/4 max-w-[500px] p-4 pt-5 border border-accent rounded-2xl space-y-1",children:[(0,s.jsx)(p.zx,{variant:"ghost",isIconOnly:!0,size:"sm",className:"absolute top-1 right-1 text-muted-foreground font-semibold",onPress:()=>{a&&n(a,[t])},children:(0,s.jsx)(l.Two,{height:"1em"})}),(0,s.jsx)("h2",{className:"text-md font-medium",children:r("SelfHarmSupport.title")}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground font-light",children:r("SelfHarmSupport.body-1")}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(p.zx,{variant:"primary",color:"secondary",size:"sm",className:"w-1/2 m-auto mt-2",onClick:()=>{d(!0)},children:r("Common.view-more")})})]}),(0,s.jsx)(C,{isOpen:i,setIsOpen:d})]})})},I=e=>{let{turnId:t,chatInstanceId:a}=e,{removeClientMessages:n}=(0,H.mx)(),{t:r}=(0,y.$G)();return(0,x.useEffect)(()=>{j.iN.contentViewed({content:"UserInputFilteredMessage",referrer:"UserInputFilteredMessage"})},[]),(0,s.jsx)(o.a2,{children:(0,s.jsx)("div",{className:"flex items-center justify-center w-full m-auto",children:(0,s.jsxs)("div",{className:"relative m-4 w-3/4 max-w-[500px] p-4 border border-accent rounded-2xl space-y-1",children:[(0,s.jsx)(p.zx,{variant:"ghost",isIconOnly:!0,size:"sm",className:"absolute top-1 right-1 text-muted-foreground font-semibold",onPress:()=>{a&&n(a,[t])},children:(0,s.jsx)(l.Two,{height:"1em"})}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground font-light",children:r("Chat.user-input-filtered-message")})]})})})};function q(e){var t,a,c,g,p,f;let{turn:b,chatInstanceId:x,className:v,characterPagePath:j,hasCustomBackground:N}=e,{user:_}=(0,u.a)(),{t:C,i18n:H}=(0,y.$G)(),q=b.author.is_human||b.author.author_id===P.B8?void 0:b.author.author_id,{character:D}=(0,A.XS)(q,H.language),E=j||m.nN.characterProfile(null!==(c=null==D?void 0:D.short_hash)&&void 0!==c?c:b.author.author_id),W=null!==(g=null===(t=b.clientSystemMessage)||void 0===t?void 0:t.payload)&&void 0!==g?g:"",G=null==D?void 0:D.is_licensed_professional;switch(null===(a=b.clientSystemMessage)||void 0===a?void 0:a.messageType){case k.lo.creator_attribution:return(0,s.jsx)(o.a2,{children:(0,s.jsxs)("div",{className:(0,h.cn)("flex flex-col items-center justify-center text-center gap-1 px-16 pb-6",_?"pt-12":"pt-8",v),children:[E?(0,s.jsx)(n.lc,{href:E,referrer:"ChatSystemMessage",characterId:b.author.author_id,name:b.author.name,size:64,src:b.author.avatar_url}):(0,s.jsx)(n.Ps,{name:b.author.name,size:64,src:b.author.avatar_url}),E?(0,s.jsx)(r.U,{name:b.author.name,className:"bold text-lg",href:E,referrer:"ChatSystemMessage",characterId:b.author.author_id}):(0,s.jsx)(r.E,{name:b.author.name,className:"bold text-lg"}),(0,s.jsx)("p",{className:(0,h.cn)("font-light text-md-medium",N?"text-foreground":"text-muted-foreground"),children:null===(p=b.clientSystemMessage)||void 0===p?void 0:p.message}),(0,s.jsx)(i.f,{author:W,clickable:!0,className:(0,h.cn)("text-medium font-light",N?"text-foreground":"text-muted-foreground")}),!!G&&(0,s.jsx)(n.cE,{})]})});case k.lo.context_reset:return(0,s.jsxs)("div",{className:"flex items-center gap-4 my-4",children:[(0,s.jsx)(d.Z,{className:"flex-1"}),C("Chat.ai-conversation-reset")," ",(0,s.jsx)(d.Z,{className:"flex-1"})]});case k.lo.self_harm_detected:return(0,s.jsx)(S,{turnId:b.turn_key.turn_id,chatInstanceId:x});case k.lo.user_input_filtered:return(0,s.jsx)(I,{turnId:b.turn_key.turn_id,chatInstanceId:x});case k.lo.game_message:return(0,s.jsxs)("div",{className:"flex items-center gap-4 my-4",children:[(0,s.jsx)(d.Z,{className:"flex-1"}),(0,s.jsx)(l.XjK,{width:24,className:"text-muted-foreground"}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[null===(f=b.clientSystemMessage)||void 0===f?void 0:f.message," "]}),(0,s.jsx)(d.Z,{className:"flex-1"})]});case k.lo.scene_intro:return(0,s.jsx)(w,{});default:return null}}function D(){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center text-center gap-1 pt-12 lg:pt-32",children:[(0,s.jsx)(c.O,{className:"h-16 w-16 rounded-lg"}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 mt-2 items-center",children:[(0,s.jsx)(c.O,{className:"w-20 h-5"}),(0,s.jsx)(c.O,{className:"w-64 h-6"}),(0,s.jsx)(c.O,{className:"w-32 h-4"})]})]})}},84691:function(e,t,a){a.d(t,{j:function(){return H}});var s=a(52322),n=a(18363),r=a(83862),o=a(61676),i=a(28830),l=a(65239),d=a(57352),c=a(2784);function u(e){let{isLoading:t}=e,[a,n]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{let e;return t?n(!0):e=setTimeout(()=>n(!1),500),()=>clearTimeout(e)},[t]),(0,s.jsx)(l.M,{children:!!a&&(0,s.jsx)(d.E.div,{id:"load-more-spinner",initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},transition:{type:"spring",duration:.5},className:(0,o.cn)("absolute top-20 min-w-full h-[100px] left-0 p-unit-sm"),children:(0,s.jsx)(i.Z,{})},"load-more-spinner")})}var h=a(93326),m=a(92599),g=a(10386);function p(e){let{show:t,onPress:a}=e,{t:n}=(0,g.$G)();return(0,s.jsx)(l.M,{children:!!t&&(0,s.jsx)(d.E.div,{id:"scroll-to-bottom-button",initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{type:"spring",duration:.5},className:(0,o.cn)("absolute pointer-events-auto flex justify-end w-full bottom-0 left-0 p-unit-sm"),children:(0,s.jsx)(h.zx,{"aria-label":n("Chat.scroll-to-bottom"),size:"sm",isIconOnly:!0,onPress:a,children:(0,s.jsx)(m.veu,{})})})})}var f=a(47022),b=a(54252),x=a(99673),y=a(21236),v=a(50567),w=a(92138),P=a(92488),A=a(61503),k=a(83614),j=a(59131);let N={slowModeUpsell:{type:"text",icon:m.Ad7,textKey:"Chat.upsells.upgrade-for-faster-response-times",trigger:"Slow-mode-upsell",onPress:()=>{P.mL.value={showModal:!0,referrer:"Slow-mode-upsell"}}},slowModeInformational:{type:"text",icon:m.T39,textKey:"Chat.upsells.receiving-slow-responses",trigger:"Slow-mode-informational",onPress:()=>{P.mL.value={showModal:!0,referrer:"Slow-mode-informational"}}},slowModeBannerTemporal:{type:"banner",icon:m.GxE,textKey:"Chat.upsells.slow-mode-until-time",trigger:"Slow-mode-banner-temporal",onPress:()=>{P.mL.value={showModal:!0,referrer:"Slow-mode-banner-temporal"}},isDismissable:!0},rewardAdsBannerInformational:{type:"banner",icon:m.GxE,textKey:"Chat.upsells.slow-mode-until-time",trigger:"Slow-mode-banner-temporal",onPress:()=>{P.mL.value={showModal:!0,referrer:"Slow-mode-banner-temporal"}},isDismissable:!0},rewardAdsBannerGamified:{type:"banner",icon:m.GxE,textKey:"Chat.upsells.slow-mode-until-time",trigger:"Slow-mode-banner-temporal",onPress:()=>{P.mL.value={showModal:!0,referrer:"Slow-mode-banner-temporal"}},isDismissable:!0},memory:{type:"banner",icon:m.t6u,textKey:"Chat.upsells.upgrade-for-better-memory",trigger:"Upgrade-for-better-memory",isDismissable:!0,onPress:()=>{P.Um.value={referrer:"Chat",trigger:"Upgrade-for-better-memory"}}},slowModeDiscountTemporal:{type:"banner",icon:m.GxE,textKey:"Chat.upsells.slow-mode-until-time",trigger:"Slow-mode-banner-temporal-permanent",onPress:()=>{P.mL.value={showModal:!0,referrer:"Slow-mode-banner-temporal-permanent",addDiscount:!0}}}},_=()=>{let e=(0,k.useLayer)(v.db.Throttling).get("in_chat_copy_variant",void 0),t=(0,k.useGateValue)(v.F5.ThrottlingKillSwitch),a=(0,A.i)(),{showChatUpsell:s}=(0,w.f_)();return t&&a&&e?N[e]:s?N.memory:null},C=()=>{let{t:e}=(0,j.$G)(),t=_(),[a,n]=c.useState(!1);(0,c.useEffect)(()=>{t&&y.iN.contentViewed({referrer:"Chat",type:t.trigger})},[t]);let r=(0,A.g)();if(!t||a)return null;let o=t.icon;return"banner"===t.type?(0,s.jsx)("div",{className:"flex items-center justify-center my-2 cursor-pointer",onClick:t.onPress,children:(0,s.jsxs)("div",{className:"relative flex items-center  border border-border-outline rounded-full pl-5 pr-3 py-2 min-h-[40px] max-w-2xl w-fit shadow-sm",children:[(0,s.jsx)(o,{className:"w-5 h-5 text-muted-foreground shrink-0 mr-2"}),(0,s.jsx)("span",{className:"text-sm select-none flex items-center mr-2",children:(0,s.jsx)(j.cC,{i18nKey:t.textKey,values:{time:r},children:(0,s.jsx)("span",{className:"font-bold text-plus mr-1",children:"Slow mode"})})}),!!t.isDismissable&&(0,s.jsx)("button",{type:"button",className:"flex items-center justify-center p-1 rounded-full hover:bg-surface-elevation-2 transition-colors",onClick:()=>n(!0),"aria-label":e("Common.dismiss"),style:{lineHeight:0},children:(0,s.jsx)(m.Two,{className:"w-4 h-4 text-muted-foreground"})})]})}):(0,s.jsx)("div",{className:"flex items-center justify-center mb-1 mt-1.5",children:(0,s.jsxs)("button",{type:"button","aria-label":e("Chat.upsells.upgrade"),className:"flex items-center gap-2 px-3 py-1.5 max-w-full cursor-pointer",onClick:t.onPress,"data-sentry-label":"turbo_upsell",children:[(0,s.jsx)(o,{className:"size-[18px] text-plus shrink-0"}),(0,s.jsx)("span",{className:"text-muted-foreground text-[0.70rem] select-none",children:(0,s.jsxs)(j.cC,{i18nKey:t.textKey,children:[(0,s.jsx)("span",{className:"font-bold mr-1 text-plus"}),(0,s.jsx)("span",{})]})})]})})};function H(e){let{chatTurns:t,primaryCandidateMap:a,characterId:i,hasCustomBackground:l}=e,d=(0,c.useRef)(null),{getChatMessages:h,isRoom:m}=(0,f.m)(),[g,y]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!0),P=(0,c.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"smooth";d.current&&d.current.scrollTo({top:0,behavior:e})},[]);b.M.useListen(()=>P("instant"),[P]);let A=(0,c.useCallback)(async()=>{!g&&v&&(y(!0),w(!!await h(i)),y(!1))},[i,g,v,h]),{isScrolling:k,isAtTop:j,isAtBottom:N,handleScroll:_}=(0,r.jR)("startAtBottom");return(0,c.useEffect)(()=>{j&&A()},[j,A]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{ref:d,id:"chat-messages",className:(0,o.cn)("overflow-x-hidden overflow-y-scroll px-1 flex flex-col-reverse min-w-full z-0",{"hide-scrollbar":!k}),onScroll:_,children:[!!m&&(0,s.jsx)("div",{className:"pb-14"}),(0,s.jsx)(n.m,{}),(0,s.jsx)(C,{}),t.map((e,n)=>(0,s.jsx)(x.x,{primaryCandidateIndex:a[e.turn_key.turn_id],isLastTurn:0===n,listItemIndex:t.length-n-1,turn:e,characterId:i,isRoom:m,hasCustomBackground:l},e.turn_key.turn_id))]}),(0,s.jsxs)("div",{className:"absolute w-full h-full overflow-hidden pointer-events-none",children:[(0,s.jsx)(p,{show:!N,onPress:()=>P()}),(0,s.jsx)(u,{isLoading:g})]})]})}},88370:function(e,t,a){a.d(t,{e:function(){return d}});var s=a(52322),n=a(86202),r=a(55264),o=a(97729),i=a.n(o),l=a(10386);let d=e=>{let{name:t,title:a,characterId:o,character_page_path:d,author:c}=e,{t:u}=(0,l.$G)(),h=(0,r.C3)(u("Pages.titles.characterChat",{name:t})),m=u("Pages.descriptions.characterChat",{name:t,title:a}),g="https://character.ai",p={"@context":"https://schema.org","@type":"SoftwareApplication",name:t,description:m,applicationCategory:"ChatApplication",operatingSystem:"Web",image:g+r.nN.chatOGImage(o),url:"".concat(g,"/chat/").concat(o),character:{"@type":"Person",name:t,description:a,image:g+r.nN.chatOGImage(o),url:"".concat(g).concat(d)},author:c?{"@type":"Person",url:"".concat(g,"/profile/").concat(c),alternateName:"@".concat(c),description:m||u("Pages.descriptions.profileDefault",{author:c})}:void 0};return(0,s.jsxs)(i(),{children:[(0,s.jsx)("title",{children:h}),(0,s.jsx)("meta",{name:"apple-itunes-app",content:"app-id=invalid-id"},"apple-itunes-app"),(0,s.jsx)("meta",{name:"description",content:m},"description"),(0,s.jsx)("meta",{property:"og:type",content:"website"},"og:type"),(0,s.jsx)("meta",{property:"og:title",content:h},"og:title"),(0,s.jsx)("meta",{property:"og:description",content:m},"og:description"),(0,s.jsx)("meta",{property:"og:image",content:g+r.nN.chatOGImage(o)},"og:image"),(0,s.jsx)(n.h,{ldJsonSchema:p})]})}},213:function(e,t,a){a.d(t,{Y:function(){return k}});var s=a(52322),n=a(21236),r=a(6669),o=a(95856),i=a(79298),l=a(46086),d=a(8066),c=a(50090),u=a(15030),h=a(10386);let m=()=>{let{t:e}=(0,h.$G)();return(0,s.jsx)(c.Z,{target:"_blank",href:u.Ew.troubleSigningIn,className:"w-full text-muted-foreground text-center hover:text-primary",analytics:{name:"linkOpened",properties:{link:u.Ew.troubleSigningIn,referrer:"sign_in_dialog"}},children:e("Auth.trouble-signing-in")})};var g=a(3927),p=a(92488),f=a(55264),b=a(31727),x=a(13160),y=a(37529),v=a(88370),w=a(38978),P=a(70677),A=a(2784);function k(e){var t,a,c;let{characterId:k,characterPagePath:j}=e;(0,r.Xu)("ChatSignedOut");let{t:N,i18n:_}=(0,h.$G)(),{character:C}=(0,w.XS)(null!=k?k:"",_.language),[H,S]=(0,A.useState)(!1),[I,q]=(0,A.useState)(!1),[D,E]=(0,A.useState)(!1),W=(0,A.useRef)(null),G=()=>{let e=W.current;e&&e.scrollIntoView()},M=(0,A.useCallback)(e=>{S(e),q(e)},[S,q]);return((0,A.useEffect)(()=>{H&&n.iN.modalOpened({referrer:"ChatSignedOut",type:"SignInDialog"})},[H]),(0,A.useEffect)(()=>{p.Ib.value=!1},[]),C)?(0,s.jsxs)(s.Fragment,{children:[!!C&&(0,s.jsx)(v.e,{name:null==C?void 0:C.participant__name,title:null==C?void 0:C.title,characterId:k,character_page_path:j,author:C.user__username}),(0,s.jsxs)("div",{className:"flex flex-col gap-6 w-full justify-between max-w-3xl items-center overflow-x-hidden h-full pt-20",children:[(0,s.jsxs)("div",{className:"px-2 flex flex-col flex-1 w-full gap-2 h-full overflow-y-auto",children:[(0,s.jsx)(y.i,{turn:(0,f.hQ)({author:{avatar_url:null==C?void 0:C.avatar_file_name,name:null!==(t=null==C?void 0:C.name)&&void 0!==t?t:"",is_human:!1,author_id:""},clientSystemMessage:{message:null!==(a=null==C?void 0:C.title)&&void 0!==a?a:"",messageType:P.lo.creator_attribution,payload:null==C?void 0:C.user__username}}),className:"w-full px-10",characterPagePath:j}),(0,s.jsx)(x.f,{candidate:(0,f.Fy)({raw_content:null==C?void 0:C.greeting}),turn:(0,f.hQ)({author:{avatar_url:null==C?void 0:C.avatar_file_name,name:null!==(c=null==C?void 0:C.name)&&void 0!==c?c:"",is_human:!1,author_id:""}}),animate:!0,className:"pr-10",onAnimationUpdate:G,onAnimationEnd:()=>{E(!0),G()}}),(0,s.jsx)("div",{ref:W,className:"w-full h-[120px]"}),!!D&&(0,s.jsx)("div",{ref:W,className:"w-full h-[108px]"})]}),(0,s.jsx)("div",{className:"p-0 bottom-0 w-full max-w-3xl flex justify-center",children:(0,s.jsx)(b.F6,{onSend:e=>{p.Ib.value=!0,p.f8.value="signup",localStorage.setItem((0,u.mu)(null==C?void 0:C.external_id),JSON.stringify({value:e,time:new Date}))}})}),!!(H||I)&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-scrim w-full h-full"}),(0,s.jsx)(g.Vq,{open:H,onOpenChange:M,modal:!1,children:(0,s.jsxs)(g.cZ,{className:"flex-auto flex bg-surface-elevation-1 flex-col justify-between items-center",children:[(0,s.jsx)(l.t,{}),!!C&&(0,s.jsx)(o.B7,{name:null==C?void 0:C.name,size:92,src:null==C?void 0:C.avatar_file_name}),N("Chat.sign-up-to-chat-with-character-name",{character:null==C?void 0:C.name}),(0,s.jsx)(d.ZP,{}),(0,s.jsx)(m,{}),(0,s.jsx)(i.R,{})]})})]})]}):null}},61503:function(e,t,a){a.d(t,{g:function(){return r},i:function(){return n}});var s=a(98945);let n=()=>{let{generationMode:e}=(0,s.mx)(),t=!!e.expiryTimestamp&&e.expiryTimestamp>new Date;return!!e.isSlowMode&&t},r=()=>{let{generationMode:e}=(0,s.mx)();return(e.expiryTimestamp?e.expiryTimestamp:new Date(Date.now()+36e5)).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}).toLowerCase()}},59375:function(e,t,a){function s(e){if(0===e.length)return;let t=Math.floor(Math.random()*e.length);return e[t]}function n(e){let t=e-Date.now();if(t<=0)return{hours:0,minutes:0,seconds:0,formatted:"00:00"};let a=Math.floor(t/1e3%60),s=Math.floor(t/6e4%60),n=Math.floor(t/36e5),r=e=>e.toString().padStart(2,"0"),o=n?"".concat(n,":").concat(r(s),":").concat(r(a)):"".concat(r(s),":").concat(r(a));return{hours:n,minutes:s,seconds:a,formatted:o}}a.d(t,{Sg:function(){return n},j0:function(){return s}})}}]);