"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6302],{88052:function(e,t,r){r.d(t,{T:function(){return c}});var n=r(52322),a=r(21236),s=r(92599),l=r(7987);let c=(0,r(2784).forwardRef)((e,t)=>{let{query:r,onEntrySelected:c,className:i,referrer:o}=e,{autocompleteResults:u,isLoading:d}=(0,l.ch)(r,!0);return d||!u||0===u.length?null:(0,n.jsx)("div",{ref:t,className:i,children:u.map((e,t)=>(0,n.jsxs)("div",{className:"px-4 py-2 hover:bg-surface-elevation-3 cursor-pointer flex items-center gap-6",onClick:()=>{c(e),a.iN.elementClicked({type:"search_autocomplete_item_clicked",value:r,option:"".concat(t+1),referrer:o})},children:[(0,n.jsx)("div",{className:"w-6 h-6 rounded-full bg-surface-elevation-3 flex items-center justify-center",children:(0,n.jsx)(s.W1M,{height:"1.2em",className:"text-muted-foreground"})}),(0,n.jsx)("span",{className:"text-md",children:e})]},"".concat(e,"-").concat(t)))})});c.displayName="AutocompleteSearch"},67586:function(e,t,r){r.d(t,{S:function(){return i}});var n=r(52322),a=r(92599),s=r(93326),l=r(61676),c=r(10386);function i(e){let{onEntrySelected:t,onEntryRemoved:r,recentSearches:i,entryClassName:o,numRecentSearchesToShow:u}=e,{t:d}=(0,c.$G)();return 0===i.length?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-sm px-4 py-2 mt-2 text-muted-foreground",children:d("Search.recent")}),i.slice(0,null!=u?u:5).map(e=>(0,n.jsxs)("div",{className:(0,l.cn)("px-4 py-2 hover:bg-surface-elevation-3 cursor-pointer flex items-center gap-2",o),onClick:()=>t(e),children:[(0,n.jsx)(a.W1M,{height:"1em",className:"text-primary"}),(0,n.jsx)("span",{children:e}),(0,n.jsx)(s.zx,{variant:"ghost",size:"md",isIconOnly:!0,className:"ml-auto h-fit min-w-fit w-fit",onPress:()=>{r(e)},children:(0,n.jsx)(a.Two,{height:"1em",color:"var(--icon-secondary)"})})]},e))]})}},73148:function(e,t,r){r.d(t,{s:function(){return u}});var n=r(52322),a=r(92599),s=r(61676),l=r(7987),c=r(83614),i=r(2784),o=r(10386);function u(e){let{onEntrySelected:t,entryClassName:r,searchCountOverride:u}=e,{t:d}=(0,o.$G)(),{topSearches:m,isLoading:x}=(0,l.TG)(),h=(0,c.useStatsigClient)().getLayer("search_experience").get("numSuggestedToShow",0),p=(0,i.useMemo)(()=>{var e;let t=null!=u?u:h;return null!==(e=null==m?void 0:m.slice(0,t))&&void 0!==e?e:[]},[m,h,u]);return x||0===h?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2",children:[(0,n.jsx)(a.qzz,{height:"1rem",className:"text-muted-foreground"}),(0,n.jsx)("span",{className:"text-sm text-muted-foreground",children:d("Search.top")})]}),p.map(e=>(0,n.jsxs)("div",{className:(0,s.cn)("px-4 py-2 hover:bg-surface-elevation-3 cursor-pointer flex items-center gap-2",r),onClick:()=>t(e),children:[(0,n.jsx)(a.W1M,{height:"1em",className:"text-primary"}),(0,n.jsx)("span",{children:e})]},e))]})}},6302:function(e,t,r){r.d(t,{uN:function(){return M},$C:function(){return $}});var n=r(52322),a=r(20808),s=r(6669),l=r(50567),c=r(27714),i=r(46086),o=r(55264),u=r(72539),d=r(50090);function m(e){var t,r,a,s,l,c;let{user:i}=e;return(0,n.jsxs)(d.Z,{className:"flex",href:o.nN.profile(null!==(l=null===(t=i.user)||void 0===t?void 0:t.username)&&void 0!==l?l:""),analytics:{name:"elementClicked",properties:{referrer:"HomeHeader",target:o.nN.profile(null!==(c=null===(r=i.user)||void 0===r?void 0:r.username)&&void 0!==c?c:"")}},children:[(0,n.jsx)("div",{className:"w-[36px] h-[36px] flex items-center justify-center",children:(0,n.jsx)(u.a,{name:i.name||i.email||"",size:20,src:null===(s=i.user)||void 0===s?void 0:null===(a=s.account)||void 0===a?void 0:a.avatar_file_name,rounded:!0})}),(0,n.jsx)("div",{className:"text-xl flex flex-auto flex-col justify-center text-left ml-1",children:(0,n.jsx)("p",{children:null==i?void 0:i.name})})]})}var x=r(16671),h=r(87790),p=r(40022),f=r(88052),g=r(67586),v=r(92599),j=r(93326),y=r(74251),N=r(92488),w=r(61676),b=r(83614),S=r(5632),C=r(2784),_=r(66582),k=r(10386),z=r(9010),E=r(81364),T=r(21236),F=r(7987);function q(e){var t;let{onEntrySelected:r}=e,{t:a}=(0,k.$G)(),{searchResults:s,isLoading:l}=(0,F.SL)(),c=(0,C.useCallback)((e,t)=>{T.iN.elementClicked({type:"trending_search_query",referrer:"SearchbarTrendingSearches",value:e,action:"click"}),r(e)},[r]);return!l&&(null==s?void 0:null===(t=s.trending_search_queries)||void 0===t?void 0:t.length)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2",children:[(0,n.jsx)(v.fbS,{height:"1rem",className:"text-muted-foreground"}),(0,n.jsx)("span",{className:"text-sm text-muted-foreground",children:a("Categories.trending")})]}),s.trending_search_queries.slice(0,10).map((e,t)=>(0,n.jsxs)("div",{className:"px-4 py-2 hover:bg-surface-elevation-3 cursor-pointer flex items-center gap-2",onClick:()=>c(e,t),children:[(0,n.jsx)(v.W1M,{height:"1rem",className:"text-muted-foreground"}),e]},e))]}):null}var O=r(73148);function R(e){let{isSignedOut:t,getCharacterHref:r,placeholder:a,className:s,containerClassName:c,inputClassName:i}=e,{t:u}=(0,k.$G)(),d=(0,b.useStatsigClient)(),m=(0,b.useGateValue)(l.F5.NRTSearchEvents),x=(0,y.Dv)(),T=r||o.nN.chat,F=a||u("Search.placeholder"),[R,P]=(0,C.useState)("manual"),{characterResults:D,isSearchLoading:G,clearSearch:I,onChangeSearchText:M,showSearchError:W,refetchSearch:$,submittedSearchQuery:B,uuid:A}=(0,p.HP)(void 0,!1,p.Sc.characters,"Searchbar",[],R),[H,L]=(0,C.useState)(""),[Z,K]=(0,C.useState)(!1),Q=(0,C.useRef)(null),U=(0,C.useRef)(null),J=(0,S.useRouter)(),[V,Y]=(0,C.useState)(!1),[X,ee]=(0,C.useState)(!1),[et,er]=(0,C.useState)(0),{saveSearch:en,recentSearches:ea,removeSearch:es}=(0,p.Yr)(),el=D&&B;(0,C.useEffect)(()=>{Z&&(Y(!0),er(5),d.getExperiment(l.F5.AutocompleteSearch).get("enabled",!1)&&ee(!0))},[Z,d]),(0,C.useEffect)(()=>{function e(e){U.current&&!U.current.contains(e.target)&&K(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,C.useEffect)(()=>{N.qh.value=el?"open":"closed"},[el]);let ec=_.nI,ei=e=>{L(e),d.getExperiment(l.F5.DisableAutoSearch).get("enabled",!1)||M(e)},eo=()=>{var e;L(""),I(),null===(e=Q.current)||void 0===e||e.focus()},eu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"manual";L(e),K(!1),P(t),en(e),J.push(o.nN.search(e))},ed=!!Z&&!!V,em=!!Z&&!!X;return(0,n.jsxs)("div",{className:c,ref:U,children:[!!el&&(0,n.jsx)("div",{className:"absolute left-0 top-0 z-30 h-dvh w-screen bg-black opacity-30",onClick:eo}),(0,n.jsx)("div",{className:(0,w.cn)("relative h-10 w-64 md:w-96",{"md:top-6":!!el&&!t},c),children:(0,n.jsxs)("div",{className:(0,w.cn)("absolute z-40 flex gap-2 w-full max-w-3xl border-spacing-1 border-divider flex-row self-center items-center rounded-full bg-surface-elevation-1 p-4 placeholder:text-placeholder",{"rounded-b-none rounded-t-spacing-l":ed||em},s),children:[(0,n.jsx)(j.zx,{"aria-label":u("Common.search"),variant:"ghost",isIconOnly:!0,onPress:()=>{if(H.length>0)J.push(o.nN.search(H));else{var e;null===(e=Q.current)||void 0===e||e.focus()}},className:"h-fit min-w-fit w-fit",children:G?(0,n.jsx)(z.$,{size:16}):(0,n.jsx)(v.W1M,{height:"1.25em",className:"ml-1"})}),(0,n.jsx)(E.I,{className:(0,w.cn)("rounded-full rounded-l-none border-none bg-transparent placeholder:text-muted-foreground p-0 relative",i),type:"text",ref:Q,placeholder:F,onChange:e=>{ei(e.target.value)},value:H,onFocus:()=>K(!0),onKeyDown:e=>{"Enter"===e.key&&eu(H)}}),!!H&&(0,n.jsx)(j.zx,{variant:"ghost",size:"sm",isIconOnly:!0,className:"mr-2 h-fit min-w-fit w-fit",onPress:eo,children:(0,n.jsx)(v.Two,{height:"1.25em",color:"var(--icon-secondary)"})}),!H&&!!ed&&(0,n.jsxs)("div",{className:"absolute z-50 top-full left-0 right-0 max-h-[calc(100vh-8rem)] overflow-hidden flex flex-col bg-surface-elevation-2 border-t border-divider rounded-b-spacing-l",children:[(0,n.jsx)(g.S,{onEntrySelected:e=>{eu(e,"recent")},onEntryRemoved:e=>{es(e)},recentSearches:ea,numRecentSearchesToShow:et}),(0,n.jsx)(O.s,{onEntrySelected:e=>{eu(e,"top")}}),(0,n.jsx)(q,{onEntrySelected:e=>{eu(e)}})]}),!!H&&!!em&&(0,n.jsx)(f.T,{referrer:"SearchAutocompleteWebSearchBar",className:"absolute z-50 top-full left-0 right-0 max-h-[calc(100vh-8rem)] overflow-hidden flex flex-col bg-surface-elevation-2 border-t border-divider rounded-b-spacing-l pb-2",query:H,onEntrySelected:e=>{eu(e,"autocomplete")}})]})}),!!W&&(0,n.jsx)("div",{className:"flex max-w-3xl justify-center self-center sm:px-12 ",children:(0,n.jsxs)("div",{className:(0,w.cn)("absolute z-40 mt-2 md:mt-8 flex max-h-[calc(100vh-8rem)] w-96 flex-col overflow-y-scroll rounded-md bg-card px-2",{"md:mt-2":t}),children:[(0,n.jsx)("p",{className:"m-4 text-center",children:u("Search.something-went-wrong-loading-search-results")}),(0,n.jsx)(j.zx,{className:"my-4 w-48 self-center",onPress:$,color:"secondary",children:u("Common.try-again")})]})}),!!el&&(0,n.jsx)("div",{className:"flex max-w-3xl justify-end md:justify-center self-center py-3",children:(0,n.jsx)("div",{className:"absolute z-50 mt-2 md:mt-8 max-h-[calc(100vh-8rem)] max-w-[90dvw] sm:w-96 overflow-hidden rounded-spacing-l flex flex-col",children:(0,n.jsxs)("div",{className:(0,w.cn)(" overflow-y-scroll bg-surface-elevation-2 px-2 flex flex-col",{"md:mt-2":t}),children:[!!D&&D.length>0&&D.map((e,t)=>(0,n.jsx)(h.J,{openInNewTab:ec,referrer:"Searchbar",src:e.avatar_file_name,href:T(e.external_id),name:e.participant__name,title:e.title?e.title:e.greeting,author:e.user__username,interactions:e.participant__num_interactions,upvotes:e.upvotes,nameClassname:"text-md sm:text-lg",titleClassname:"text-sm sm:text-md",infoClassname:"text-sm sm:text-md",avatarImageSize:x?52:60,searchResultCharacterIds:null==D?void 0:D.map(e=>e.external_id),id:e.external_id,index:t,trackImpressions:m,searchUuid:A},e.external_id)),(null==D?void 0:D.length)===0&&(0,n.jsx)("div",{className:"p-4",children:u("Search.no-results")})]})})})]})}var P=r(35740),D=r(89363),G=r(1337),I=r(15584);function M(){let{user:e}=(0,P.a)();return e?(0,n.jsx)(W,{user:e}):(0,n.jsx)($,{})}let W=e=>{let{user:t}=e,{t:r}=(0,k.$G)(),a=(0,I.BF)(N.zE);return(0,n.jsxs)("div",{className:(0,w.cn)("flex justify-end items-end lg:justify-between pr-4",{"ml-6 lg:ml-0":!a}),children:[(0,n.jsxs)(c.a2,{className:"hidden lg:flex flex-col gap-1",children:[(0,n.jsx)("p",{className:"text-muted-foreground",children:r("Home.welcome-back")}),(0,n.jsx)(m,{user:t})]}),(0,n.jsx)("div",{className:"flex justify-end ml-6 gap-3",children:(0,n.jsx)(R,{isSignedOut:!1})})]})},$=e=>{let{hideSearch:t,className:r,referrer:c,isNewHome:u,onButtonPress:m}=e,h=(0,I.BF)(N.Z8),p=(0,I.BF)(N.eg),{user:f}=(0,P.a)(),{t:g}=(0,k.$G)(),v=(0,y.Dv)(),j=(0,y.Fv)(),C=(0,G.C)(),z=u?"minimal"===C:v,{asPath:E}=(0,S.useRouter)(),T=E.startsWith(o.nN.chat("")),F=(0,s.wz)(a.b.SignupPromptOnScroll),q=_.tq||T;(0,D.jB)({disabled:u||p||!(h||!F&&q),shouldCancelOnTapOutside:!0,shouldUseFedcmForPrompt:!0});let O=(0,b.useExperiment)(l.F5.SignupToChat).get(l.sD.SignupToChat,!1);return f?(0,n.jsx)("div",{className:"flex justify-end items-end pr-4 w-full",children:(0,n.jsx)(R,{isSignedOut:!0})}):(0,n.jsxs)("div",{className:(0,w.cn)("flex gap-3 w-full justify-between fixed top-0 left-0 z-10 bg-background",u?"pt-[22px] pb-[14px] px-[40px]":"py-5 px-4",r),children:[(0,n.jsxs)("div",{className:(0,w.cn)("flex flex-row",{"w-full":j||t}),children:[(0,n.jsx)(d.Z,{href:o.nN.home(),className:(0,w.cn)("flex items-center mr-6 h-fit",z?"pt-2":"pt-1",{"pl-2":z}),analytics:{name:"linkOpened",properties:{referrer:null!=c?c:"HomeHeader",link:o.nN.home()}},children:(0,n.jsx)(i.t,{size:z?"mini":"regular"})}),(0,n.jsxs)("div",{className:(0,w.cn)("flex flex-row w-full justify-end gap-3",j||t?"justify-end":"justify-start"),children:[(0,n.jsx)(x.Q,{type:"signup",copyOverride:O?g("Signup.toChat"):void 0,onButtonPress:m}),(0,n.jsx)(x.Q,{type:"signin",copyOverride:g("Common.login"),onButtonPress:m})]})]}),!j&&!t&&(0,n.jsx)(R,{placeholder:g("Common.search").toString(),isSignedOut:!0,className:(0,w.cn)("max-w-[412px]",_.tq?"py-[10px] px-2":"p-[10px]"),inputClassName:"placeholder:text-primary",containerClassName:"w-full md:w-full min-[140px] max-w-[412px]"})]})}},1337:function(e,t,r){r.d(t,{C:function(){return a}});var n=r(51032);let a=()=>{let e=(0,n.Z)("(max-width: 480px)",!1),t=(0,n.Z)("(max-width: 1023px)",!1),r=(0,n.Z)("(max-width: 1370px)",!1);return e?"minimal":t?"abridged":r?"large-with-shift":"large"}},7987:function(e,t,r){r.d(t,{SL:function(){return c},TG:function(){return o},ch:function(){return i}});var n=r(33371),a=r(79937);r(92357);var s=r(13789);let l={trending:()=>["trending"],autocomplete:e=>["autocomplete",e],popular:()=>["popular"]},c=()=>{let e=(0,s.aM)({queryKey:l.trending(),queryFn:async()=>{let{trending_search_queries:e}=await (0,a.m)().getTrendingSearches();if(!e)throw Error("No search data for trending searches returned!");return{trending_search_queries:e}},enabled:!0,staleTime:1/0});return{...e,searchResults:e.data}},i=(e,t)=>{let r=(0,n.Nr)(e,100),c=(0,s.NL)(),i=(0,s.aM)({queryKey:l.autocomplete(r),queryFn:async e=>{let{signal:t}=e;try{let{search_autocomplete:e}=await (0,a.m)().getAutocompleteSearch(r,{signal:t});return e}catch(e){if(e instanceof Error&&"AbortError"===e.name){let e=c.getQueryData(l.autocomplete(r));return null!=e?e:[]}return[]}},enabled:!!r&&t,keepPreviousData:!0,staleTime:0,cacheTime:6e4,refetchOnWindowFocus:!1,retry:!1,placeholderData:[]});return{...i,autocompleteResults:i.data,clearCache:()=>{c.setQueryData(l.autocomplete(r),[])}}},o=()=>{let e=(0,s.aM)({queryKey:l.popular(),queryFn:async()=>{let{popular_search_queries:e}=await (0,a.m)().getPopularSearches();return e},staleTime:36e5,retry:!1,placeholderData:[]});return{...e,topSearches:e.data}}}}]);